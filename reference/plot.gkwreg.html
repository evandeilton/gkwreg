<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Diagnostic Plots for Generalized Kumaraswamy Regression Models — plot.gkwreg • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnostic Plots for Generalized Kumaraswamy Regression Models — plot.gkwreg"><meta name="description" content='Produces a comprehensive set of diagnostic plots for assessing the adequacy
of a fitted Generalized Kumaraswamy (GKw) regression model (objects of class
"gkwreg"). The function offers flexible plot selection, multiple
residual types, and support for both base R graphics and ggplot2 with
extensive customization options. Designed for thorough model evaluation
including residual analysis, influence diagnostics, and goodness-of-fit
assessment.'><meta property="og:description" content='Produces a comprehensive set of diagnostic plots for assessing the adequacy
of a fitted Generalized Kumaraswamy (GKw) regression model (objects of class
"gkwreg"). The function offers flexible plot selection, multiple
residual types, and support for both base R graphics and ggplot2 with
extensive customization options. Designed for thorough model evaluation
including residual analysis, influence diagnostics, and goodness-of-fit
assessment.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gkwreg-vs-betareg.html">Beta Regression vs Kumaraswamy-Based Models for Bounded Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/gkwreg" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Diagnostic Plots for Generalized Kumaraswamy Regression Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/gkwreg/blob/v2.1.5/R/gkwreg-plot.R" class="external-link"><code>R/gkwreg-plot.R</code></a></small>
      <div class="d-none name"><code>plot.gkwreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Produces a comprehensive set of diagnostic plots for assessing the adequacy
of a fitted Generalized Kumaraswamy (GKw) regression model (objects of class
<code>"gkwreg"</code>). The function offers flexible plot selection, multiple
residual types, and support for both base R graphics and <code>ggplot2</code> with
extensive customization options. Designed for thorough model evaluation
including residual analysis, influence diagnostics, and goodness-of-fit
assessment.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gkwreg'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quantile"</span>, <span class="st">"pearson"</span>, <span class="st">"deviance"</span><span class="op">)</span>,</span>
<span>  family <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  caption <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  main <span class="op">=</span> <span class="st">""</span>,</span>
<span>  sub.caption <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ask <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use_ggplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  arrange_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theme_fn <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  save_diagnostics <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class <code>"gkwreg"</code>, typically the result of a call
to <code><a href="gkwreg.html">gkwreg</a></code>.</p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>Integer vector specifying which diagnostic plots to produce.
If a subset of the plots is required, specify a subset of the numbers 1:6.
Defaults to <code>1:6</code> (all plots). The plots correspond to:</p><ol><li><p><strong>Residuals vs. Observation Indices</strong>: Checks for temporal
patterns, trends, or autocorrelation in residuals across observation order.</p></li>
<li><p><strong>Cook's Distance Plot</strong>: Identifies influential observations
that have disproportionate impact on model estimates. Points exceeding
the 4/n threshold warrant investigation.</p></li>
<li><p><strong>Generalized Leverage vs. Fitted Values</strong>: Identifies high
leverage points with unusual predictor combinations. Points exceeding
2p/n threshold may be influential.</p></li>
<li><p><strong>Residuals vs. Linear Predictor</strong>: Checks for non-linearity
in the predictor-response relationship and heteroscedasticity
(non-constant variance).</p></li>
<li><p><strong>Half-Normal Plot with Simulated Envelope</strong>: Assesses
normality of residuals (particularly useful for quantile residuals)
by comparing observed residuals against simulated quantiles. Points
outside the envelope indicate potential model misspecification.</p></li>
<li><p><strong>Predicted vs. Observed Values</strong>: Overall goodness-of-fit
check showing model prediction accuracy and systematic bias.</p></li>
</ol></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string indicating the type of residuals to be used for
plotting. Defaults to <code>"quantile"</code>. Valid options are:</p><ul><li><p><code>"quantile"</code>: Randomized quantile residuals (Dunn &amp; Smyth, 1996).
<strong>Recommended for bounded responses</strong> as they should be approximately
N(0,1) if the model is correctly specified. Most interpretable with
standard diagnostic tools.</p></li>
<li><p><code>"pearson"</code>: Pearson residuals (response residual standardized
by estimated standard deviation). Useful for checking the variance function
and identifying heteroscedasticity patterns.</p></li>
<li><p><code>"deviance"</code>: Deviance residuals. Related to the log-likelihood
contribution of each observation. Sum of squared deviance residuals equals
the model deviance.</p></li>
</ul></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Character string specifying the distribution family assumptions
to use when calculating residuals and other diagnostics. If <code>NULL</code>
(default), the family stored within the fitted <code>object</code> is used.
Specifying a different family can be useful for diagnostic comparisons
across competing model specifications. Available options match those in
<code><a href="gkwreg.html">gkwreg</a></code>: <code>"gkw"</code>, <code>"bkw"</code>, <code>"kkw"</code>,
<code>"ekw"</code>, <code>"mc"</code>, <code>"kw"</code>, <code>"beta"</code>.</p></dd>


<dt id="arg-caption">caption<a class="anchor" aria-label="anchor" href="#arg-caption"></a></dt>
<dd><p>Titles for the diagnostic plots. Can be specified in three ways:</p><ul><li><p><code>NULL</code> (default): Uses standard default captions for all plots.</p></li>
<li><p><strong>Character vector</strong> (backward compatibility): A vector of 6
strings corresponding to plots 1-6. Must provide all 6 titles even if
only customizing some.</p></li>
<li><p><strong>Named list</strong> (recommended): A list with plot numbers as
names (e.g., <code>list("3" = "My Custom Title")</code>). Only specified
plots are customized; others use defaults. This allows partial
customization without repeating all titles.</p></li>
</ul><p>Default captions are:</p><ol><li><p>"Residuals vs. Observation Indices"</p></li>
<li><p>"Cook's Distance Plot"</p></li>
<li><p>"Generalized Leverage vs. Fitted Values"</p></li>
<li><p>"Residuals vs. Linear Predictor"</p></li>
<li><p>"Half-Normal Plot of Residuals"</p></li>
<li><p>"Predicted vs. Observed Values"</p></li>
</ol></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>Character string to be prepended to individual plot captions
(from the <code>caption</code> argument). Useful for adding a common prefix
to all plot titles. Defaults to <code>""</code> (no prefix).</p></dd>


<dt id="arg-sub-caption">sub.caption<a class="anchor" aria-label="anchor" href="#arg-sub-caption"></a></dt>
<dd><p>Character string used as a common subtitle positioned
above all plots (especially when multiple plots are arranged). If <code>NULL</code>
(default), automatically generates a subtitle from the model call
(<code>deparse(x$call)</code>). Set to <code>""</code> to suppress the subtitle entirely.</p></dd>


<dt id="arg-ask">ask<a class="anchor" aria-label="anchor" href="#arg-ask"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (and using base R graphics with multiple
plots on an interactive device), the user is prompted before displaying
each plot. If <code>NULL</code> (default), automatically determined: <code>TRUE</code>
if more plots are requested than fit on the current screen layout and the
session is interactive; <code>FALSE</code> otherwise. Explicitly set to
<code>FALSE</code> to disable prompting or <code>TRUE</code> to force prompting.</p></dd>


<dt id="arg-use-ggplot">use_ggplot<a class="anchor" aria-label="anchor" href="#arg-use-ggplot"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, plots are generated using the
<code>ggplot2</code> package, providing modern, publication-quality graphics
with extensive theming capabilities. If <code>FALSE</code> (default), uses base
R graphics, which are faster and require no additional dependencies.
Requires the <code>ggplot2</code> package to be installed if set to <code>TRUE</code>.</p></dd>


<dt id="arg-arrange-plots">arrange_plots<a class="anchor" aria-label="anchor" href="#arg-arrange-plots"></a></dt>
<dd><p>Logical. Only relevant if <code>use_ggplot = TRUE</code> and
multiple plots are requested (<code>length(which) &gt; 1</code>). If <code>TRUE</code>,
attempts to arrange the generated <code>ggplot</code> objects into a grid layout
using either the <code>gridExtra</code> or <code>ggpubr</code> package (requires one
of them to be installed). If <code>FALSE</code> (default), plots are displayed
individually in sequence. Ignored when using base R graphics.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>Integer. Number of simulations used to generate the confidence
envelope in the half-normal plot (<code>which = 5</code>). Higher values provide
more accurate envelopes but increase computation time. Defaults to 100,
which typically provides adequate precision. Must be a positive integer.
Typical range: 50-500.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Numeric. The confidence level (between 0 and 1) for the simulated
envelope in the half-normal plot (<code>which = 5</code>). Defaults to 0.90
(90\<!-- % confidence envelope). Common choices are 0.90, 0.95, or 0.99. Points -->
falling outside this envelope suggest potential model inadequacy or outliers.</p></dd>


<dt id="arg-sample-size">sample_size<a class="anchor" aria-label="anchor" href="#arg-sample-size"></a></dt>
<dd><p>Integer or <code>NULL</code>. If specified as an integer less
than the total number of observations (<code>x$nobs</code>), a random sample of
this size is used for calculating diagnostics and plotting. This can
significantly speed up plot generation for very large datasets (n &gt; 10,000)
with minimal impact on diagnostic interpretation. Defaults to <code>NULL</code>
(use all observations). Recommended values: 1000-5000 for large datasets.</p></dd>


<dt id="arg-theme-fn">theme_fn<a class="anchor" aria-label="anchor" href="#arg-theme-fn"></a></dt>
<dd><p>A function. Only relevant if <code>use_ggplot = TRUE</code>.
Specifies a <code>ggplot2</code> theme function to apply to all plots for
consistent styling (e.g., <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_bw</a></code>,
<code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_classic</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_minimal</a></code>). If
<code>NULL</code> (default), automatically uses <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_minimal</a></code>
when <code>use_ggplot = TRUE</code>. Can also be a custom theme function.
Ignored when using base R graphics.</p></dd>


<dt id="arg-save-diagnostics">save_diagnostics<a class="anchor" aria-label="anchor" href="#arg-save-diagnostics"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the function invisibly
returns a list containing all calculated diagnostic measures (residuals,
leverage, Cook's distance, fitted values, etc.) instead of the model object.
Useful for programmatic access to diagnostic values for custom analysis or
reporting. If <code>FALSE</code> (default), the function invisibly returns the
original model object <code>x</code>. The function is primarily called for its
side effect of generating plots.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional graphical parameters passed to the underlying plotting
functions. For base R graphics, these are standard <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> parameters
such as <code>col</code>, <code>pch</code>, <code>cex</code>, <code>lwd</code>, etc. For ggplot2,
these are typically ignored but can be used for specific geom customizations
in advanced usage. Always specified last to follow R best practices.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns either:</p><ul><li><p>The original fitted model object <code>x</code> (if
<code>save_diagnostics = FALSE</code>, the default). This allows piping or
chaining operations.</p></li>
<li><p>A list containing diagnostic measures (if <code>save_diagnostics = TRUE</code>),
including:</p><ul><li><p><code>data</code>: Data frame with observation indices, observed values,
fitted values, residuals, Cook's distance, leverage, and linear predictors</p></li>
<li><p><code>model_info</code>: List with model metadata (n, p, thresholds,
family, type, etc.)</p></li>
<li><p><code>half_normal</code>: Data frame with half-normal plot data and
envelope (if <code>which</code> includes 5)</p></li>
</ul></li>
</ul><p>The function is primarily called for its side effect of generating diagnostic
plots. The invisible return allows:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="co"># Silent plotting</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Or capture for further use</span></span>
<span><span class="va">diag</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, save_diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diag</span><span class="op">$</span><span class="va">data</span><span class="op">)</span></span></code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Diagnostic plots are essential for evaluating the assumptions and adequacy of
fitted regression models. This function provides a comprehensive suite of
standard diagnostic tools adapted specifically for <code>gkwreg</code> objects,
which model bounded responses in the (0,1) interval.</p>
<div class="section">
<h3 id="residual-types-and-interpretation">Residual Types and Interpretation<a class="anchor" aria-label="anchor" href="#residual-types-and-interpretation"></a></h3>
<p>The choice of residual type (<code>type</code>) is important and depends on the
diagnostic goal:</p>
<ul><li><p><strong>Quantile Residuals</strong> (<code>type = "quantile"</code>):
<strong>Recommended as default</strong> for bounded response models. These residuals
are constructed to be approximately N(0,1) under a correctly specified model,
making standard diagnostic tools (QQ-plots, hypothesis tests) directly
applicable. They are particularly effective for detecting model
misspecification in the distributional family or systematic bias.</p></li>
<li><p><strong>Pearson Residuals</strong> (<code>type = "pearson"</code>):
Standardized residuals that account for the mean-variance relationship.
Useful for assessing whether the assumed variance function is appropriate.
If plots show patterns or non-constant spread, this suggests the variance
model may be misspecified.</p></li>
<li><p><strong>Deviance Residuals</strong> (<code>type = "deviance"</code>):
Based on the contribution of each observation to the model deviance.
Often have more symmetric distributions than Pearson residuals and are
useful for identifying observations that fit poorly according to the
likelihood criterion.</p></li>
</ul></div>

<div class="section">
<h3 id="individual-plot-interpretations">Individual Plot Interpretations<a class="anchor" aria-label="anchor" href="#individual-plot-interpretations"></a></h3>


<p><strong>Plot 1 - Residuals vs. Observation Indices</strong>:</p><ul><li><p><em>Purpose</em>: Detect temporal patterns or autocorrelation</p></li>
<li><p><em>What to look for</em>: Random scatter around zero. Any systematic
patterns (trends, cycles, clusters) suggest autocorrelation or omitted
time-varying predictors.</p></li>
<li><p><em>Action</em>: If patterns are detected, consider adding time-related
predictors or modeling autocorrelation structure.</p></li>
</ul><p><strong>Plot 2 - Cook's Distance</strong>:</p><ul><li><p><em>Purpose</em>: Identify influential observations affecting coefficient estimates</p></li>
<li><p><em>What to look for</em>: Points exceeding the 4/n reference line have
high influence. These observations, if removed, would substantially change
model estimates.</p></li>
<li><p><em>Action</em>: Investigate high-influence points for data entry errors,
outliers, or legitimately unusual cases. Consider sensitivity analysis.</p></li>
</ul><p><strong>Plot 3 - Leverage vs. Fitted Values</strong>:</p><ul><li><p><em>Purpose</em>: Identify observations with unusual predictor combinations</p></li>
<li><p><em>What to look for</em>: Points exceeding the 2p/n reference line have
high leverage. These are unusual in predictor space but may or may not be
influential.</p></li>
<li><p><em>Action</em>: High leverage points deserve scrutiny but are only
problematic if they also have large residuals (check Plots 1, 4).</p></li>
</ul><p><strong>Plot 4 - Residuals vs. Linear Predictor</strong>:</p><ul><li><p><em>Purpose</em>: Detect non-linearity and heteroscedasticity</p></li>
<li><p><em>What to look for</em>: Random scatter around zero with constant spread.
Curved patterns suggest non-linear relationships. Funnel shapes indicate
heteroscedasticity (non-constant variance).</p></li>
<li><p><em>Action</em>: For non-linearity, add polynomial terms or use splines.
For heteroscedasticity, consider alternative link functions or variance models.</p></li>
</ul><p><strong>Plot 5 - Half-Normal Plot with Envelope</strong>:</p><ul><li><p><em>Purpose</em>: Assess overall distributional adequacy</p></li>
<li><p><em>What to look for</em>: Points should follow the reference line and
stay within the simulated envelope. Systematic deviations indicate
distributional misspecification. Isolated points outside the envelope
suggest outliers.</p></li>
<li><p><em>Action</em>: If many points fall outside the envelope, try a different
distributional family or check for outliers and data quality issues.</p></li>
</ul><p><strong>Plot 6 - Predicted vs. Observed</strong>:</p><ul><li><p><em>Purpose</em>: Overall model fit and prediction accuracy</p></li>
<li><p><em>What to look for</em>: Points should cluster around the 45-degree line.
Systematic deviations above or below indicate over- or under-prediction.
Large scatter indicates poor predictive performance.</p></li>
<li><p><em>Action</em>: Poor fit suggests missing predictors, incorrect functional
form, or inappropriate distributional family.</p></li>
</ul></div>

<div class="section">
<h3 id="using-caption-customization">Using Caption Customization<a class="anchor" aria-label="anchor" href="#using-caption-customization"></a></h3>
<p>The new <strong>named list interface</strong> for <code>caption</code> allows elegant partial
customization:</p>
<div class="sourceCode"><pre><code><span></span>
<span><span class="co"># OLD WAY (still supported): Must repeat all 6 titles</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"Residuals vs. Observation Indices"</span>,</span>
<span>  <span class="st">"Cook's Distance Plot"</span>,</span>
<span>  <span class="st">"MY CUSTOM TITLE FOR PLOT 3"</span>,  <span class="co"># Only want to change this</span></span>
<span>  <span class="st">"Residuals vs. Linear Predictor"</span>,</span>
<span>  <span class="st">"Half-Normal Plot of Residuals"</span>,</span>
<span>  <span class="st">"Predicted vs. Observed Values"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># NEW WAY: Specify only what changes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"3"</span> <span class="op">=</span> <span class="st">"MY CUSTOM TITLE FOR PLOT 3"</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># Plots 1,2,4,5,6 automatically use defaults</span></span>
<span></span>
<span><span class="co"># Customize multiple plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Time Series of Residuals"</span>,</span>
<span>  <span class="st">"5"</span> <span class="op">=</span> <span class="st">"Distributional Assessment"</span></span>
<span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

<p>The vector interface remains fully supported for backward compatibility.</p>
</div>

<div class="section">
<h3 id="null-defaults-and-intelligent-behavior">NULL Defaults and Intelligent Behavior<a class="anchor" aria-label="anchor" href="#null-defaults-and-intelligent-behavior"></a></h3>
<p>Several arguments default to <code>NULL</code>, triggering intelligent automatic behavior:</p>
<ul><li><p><code>sub.caption = NULL</code>: Automatically generates subtitle from model call</p></li>
<li><p><code>ask = NULL</code>: Automatically prompts only when needed (multiple plots
on interactive device)</p></li>
<li><p><code>theme_fn = NULL</code>: Automatically uses <code>theme_minimal</code> when
<code>use_ggplot = TRUE</code></p></li>
</ul><p>You can override these by explicitly setting values:</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span>           <span class="co"># Disable subtitle</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>                <span class="co"># Never prompt</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, theme_fn <span class="op">=</span> <span class="va">theme_classic</span><span class="op">)</span>   <span class="co"># Custom theme</span></span></code></pre></div>

</div>

<div class="section">
<h3 id="performance-considerations">Performance Considerations<a class="anchor" aria-label="anchor" href="#performance-considerations"></a></h3>
<p>For large datasets (n &gt; 10,000):</p><ul><li><p>Use <code>sample_size</code> to work with a random subset (e.g.,
<code>sample_size = 2000</code>)</p></li>
<li><p>Reduce <code>nsim</code> for half-normal plot (e.g., <code>nsim = 50</code>)</p></li>
<li><p>Use base R graphics (<code>use_ggplot = FALSE</code>) for faster rendering</p></li>
<li><p>Skip computationally intensive plots: <code>which = c(1,2,4,6)</code>
(excludes half-normal plot)</p></li>
</ul></div>

<div class="section">
<h3 id="graphics-systems">Graphics Systems<a class="anchor" aria-label="anchor" href="#graphics-systems"></a></h3>
<p><strong>Base R Graphics</strong> (<code>use_ggplot = FALSE</code>):</p><ul><li><p>Faster rendering, especially for large datasets</p></li>
<li><p>No external dependencies beyond base R</p></li>
<li><p>Traditional R look and feel</p></li>
<li><p>Interactive <code>ask</code> prompting supported</p></li>
<li><p>Customize via <code>...</code> parameters (standard <code><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par()</a></code> settings)</p></li>
</ul><p><strong>ggplot2 Graphics</strong> (<code>use_ggplot = TRUE</code>):</p><ul><li><p>Modern, publication-quality aesthetics</p></li>
<li><p>Consistent theming via <code>theme_fn</code></p></li>
<li><p>Grid arrangement support via <code>arrange_plots</code></p></li>
<li><p>Requires <code>ggplot2</code> package (and optionally <code>gridExtra</code> or
<code>ggpubr</code> for arrangements)</p></li>
<li><p>No interactive <code>ask</code> prompting (ggplot limitation)</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Dunn, P. K., &amp; Smyth, G. K. (1996). Randomized Quantile Residuals.
<em>Journal of Computational and Graphical Statistics</em>, <strong>5</strong>(3), 236-244.
<a href="https://doi.org/10.1080/10618600.1996.10474708" class="external-link">doi:10.1080/10618600.1996.10474708</a></p>
<p>Cook, R. D. (1977). Detection of Influential Observation in Linear Regression.
<em>Technometrics</em>, <strong>19</strong>(1), 15-18.
<a href="https://doi.org/10.1080/00401706.1977.10489493" class="external-link">doi:10.1080/00401706.1977.10489493</a></p>
<p>Atkinson, A. C. (1985). <em>Plots, Transformations and Regression</em>.
Oxford University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index">
<ul><li><p><code><a href="gkwreg.html">gkwreg</a></code> for fitting Generalized Kumaraswamy regression models</p></li>
<li><p><code><a href="residuals.gkwreg.html">residuals.gkwreg</a></code> for extracting different types of residuals</p></li>
<li><p><code><a href="fitted.gkwreg.html">fitted.gkwreg</a></code> for extracting fitted values</p></li>
<li><p><code><a href="summary.gkwreg.html">summary.gkwreg</a></code> for model summaries</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/plot.lm.html" class="external-link">plot.lm</a></code> for analogous diagnostics in linear models</p></li>
<li><p><code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code> for ggplot2 graphics system</p></li>
<li><p><code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></code> for arranging ggplot2 plots</p></li>
</ul></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lopes, J. E.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 1: Basic Usage with Default Settings</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwdist" class="external-link">gkwdist</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">200</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True model parameters</span></span></span>
<span class="r-in"><span><span class="va">alpha_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.7</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.2</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://evandeilton.github.io/gkwdist/reference/rkw.html" class="external-link">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">alpha_true</span>, beta <span class="op">=</span> <span class="va">beta_true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate all diagnostic plots with defaults</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 2: Selective Plots with Custom Residual Type</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Focus on key diagnostic plots only</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>, <span class="co"># Cook's distance, Resid vs LinPred, Half-normal</span></span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"pearson"</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Use Pearson residuals</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check for influential points (plot 2) and non-linearity (plot 4)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"deviance"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 3: Caption Customization - New Named List Interface</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize only specific plot titles (RECOMMENDED NEW WAY)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"1"</span> <span class="op">=</span> <span class="st">"Time Pattern Check"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"4"</span> <span class="op">=</span> <span class="st">"Linearity Assessment"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"6"</span> <span class="op">=</span> <span class="st">"Predictive Accuracy"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize subtitle and main title</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Model Diagnostics"</span>,</span></span>
<span class="r-in"><span>  sub.caption <span class="op">=</span> <span class="st">"Kumaraswamy Regression - Training Data"</span>,</span></span>
<span class="r-in"><span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"5"</span> <span class="op">=</span> <span class="st">"Normality Check with 95% Envelope"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Suppress subtitle entirely</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 4: Backward Compatible Caption (Vector Interface)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># OLD WAY - still fully supported</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"Residual Pattern Analysis"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Influence Diagnostics"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Leverage Assessment"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Linearity Check"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Distributional Fit"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"Prediction Quality"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 5: ggplot2 Graphics with Theming</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Modern publication-quality plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  arrange_plots <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With custom theme</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  theme_fn <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span>,</span></span>
<span class="r-in"><span>  arrange_plots <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-9.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># With classic theme and custom colors (via ...)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  theme_fn <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span>,</span></span>
<span class="r-in"><span>  arrange_plots <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-10.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 6: Arranged Multi-Panel ggplot2 Display</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Requires gridExtra or ggpubr package</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>,</span></span>
<span class="r-in"><span>  use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  arrange_plots <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Arrange in grid</span></span></span>
<span class="r-in"><span>  theme_fn <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-11.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Focus plots in 2x2 grid</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  arrange_plots <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"2"</span> <span class="op">=</span> <span class="st">"Influential Cases"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"3"</span> <span class="op">=</span> <span class="st">"High Leverage Points"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-12.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 7: Half-Normal Plot Customization</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Higher precision envelope (more simulations)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  nsim <span class="op">=</span> <span class="fl">500</span>, <span class="co"># More accurate envelope</span></span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># 95% confidence level</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 500 iterations): .......... Done!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quick envelope for large datasets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  nsim <span class="op">=</span> <span class="fl">500</span>, <span class="co"># Faster computation</span></span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fl">0.90</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 500 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-13.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 8: Different Residual Types Comparison</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare different residual types</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, which <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"quantile"</span>, main <span class="op">=</span> <span class="st">"Quantile"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, which <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"pearson"</span>, main <span class="op">=</span> <span class="st">"Pearson"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, which <span class="op">=</span> <span class="fl">4</span>, type <span class="op">=</span> <span class="st">"deviance"</span>, main <span class="op">=</span> <span class="st">"Deviance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-14.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Quantile residuals for half-normal plot (recommended)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, which <span class="op">=</span> <span class="fl">5</span>, type <span class="op">=</span> <span class="st">"quantile"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-15.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 9: Family Comparison Diagnostics</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare diagnostics under different distributional assumptions</span></span></span>
<span class="r-in"><span><span class="co"># Helps assess if alternative family would fit better</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>, <span class="co"># Original family</span></span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Kumaraswamy"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"beta"</span>, <span class="co"># Alternative family</span></span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Beta"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using different family (beta) than what was used to fit the model (kw) for diagnostics.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using different family (beta) than what was used to fit the model (kw). Recalculating fitted values...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-16.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 10: Large Dataset - Performance Optimization</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate large dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n_large</span> <span class="op">&lt;-</span> <span class="fl">50000</span></span></span>
<span class="r-in"><span><span class="va">x1_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n_large</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n_large</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">alpha_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x1_large</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.0</span> <span class="op">-</span> <span class="fl">0.1</span> <span class="op">*</span> <span class="va">x2_large</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://evandeilton.github.io/gkwdist/reference/rkw.html" class="external-link">rkw</a></span><span class="op">(</span><span class="va">n_large</span>, alpha <span class="op">=</span> <span class="va">alpha_large</span>, beta <span class="op">=</span> <span class="va">beta_large</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y_large</span>, x1 <span class="op">=</span> <span class="va">x1_large</span>, x2 <span class="op">=</span> <span class="va">x2_large</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model_large</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df_large</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Optimized plotting for large dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_large</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>, <span class="co"># Skip computationally intensive plot 5</span></span></span>
<span class="r-in"><span>  sample_size <span class="op">=</span> <span class="fl">2000</span>, <span class="co"># Use random sample of 2000 observations</span></span></span>
<span class="r-in"><span>  ask <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Don't prompt</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-17.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># If half-normal plot needed, reduce simulations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_large</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  sample_size <span class="op">=</span> <span class="fl">1000</span>, <span class="co"># Smaller sample</span></span></span>
<span class="r-in"><span>  nsim <span class="op">=</span> <span class="fl">50</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Fewer simulations</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 50 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-18.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 11: Saving Diagnostic Data for Custom Analysis</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract diagnostic measures without plotting</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diag_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_large</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>  save_diagnostics <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine structure</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">diag_data</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ data       :'data.frame':	50000 obs. of  8 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ index    : int [1:50000] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ y_obs    : num [1:50000] 0.185 0.272 0.771 0.135 0.833 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ fitted   : num [1:50000] 0.329 0.352 0.472 0.506 0.498 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ resid    : num [1:50000] -0.45 -0.196 1.363 -1.821 1.697 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ abs_resid: num [1:50000] 0.45 0.196 1.363 1.821 1.697 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cook_dist: num [1:50000] 3.66e-04 6.51e-05 1.08e-02 3.33e-03 9.21e-03 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ leverage : num [1:50000] 0.00716 0.00669 0.02227 0.00401 0.01253 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ linpred  : num [1:50000] 0.165 0.262 0.681 0.776 0.725 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ model_info :List of 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ n                 : int 50000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ p                 : num 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ cook_threshold    : num 8e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ leverage_threshold: num 0.00016</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ family            : chr "kw"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ type              : chr "quantile"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ param_info        :List of 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ names    : chr [1:2] "alpha" "beta"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ n        : num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ fixed    :List of 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ gamma : num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ delta : num 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ lambda: num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. ..$ positions:List of 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ alpha: num 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   .. .. ..$ beta : num 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ level             : num 0.9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  $ half_normal:'data.frame':	50000 obs. of  5 variables:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ index      : int [1:50000] 1 2 3 4 5 6 7 8 9 10 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ theoretical: num [1:50000] 1.25e-05 3.76e-05 6.27e-05 8.77e-05 1.13e-04 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ observed   : num [1:50000] 3.04e-05 3.62e-05 7.93e-05 9.25e-05 1.07e-04 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ lower      : num [1:50000] 7.54e-07 8.56e-06 1.97e-05 3.05e-05 4.20e-05 ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   ..$ upper      : num [1:50000] 6.62e-05 1.18e-04 1.43e-04 1.70e-04 2.02e-04 ...</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Access diagnostic measures</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diag_data</span><span class="op">$</span><span class="va">data</span><span class="op">)</span> <span class="co"># Residuals, Cook's distance, leverage, etc.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   index     y_obs    fitted      resid abs_resid    cook_dist    leverage</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 0.1850315 0.3293218 -0.4500848 0.4500848 3.660713e-04 0.007162107</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 0.2724554 0.3517257 -0.1964963 0.1964963 6.513023e-05 0.006691892</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3 0.7706749 0.4715884  1.3630349 1.3630349 1.076532e-02 0.022271859</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4 0.1350742 0.5059801 -1.8211089 1.8211089 3.331286e-03 0.004006455</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5 0.8325809 0.4979620  1.6974135 1.6974135 9.205032e-03 0.012525889</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6 0.4941673 0.3895391  0.5363847 0.5363847 8.755918e-04 0.011945865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     linpred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.1652265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.2621458</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.6807510</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.7762421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.7251742</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.3594552</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify influential observations</span></span></span>
<span class="r-in"><span><span class="va">influential</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">diag_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">cook_dist</span> <span class="op">&gt;</span> <span class="va">diag_data</span><span class="op">$</span><span class="va">model_info</span><span class="op">$</span><span class="va">cook_threshold</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Influential observations:"</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">influential</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Influential observations: 1 3 4 5 6 7 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># High leverage points</span></span></span>
<span class="r-in"><span><span class="va">high_lev</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">diag_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">leverage</span> <span class="op">&gt;</span> <span class="va">diag_data</span><span class="op">$</span><span class="va">model_info</span><span class="op">$</span><span class="va">leverage_threshold</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"High leverage points:"</span>, <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">high_lev</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> High leverage points: 1 2 3 4 5 6 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Custom diagnostic plot using saved data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">diag_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">fitted</span>, <span class="va">diag_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">resid</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Fitted Values"</span>, ylab <span class="op">=</span> <span class="st">"Residuals"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Custom Diagnostic Plot"</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/ifelse.html" class="external-link">ifelse</a></span><span class="op">(</span><span class="va">diag_data</span><span class="op">$</span><span class="va">data</span><span class="op">$</span><span class="va">cook_dist</span> <span class="op">&gt;</span></span></span>
<span class="r-in"><span>    <span class="va">diag_data</span><span class="op">$</span><span class="va">model_info</span><span class="op">$</span><span class="va">cook_threshold</span>, <span class="st">"red"</span>, <span class="st">"black"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, col <span class="op">=</span> <span class="st">"gray"</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="st">"Influential"</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-19.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 12: Interactive Plotting Control</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ask = TRUE Force prompting between plots (useful for presentations)</span></span></span>
<span class="r-in"><span><span class="co"># Disable prompting (batch processing)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>  ask <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Never prompts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="plot.gkwreg-20.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 13: Base R Graphics Customization via ...</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Customize point appearance</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">6</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">16</span>, <span class="co"># Filled circles</span></span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"steelblue"</span>, <span class="co"># Blue points</span></span></span>
<span class="r-in"><span>  cex <span class="op">=</span> <span class="fl">0.8</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Smaller points</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Multiple customizations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">21</span>, <span class="co"># Circles with border</span></span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"black"</span>, <span class="co"># Border color</span></span></span>
<span class="r-in"><span>  bg <span class="op">=</span> <span class="st">"lightblue"</span>, <span class="co"># Fill color</span></span></span>
<span class="r-in"><span>  cex <span class="op">=</span> <span class="fl">1.2</span>, <span class="co"># Larger points</span></span></span>
<span class="r-in"><span>  lwd <span class="op">=</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Thicker lines</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-21.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 14: Comparing Models</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit competing models</span></span></span>
<span class="r-in"><span><span class="va">model_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare diagnostics side-by-side</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Kumaraswamy model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_kw</span>, which <span class="op">=</span> <span class="fl">5</span>, main <span class="op">=</span> <span class="st">"Kumaraswamy - Half-Normal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_kw</span>, which <span class="op">=</span> <span class="fl">6</span>, main <span class="op">=</span> <span class="st">"Kumaraswamy - Pred vs Obs"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Beta model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_beta</span>, which <span class="op">=</span> <span class="fl">5</span>, main <span class="op">=</span> <span class="st">"Beta - Half-Normal"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model_beta</span>, which <span class="op">=</span> <span class="fl">6</span>, main <span class="op">=</span> <span class="st">"Beta - Pred vs Obs"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot.gkwreg-22.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by José Evandeilton Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

