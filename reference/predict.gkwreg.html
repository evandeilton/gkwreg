<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Predictions from a Fitted Generalized Kumaraswamy Regression Model — predict.gkwreg • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Predictions from a Fitted Generalized Kumaraswamy Regression Model — predict.gkwreg"><meta name="description" content="Computes predictions and related quantities from a fitted Generalized
Kumaraswamy (GKw) regression model object. This method can extract fitted values,
predicted means, linear predictors, parameter values, variances, densities,
probabilities, and quantiles based on the estimated model. Predictions can be made
for new data or for the original data used to fit the model."><meta property="og:description" content="Computes predictions and related quantities from a fitted Generalized
Kumaraswamy (GKw) regression model object. This method can extract fitted values,
predicted means, linear predictors, parameter values, variances, densities,
probabilities, and quantiles based on the estimated model. Predictions can be made
for new data or for the original data used to fit the model."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.12</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gkwreg-vs-betareg.html">Beta Regression vs Kumaraswamy-Based Models for Bounded Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/gkwreg" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Predictions from a Fitted Generalized Kumaraswamy Regression Model</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/gkwreg/blob/main/R/gkwreg-predict.R" class="external-link"><code>R/gkwreg-predict.R</code></a></small>
      <div class="d-none name"><code>predict.gkwreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes predictions and related quantities from a fitted Generalized
Kumaraswamy (GKw) regression model object. This method can extract fitted values,
predicted means, linear predictors, parameter values, variances, densities,
probabilities, and quantiles based on the estimated model. Predictions can be made
for new data or for the original data used to fit the model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gkwreg'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  newdata <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  type <span class="op">=</span> <span class="st">"response"</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu">stats</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.pass</a></span>,</span>
<span>  at <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  elementwise <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  family <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code>"gkwreg"</code>, typically the result of a
call to <code><a href="gkwreg.html">gkwreg</a></code>.</p></dd>


<dt id="arg-newdata">newdata<a class="anchor" aria-label="anchor" href="#arg-newdata"></a></dt>
<dd><p>An optional data frame containing the variables needed for prediction.
If omitted, predictions are made for the data used to fit the model.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>A character string specifying the type of prediction. Options are:</p><dl><dt><code>"response"</code> or <code>"mean"</code></dt>
<dd><p>Predicted mean response (default).</p></dd>

<dt><code>"link"</code></dt>
<dd><p>Linear predictors for each parameter before applying
inverse link functions.</p></dd>

<dt><code>"parameter"</code></dt>
<dd><p>Parameter values on their original scale (after
applying inverse link functions).</p></dd>

<dt><code>"alpha"</code>, <code>"beta"</code>, <code>"gamma"</code>, <code>"delta"</code>,
<code>"lambda"</code></dt>
<dd><p>Values for a specific distribution parameter.</p></dd>

<dt><code>"variance"</code></dt>
<dd><p>Predicted variance of the response.</p></dd>

<dt><code>"density"</code> or <code>"pdf"</code></dt>
<dd><p>Density function values at points
specified by <code>at</code>.</p></dd>

<dt><code>"probability"</code> or <code>"cdf"</code></dt>
<dd><p>Cumulative distribution function
values at points specified by <code>at</code>.</p></dd>

<dt><code>"quantile"</code></dt>
<dd><p>Quantiles corresponding to probabilities specified
by <code>at</code>.</p></dd>


</dl></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>Function determining how to handle missing values in <code>newdata</code>.
Default is <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">stats::na.pass</a></code>, which returns <code>NA</code> for cases with missing
predictors.</p></dd>


<dt id="arg-at">at<a class="anchor" aria-label="anchor" href="#arg-at"></a></dt>
<dd><p>Numeric vector of values at which to evaluate densities, probabilities,
or for which to compute quantiles, depending on <code>type</code>. Required for
<code>type = "density"</code>, <code>type = "probability"</code>, or <code>type = "quantile"</code>.
Defaults to 0.5.</p></dd>


<dt id="arg-elementwise">elementwise<a class="anchor" aria-label="anchor" href="#arg-elementwise"></a></dt>
<dd><p>Logical. If <code>TRUE</code> and <code>at</code> has the same length as
the number of observations, applies each value in <code>at</code> to the corresponding
observation. If <code>FALSE</code> (default), applies all values in <code>at</code> to each
observation, returning a matrix.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>Character string specifying the distribution family to use for
calculations. If <code>NULL</code> (default), uses the family from the fitted model.
Options match those in <code><a href="gkwreg.html">gkwreg</a></code>: <code>"gkw"</code>, <code>"bkw"</code>,
<code>"kkw"</code>, <code>"ekw"</code>, <code>"mc"</code>, <code>"kw"</code>, <code>"beta"</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (currently not used).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>The return value depends on the <code>type</code> argument:</p><ul><li><p>For <code>type = "response"</code>, <code>type = "variance"</code>, or individual
parameters (<code>type = "alpha"</code>, etc.): A numeric vector of length equal
to the number of rows in <code>newdata</code> (or the original data).</p></li>
<li><p>For <code>type = "link"</code> or <code>type = "parameter"</code>: A data frame with
columns for each parameter and rows corresponding to observations.</p></li>
<li><p>For <code>type = "density"</code>, <code>type = "probability"</code>, or
<code>type = "quantile"</code>:</p><ul><li><p>If <code>elementwise = TRUE</code>: A numeric vector of length equal to
the number of rows in <code>newdata</code> (or the original data).</p></li>
<li><p>If <code>elementwise = FALSE</code>: A matrix where rows correspond to
observations and columns correspond to the values in <code>at</code>.</p></li>
</ul></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>predict.gkwreg</code> function provides a flexible framework for obtaining
predictions and inference from fitted Generalized Kumaraswamy regression models.
It handles all subfamilies of GKw distributions and respects the parametrization
and link functions specified in the original model.</p>
<div class="section">
<h3 id="prediction-types">Prediction Types<a class="anchor" aria-label="anchor" href="#prediction-types"></a></h3>
<p>The function supports several types of predictions:</p><ul><li><p><strong>Response/Mean</strong>: Computes the expected value of the response variable
based on the model parameters. For most GKw family distributions, this requires
numerical integration or special formulas.</p></li>
<li><p><strong>Link</strong>: Returns the linear predictors for each parameter without
applying inverse link functions. These are the values \(\eta_j = X\beta_j\)
for each parameter \(j\).</p></li>
<li><p><strong>Parameter</strong>: Computes the distribution parameter values on their original
scale by applying the appropriate inverse link functions to the linear predictors.
For example, if alpha uses a log link, then \(\alpha = \exp(X\beta_\alpha)\).</p></li>
<li><p><strong>Individual Parameters</strong>: Extract specific parameter values (alpha, beta,
gamma, delta, lambda) on their original scale.</p></li>
<li><p><strong>Variance</strong>: Estimates the variance of the response based on the model
parameters. For some distributions, analytical formulas are used; for others,
numerical approximations are employed.</p></li>
<li><p><strong>Density/PDF</strong>: Evaluates the probability density function at specified
points given the model parameters.</p></li>
<li><p><strong>Probability/CDF</strong>: Computes the cumulative distribution function at
specified points given the model parameters.</p></li>
<li><p><strong>Quantile</strong>: Calculates quantiles corresponding to specified probabilities
given the model parameters.</p></li>
</ul></div>

<div class="section">
<h3 id="link-functions">Link Functions<a class="anchor" aria-label="anchor" href="#link-functions"></a></h3>
<p>The function respects the link functions specified in the original model for each
parameter. The supported link functions are:</p><ul><li><p><code>"log"</code>: \(g(\mu) = \log(\mu)\), \(g^{-1}(\eta) = \exp(\eta)\)</p></li>
<li><p><code>"logit"</code>: \(g(\mu) = \log(\mu/(1-\mu))\), \(g^{-1}(\eta) = 1/(1+\exp(-\eta))\)</p></li>
<li><p><code>"probit"</code>: \(g(\mu) = \Phi^{-1}(\mu)\), \(g^{-1}(\eta) = \Phi(\eta)\)</p></li>
<li><p><code>"cauchy"</code>: \(g(\mu) = \tan(\pi*(\mu-0.5))\), \(g^{-1}(\eta) = 0.5 + (1/\pi) \arctan(\eta)\)</p></li>
<li><p><code>"cloglog"</code>: \(g(\mu) = \log(-\log(1-\mu))\), \(g^{-1}(\eta) = 1 - \exp(-\exp(\eta))\)</p></li>
<li><p><code>"identity"</code>: \(g(\mu) = \mu\), \(g^{-1}(\eta) = \eta\)</p></li>
<li><p><code>"sqrt"</code>: \(g(\mu) = \sqrt{\mu}\), \(g^{-1}(\eta) = \eta^2\)</p></li>
<li><p><code>"inverse"</code>: \(g(\mu) = 1/\mu\), \(g^{-1}(\eta) = 1/\eta\)</p></li>
<li><p><code>"inverse-square"</code>: \(g(\mu) = 1/\sqrt{\mu}\), \(g^{-1}(\eta) = 1/\eta^2\)</p></li>
</ul></div>

<div class="section">
<h3 id="family-specific-constraints">Family-Specific Constraints<a class="anchor" aria-label="anchor" href="#family-specific-constraints"></a></h3>
<p>The function enforces appropriate constraints for each distribution family:</p><ul><li><p><code>"gkw"</code>: All 5 parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) are used.</p></li>
<li><p><code>"bkw"</code>: \(\lambda = 1\) is fixed.</p></li>
<li><p><code>"kkw"</code>: \(\gamma = 1\) is fixed.</p></li>
<li><p><code>"ekw"</code>: \(\gamma = 1, \delta = 0\) are fixed.</p></li>
<li><p><code>"mc"</code>: \(\alpha = 1, \beta = 1\) are fixed.</p></li>
<li><p><code>"kw"</code>: \(\gamma = 1, \delta = 0, \lambda = 1\) are fixed.</p></li>
<li><p><code>"beta"</code>: \(\alpha = 1, \beta = 1, \lambda = 1\) are fixed.</p></li>
</ul></div>

<div class="section">
<h3 id="parameter-bounds">Parameter Bounds<a class="anchor" aria-label="anchor" href="#parameter-bounds"></a></h3>
<p>All parameters are constrained to their valid ranges:</p><ul><li><p>\(\alpha, \beta, \gamma, \lambda &gt; 0\)</p></li>
<li><p>\(0 &lt; \delta &lt; 1\)</p></li>
</ul></div>

<div class="section">
<h3 id="using-with-new-data">Using with New Data<a class="anchor" aria-label="anchor" href="#using-with-new-data"></a></h3>
<p>When providing <code>newdata</code>, ensure it contains all variables used in the model's
formula. The function extracts the terms for each parameter's model matrix and applies
the appropriate link functions to calculate predictions. If any variables are missing,
the function will attempt to substitute reasonable defaults or raise an error if
critical variables are absent.</p>
</div>

<div class="section">
<h3 id="using-for-model-evaluation">Using for Model Evaluation<a class="anchor" aria-label="anchor" href="#using-for-model-evaluation"></a></h3>
<p>The function is useful for model checking, generating predicted values for plotting,
and evaluating the fit of different distribution families. By specifying the <code>family</code>
parameter, you can compare predictions under different distributional assumptions.</p>
</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of generalized distributions.
<em>Journal of Statistical Computation and Simulation</em>, <strong>81</strong>(7), 883-898.</p>
<p>Kumaraswamy, P. (1980). A generalized probability density function for double-bounded
random processes. <em>Journal of Hydrology</em>, <strong>46</strong>(1-2), 79-88.</p>
<p>Ferrari, S. L. P., &amp; Cribari-Neto, F. (2004). Beta regression for modelling rates and
proportions. <em>Journal of Applied Statistics</em>, <strong>31</strong>(7), 799-815.</p>
<p>Jones, M. C. (2009). Kumaraswamy's distribution: A beta-type distribution with some
tractability advantages. <em>Statistical Methodology</em>, <strong>6</strong>(1), 70-81.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gkwreg.html">gkwreg</a></code> for fitting Generalized Kumaraswamy regression models,
<code><a href="fitted.gkwreg.html">fitted.gkwreg</a></code> for extracting fitted values,
<code><a href="residuals.gkwreg.html">residuals.gkwreg</a></code> for calculating residuals,
<code><a href="summary.gkwreg.html">summary.gkwreg</a></code> for model summaries,
<code><a href="coef.gkwreg.html">coef.gkwreg</a></code> for extracting coefficients.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lopes, J. E. and contributors</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Generate a sample dataset (n = 1000)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwdist" class="external-link">gkwdist</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create predictors</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate Kumaraswamy distributed data</span></span></span>
<span class="r-in"><span><span class="co"># True parameters with specific relationships to predictors</span></span></span>
<span class="r-in"><span><span class="va">true_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.7</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">true_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.2</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x2</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="op">(</span><span class="va">x3</span> <span class="op">==</span> <span class="st">"1"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random responses</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://evandeilton.github.io/gkwdist/reference/rkw.html" class="external-link">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">true_alpha</span>, beta <span class="op">=</span> <span class="va">true_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Ensure responses are strictly in (0, 1)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1e-7</span><span class="op">)</span>, <span class="fl">1e-7</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Split into training and test sets</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train_idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">800</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">train_data</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="va">train_idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="va">df</span><span class="op">[</span><span class="op">-</span><span class="va">train_idx</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Basic usage - Fit a Kumaraswamy model and make predictions</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit the model</span></span></span>
<span class="r-in"><span><span class="va">kw_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>, data <span class="op">=</span> <span class="va">train_data</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict mean response for test data</span></span></span>
<span class="r-in"><span><span class="va">pred_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate prediction error</span></span></span>
<span class="r-in"><span><span class="va">mse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">pred_mean</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Mean Squared Error:"</span>, <span class="va">mse</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Squared Error: 0.02982227 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Different prediction types</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a grid of values for visualization</span></span></span>
<span class="r-in"><span><span class="va">x1_grid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">grid_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1_grid</span>, x2 <span class="op">=</span> <span class="fl">0</span>, x3 <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict different quantities</span></span></span>
<span class="r-in"><span><span class="va">pred_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">grid_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_var</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">grid_data</span>, type <span class="op">=</span> <span class="st">"variance"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">grid_data</span>, type <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">grid_data</span>, type <span class="op">=</span> <span class="st">"alpha"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">grid_data</span>, type <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot predicted mean and parameters against x1</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1_grid</span>, <span class="va">pred_mean</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"Predicted Mean"</span>, main <span class="op">=</span> <span class="st">"Mean Response vs x1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1_grid</span>, <span class="va">pred_var</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"Predicted Variance"</span>, main <span class="op">=</span> <span class="st">"Response Variance vs x1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1_grid</span>, <span class="va">pred_alpha</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"purple"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"Alpha"</span>, main <span class="op">=</span> <span class="st">"Alpha Parameter vs x1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1_grid</span>, <span class="va">pred_beta</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"green"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"Beta"</span>, main <span class="op">=</span> <span class="st">"Beta Parameter vs x1"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Computing densities, CDFs, and quantiles</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Select a single observation</span></span></span>
<span class="r-in"><span><span class="va">obs_data</span> <span class="op">&lt;-</span> <span class="va">test_data</span><span class="op">[</span><span class="fl">1</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a sequence of y values for plotting</span></span></span>
<span class="r-in"><span><span class="va">y_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.01</span>, <span class="fl">0.99</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute density at each y value</span></span></span>
<span class="r-in"><span><span class="va">dens_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="va">obs_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"density"</span>, at <span class="op">=</span> <span class="va">y_seq</span>, elementwise <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute CDF at each y value</span></span></span>
<span class="r-in"><span><span class="va">cdf_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="va">obs_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"probability"</span>, at <span class="op">=</span> <span class="va">y_seq</span>, elementwise <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute quantiles for a sequence of probabilities</span></span></span>
<span class="r-in"><span><span class="va">prob_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.9</span>, by <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">quant_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="va">obs_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"quantile"</span>, at <span class="op">=</span> <span class="va">prob_seq</span>, elementwise <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot density and CDF</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y_seq</span>, <span class="va">dens_values</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"blue"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"y"</span>, ylab <span class="op">=</span> <span class="st">"Density"</span>, main <span class="op">=</span> <span class="st">"Predicted PDF"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">y_seq</span>, <span class="va">cdf_values</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="st">"red"</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"y"</span>, ylab <span class="op">=</span> <span class="st">"Cumulative Probability"</span>, main <span class="op">=</span> <span class="st">"Predicted CDF"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 4: Prediction under different distributional assumptions</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit models with different families</span></span></span>
<span class="r-in"><span><span class="va">beta_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>, data <span class="op">=</span> <span class="va">train_data</span>, family <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gkw_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">x3</span>, data <span class="op">=</span> <span class="va">train_data</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict means using different families</span></span></span>
<span class="r-in"><span><span class="va">pred_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">gkw_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate MSE for each family</span></span></span>
<span class="r-in"><span><span class="va">mse_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">pred_kw</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mse_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">pred_beta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mse_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span> <span class="op">-</span> <span class="va">pred_gkw</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"MSE by family:\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> MSE by family:</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Kumaraswamy:"</span>, <span class="va">mse_kw</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Kumaraswamy: 0.02982227 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Beta:"</span>, <span class="va">mse_beta</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beta: 0.06684878 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"GKw:"</span>, <span class="va">mse_gkw</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> GKw: 0.03221942 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare predictions from different families visually</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span>, <span class="va">pred_kw</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="st">"blue"</span>, pch <span class="op">=</span> <span class="fl">16</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Observed"</span>, ylab <span class="op">=</span> <span class="st">"Predicted"</span>, main <span class="op">=</span> <span class="st">"Predicted vs Observed"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span>, <span class="va">pred_beta</span>, col <span class="op">=</span> <span class="st">"red"</span>, pch <span class="op">=</span> <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">y</span>, <span class="va">pred_gkw</span>, col <span class="op">=</span> <span class="st">"green"</span>, pch <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topleft"</span>,</span></span>
<span class="r-in"><span>  legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Kumaraswamy"</span>, <span class="st">"Beta"</span>, <span class="st">"GKw"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"blue"</span>, <span class="st">"red"</span>, <span class="st">"green"</span><span class="op">)</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">17</span>, <span class="fl">18</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 5: Working with linear predictors and link functions</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract linear predictors and parameter values</span></span></span>
<span class="r-in"><span><span class="va">lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Verify that inverse link transformation works correctly</span></span></span>
<span class="r-in"><span><span class="co"># For Kumaraswamy model, alpha and beta use log links by default</span></span></span>
<span class="r-in"><span><span class="va">alpha_from_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lp</span><span class="op">$</span><span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_from_lp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">lp</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with direct parameter predictions</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Manual inverse link vs direct parameter prediction:\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Manual inverse link vs direct parameter prediction:</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Alpha difference:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">alpha_from_lp</span> <span class="op">-</span> <span class="va">params</span><span class="op">$</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Alpha difference: 0 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Beta difference:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">beta_from_lp</span> <span class="op">-</span> <span class="va">params</span><span class="op">$</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Beta difference: 0 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 6: Elementwise calculations</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate probabilities specific to each observation</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span>, <span class="fl">0.1</span>, <span class="fl">0.9</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate quantiles for each observation at its own probability level</span></span></span>
<span class="r-in"><span><span class="va">quant_elementwise</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="va">test_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"quantile"</span>, at <span class="op">=</span> <span class="va">probs</span>, elementwise <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate probabilities at each observation's actual value</span></span></span>
<span class="r-in"><span><span class="va">prob_at_y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>,</span></span>
<span class="r-in"><span>  newdata <span class="op">=</span> <span class="va">test_data</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"probability"</span>, at <span class="op">=</span> <span class="va">test_data</span><span class="op">$</span><span class="va">y</span>, elementwise <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create Q-Q plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sort.html" class="external-link">sort</a></span><span class="op">(</span><span class="va">prob_at_y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">prob_at_y</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Empirical Probability"</span>, ylab <span class="op">=</span> <span class="st">"Theoretical Probability"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"P-P Plot"</span>, type <span class="op">=</span> <span class="st">"l"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="predict.gkwreg-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 7: Predicting for the original data</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a model with original data</span></span></span>
<span class="r-in"><span><span class="va">full_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">+</span> <span class="va">x3</span>, data <span class="op">=</span> <span class="va">df</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get fitted values using predict and compare with model's fitted.values</span></span></span>
<span class="r-in"><span><span class="va">fitted_from_predict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">full_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fitted_from_model</span> <span class="op">&lt;-</span> <span class="va">full_model</span><span class="op">$</span><span class="va">fitted.values</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Max difference between predict() and fitted.values:"</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">fitted_from_predict</span> <span class="op">-</span> <span class="va">fitted_from_model</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Max difference between predict() and fitted.values: 0 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 8: Handling missing data</span></span></span>
<span class="r-in"><span><span class="co"># ====================================================================</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create test data with some missing values</span></span></span>
<span class="r-in"><span><span class="va">test_missing</span> <span class="op">&lt;-</span> <span class="va">test_data</span></span></span>
<span class="r-in"><span><span class="va">test_missing</span><span class="op">$</span><span class="va">x1</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span><span class="va">test_missing</span><span class="op">$</span><span class="va">x2</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict with different na.action options</span></span></span>
<span class="r-in"><span><span class="va">pred_na_pass</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">test_missing</span>, na.action <span class="op">=</span> <span class="va">na.pass</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test_missing</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_na_omit</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">kw_model</span>, newdata <span class="op">=</span> <span class="va">test_missing</span>, na.action <span class="op">=</span> <span class="va">na.omit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">test_missing</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Show which positions have NAs</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Rows with missing predictors:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">pred_na_pass</span><span class="op">)</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Rows with missing predictors:  </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Length after na.omit:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">pred_na_omit</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Length after na.omit: 195 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by José Evandeilton Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

