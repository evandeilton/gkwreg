<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Analysis of Deviance for GKw Regression Models — anova.gkwreg • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Analysis of Deviance for GKw Regression Models — anova.gkwreg"><meta name="description" content="Computes an analysis of deviance table for one or more fitted Generalized
Kumaraswamy (GKw) regression model objects. When multiple models are provided,
likelihood ratio tests are performed to compare nested models."><meta property="og:description" content="Computes an analysis of deviance table for one or more fitted Generalized
Kumaraswamy (GKw) regression model objects. When multiple models are provided,
likelihood ratio tests are performed to compare nested models."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gkwreg-vs-betareg.html">Beta Regression vs Kumaraswamy-Based Models for Bounded Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/gkwreg" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Analysis of Deviance for GKw Regression Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/gkwreg/blob/main/R/gkwreg-anova.R" class="external-link"><code>R/gkwreg-anova.R</code></a></small>
      <div class="d-none name"><code>anova.gkwreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes an analysis of deviance table for one or more fitted Generalized
Kumaraswamy (GKw) regression model objects. When multiple models are provided,
likelihood ratio tests are performed to compare nested models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gkwreg'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span>, test <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Chisq"</span>, <span class="st">"none"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An object of class <code>"gkwreg"</code>, typically obtained from
<code><a href="gkwreg.html">gkwreg</a></code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional objects of class <code>"gkwreg"</code> for model comparison.
Models must be nested and fitted to the same dataset.</p></dd>


<dt id="arg-test">test<a class="anchor" aria-label="anchor" href="#arg-test"></a></dt>
<dd><p>A character string specifying the test statistic to use. Currently
only <code>"Chisq"</code> (default) is supported, which performs likelihood ratio
tests. Can also be <code>"none"</code> for no tests.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>c("anova.gkwreg", "anova", "data.frame")</code>,
with the following columns:</p><dl><dt><code>Resid. Df</code></dt>
<dd><p>Residual degrees of freedom</p></dd>

<dt><code>Resid. Dev</code></dt>
<dd><p>Residual deviance (-2 × log-likelihood)</p></dd>

<dt><code>Df</code></dt>
<dd><p>Change in degrees of freedom (for model comparisons)</p></dd>

<dt><code>Deviance</code></dt>
<dd><p>Change in deviance (for model comparisons)</p></dd>

<dt><code>Pr(&gt;Chi)</code></dt>
<dd><p>P-value from the chi-squared test (if <code>test = "Chisq"</code>)</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>When a single model is provided, the function returns a table showing the
residual degrees of freedom and deviance.</p>
<p>When multiple models are provided, the function compares them using likelihood
ratio tests (LRT). Models are automatically ordered by their complexity
(degrees of freedom). The LRT statistic is computed as:
$$LRT = 2(\ell_1 - \ell_0)$$
where \(\ell_1\) is the log-likelihood of the more complex model and
\(\ell_0\) is the log-likelihood of the simpler (nested) model. Under the
null hypothesis that the simpler model is adequate, the LRT statistic follows
a chi-squared distribution with degrees of freedom equal to the difference in
the number of parameters between the models.</p>
<p><strong>Important</strong>: This method assumes that the models being compared are
nested (i.e., one model is a special case of the other) and fitted to the
same data. Comparing non-nested models or models fitted to different datasets
will produce unreliable results. Use <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code> or <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></code>
for comparing non-nested models.</p>
<p>The deviance is defined as \(-2 \times \text{log-likelihood}\). For models
fitted by maximum likelihood, smaller (more negative) deviances indicate
better fit. Note that deviance can be negative when the log-likelihood is
positive, which occurs when density values exceed 1 (common in continuous
distributions on bounded intervals). What matters for inference is the
<em>change</em> in deviance between models, which should be positive when
the more complex model fits better.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Wilks, S. S. (1938). The large-sample distribution of the likelihood ratio
for testing composite hypotheses. <em>The Annals of Mathematical Statistics</em>,
<strong>9</strong>(1), 60–62. <a href="https://doi.org/10.1214/aoms/1177732360" class="external-link">doi:10.1214/aoms/1177732360</a></p>
<p>Pawitan, Y. (2001). <em>In All Likelihood: Statistical Modelling and
Inference Using Likelihood</em>. Oxford University Press.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gkwreg.html">gkwreg</a></code>, <code><a href="logLik.gkwreg.html">logLik.gkwreg</a></code>, <code><a href="AIC.gkwreg.html">AIC.gkwreg</a></code>,
<code><a href="BIC.gkwreg.html">BIC.gkwreg</a></code>, <code><a href="lrtest.html">lrtest</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lopes, J. E.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># Load example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GasolineYield</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a series of nested models</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ANOVA table for single model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model: gkwreg(formula = yield ~ batch + temp, data = GasolineYield, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model:     family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Resid. Df Resid. Dev</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1  20.00000 -193.93865</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare nested models using likelihood ratio tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: yield ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: yield ~ temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 3: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Resid. Df Resid. Dev Df  Deviance Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1  30.00000  -57.02258                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2  29.00000  -80.90259  1  23.88001  &lt; 1e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit3  20.00000 -193.93865  9 113.03606  &lt; 1e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span><span class="co">#&gt; Model 1 vs 2: Adding temperature is highly significant (p &lt; 0.001)</span></span></span>
<span class="r-in"><span><span class="co">#&gt; Model 2 vs 3: Adding batch is highly significant (p &lt; 0.001)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare two models</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit2</span>, <span class="va">fit3</span>, test <span class="op">=</span> <span class="st">"Chisq"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: yield ~ temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Resid. Df Resid. Dev Df  Deviance Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2  29.00000  -80.90259                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit3  20.00000 -193.93865  9 113.03606  &lt; 1e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Suppress test statistics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span>, test <span class="op">=</span> <span class="st">"none"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: yield ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: yield ~ temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 3: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Resid. Df Resid. Dev Df  Deviance</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1  30.00000  -57.02258             </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2  29.00000  -80.90259  1  23.88001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit3  20.00000 -193.93865  9 113.03606</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by José Evandeilton Lopes.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

