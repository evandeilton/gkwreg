<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Intraocular Gas Decay in Retinal Surgery — retinal • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Intraocular Gas Decay in Retinal Surgery — retinal"><meta name="description" content="Longitudinal data on the recorded decay of intraocular gas (perfluoropropane)
in complex retinal surgeries. The dataset tracks the proportion of gas remaining
over time following vitrectomy procedures."><meta property="og:description" content="Longitudinal data on the recorded decay of intraocular gas (perfluoropropane)
in complex retinal surgeries. The dataset tracks the proportion of gas remaining
over time following vitrectomy procedures."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/gkwreg-vs-betareg.html">Beta Regression vs Kumaraswamy-Based Models for Bounded Data</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/gkwreg" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Intraocular Gas Decay in Retinal Surgery</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/gkwreg/blob/main/R/gkwreg-datasets.R" class="external-link"><code>R/gkwreg-datasets.R</code></a></small>
      <div class="d-none name"><code>retinal.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Longitudinal data on the recorded decay of intraocular gas (perfluoropropane)
in complex retinal surgeries. The dataset tracks the proportion of gas remaining
over time following vitrectomy procedures.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="va">retinal</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="format">Format<a class="anchor" aria-label="anchor" href="#format"></a></h2>
    <p>A data frame with 40 observations on 7 variables:</p><dl><dt>ID</dt>
<dd><p>integer. Patient identification number for longitudinal tracking.</p></dd>

<dt>Gas</dt>
<dd><p>numeric. Proportion of intraocular gas remaining (0-1 scale).
Response variable measuring the fraction of perfluoropropane gas still
present in the vitreous cavity.</p></dd>

<dt>Time</dt>
<dd><p>numeric. Time point of measurement (days or weeks post-surgery).</p></dd>

<dt>LogT</dt>
<dd><p>numeric. Logarithm of time, log(Time). Used to linearize the
exponential decay pattern.</p></dd>

<dt>LogT2</dt>
<dd><p>numeric. Squared logarithm of time, (log(Time))^2. Captures
nonlinear decay patterns.</p></dd>

<dt>Level</dt>
<dd><p>factor. Initial gas concentration level at the time of injection.
Different starting concentrations affect decay kinetics.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="source">Source<a class="anchor" aria-label="anchor" href="#source"></a></h2>
    <p>Based on clinical data from vitreoretinal surgery patients. Originally analyzed
in Song and Tan (2000).</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This longitudinal dataset comes from a study of gas decay following vitreoretinal
surgery. Perfluoropropane (C3F8) is commonly used as a temporary tamponade agent
in retinal detachment repair and other complex vitreoretinal procedures.</p>
<p><strong>Clinical background:</strong> During vitrectomy for retinal detachment, gas bubbles
are injected into the vitreous cavity to help reattach the retina by providing
internal tamponade. The gas gradually absorbs and dissipates over time. Understanding
the decay rate is important for:</p><ul><li><p>Predicting when patients can resume normal activities (esp. air travel)</p></li>
<li><p>Assessing treatment efficacy</p></li>
<li><p>Planning follow-up examinations</p></li>
</ul><p><strong>Decay kinetics:</strong> Gas decay typically follows a nonlinear pattern that can be
approximated by exponential or power-law functions. The log transformation
(LogT, LogT2) helps linearize these relationships for regression modeling.</p>
<p><strong>Data structure:</strong> This is a longitudinal/panel dataset with repeated measurements
on the same patients over time. Correlation structures (exchangeable, AR(1), etc.)
should be considered when modeling.</p>
<p>The proportional nature of the gas variable (bounded between 0 and 1) makes this
dataset ideal for:</p><ul><li><p>Simplex marginal models (original application by Song &amp; Tan 2000)</p></li>
<li><p>Beta regression with longitudinal correlation structures</p></li>
<li><p>Kumaraswamy regression with heteroscedastic errors</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Meyers, S.M., Ambler, J.S., Tan, M., Werner, J.C., and Huang, S.S. (1992).
Variation of Perfluoropropane Disappearance After Vitrectomy. <em>Retina</em>,
<strong>12</strong>, 359–363.</p>
<p>Song, P.X.-K., and Tan, M. (2000). Marginal Models for Longitudinal Continuous
Proportional Data. <em>Biometrics</em>, <strong>56</strong>, 496–502.
<a href="https://doi.org/10.1111/j.0006-341x.2000.00496.x" class="external-link">doi:10.1111/j.0006-341x.2000.00496.x</a></p>
<p>Song, P.X.-K., Qiu, Z., and Tan, M. (2004). Modelling Heterogeneous Dispersion
in Marginal Models for Longitudinal Proportional Data. <em>Biometrical Journal</em>,
<strong>46</strong>, 540–553.</p>
<p>Qiu, Z., Song, P.X.-K., and Tan, M. (2008). Simplex Mixed-Effects Models for
Longitudinal Proportional Data. <em>Scandinavian Journal of Statistics</em>,
<strong>35</strong>, 577–596.
<a href="https://doi.org/10.1111/j.1467-9469.2008.00603.x" class="external-link">doi:10.1111/j.1467-9469.2008.00603.x</a></p>
<p>Zhang, P., Qiu, Z., and Shi, C. (2016). simplexreg: An R Package for
Regression Analysis of Proportional Data Using the Simplex Distribution.
<em>Journal of Statistical Software</em>, <strong>71</strong>(11), 1–21.
<a href="https://doi.org/10.18637/jss.v071.i11" class="external-link">doi:10.18637/jss.v071.i11</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwreg" class="external-link">gkwreg</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwdist" class="external-link">gkwdist</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">retinal</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Nonlinear time decay with level effects</span></span></span>
<span class="r-in"><span><span class="co"># Model gas decay as quadratic function of log-time</span></span></span>
<span class="r-in"><span><span class="co"># Allow precision to vary by initial gas concentration</span></span></span>
<span class="r-in"><span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Gas</span> <span class="op">~</span> <span class="va">LogT</span> <span class="op">+</span> <span class="va">LogT2</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span></span></span>
<span class="r-in"><span>    <span class="va">Level</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">retinal</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_kw</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = Gas ~ LogT + LogT2 + Level | Level, data = retinal, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5665 -0.2076  0.0087 -0.0436  0.0971  0.4073 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.69138    0.22256   7.600 2.97e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT        -0.25598    0.25054  -1.022  0.30693    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2       -0.12019    0.06061  -1.983  0.04737 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level        0.51892    0.15828   3.279  0.00104 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  -0.40918    0.09481  -4.316 1.59e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level         0.08475    0.13199   0.642  0.52084    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.2552  2.1276</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT        -0.7470  0.2351</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2       -0.2390 -0.0014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level        0.2087  0.8291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  -0.5950 -0.2233</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level        -0.1740  0.3434</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 2.672</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 0.6776</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 181 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 175 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 103.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -195.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -176.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.2194 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.4994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.177 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interpretation:</span></span></span>
<span class="r-in"><span><span class="co"># - Alpha: Decay curve shape varies by initial gas concentration</span></span></span>
<span class="r-in"><span><span class="co">#   LogT + LogT2 capture nonlinear exponential-like decay</span></span></span>
<span class="r-in"><span><span class="co"># - Beta: Precision differs by concentration level</span></span></span>
<span class="r-in"><span><span class="co">#   Higher concentration may produce more/less variable decay</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Heteroscedastic model</span></span></span>
<span class="r-in"><span><span class="co"># Variability in gas proportion may change over time</span></span></span>
<span class="r-in"><span><span class="va">fit_kw_hetero</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Gas</span> <span class="op">~</span> <span class="va">LogT</span> <span class="op">+</span> <span class="va">LogT2</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span></span></span>
<span class="r-in"><span>    <span class="va">Level</span> <span class="op">+</span> <span class="va">LogT</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">retinal</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_kw_hetero</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = Gas ~ LogT + LogT2 + Level | Level + LogT, data = retinal, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5261 -0.1223  0.0192 -0.0081  0.1092  0.5323 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.90707    0.34706   2.614  0.00896 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT         0.40385    0.29920   1.350  0.17710    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2       -0.19493    0.05992  -3.253  0.00114 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level        0.41066    0.13956   2.943  0.00326 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  -1.25839    0.18008  -6.988 2.79e-12 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level         0.10830    0.13838   0.783  0.43384    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:LogT          0.51739    0.08071   6.410 1.45e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.2268  1.5873</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT        -0.1826  0.9903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2       -0.3124 -0.0775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level        0.1371  0.6842</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  -1.6113 -0.9054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level        -0.1629  0.3795</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:LogT          0.3592  0.6756</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 2.25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 1.06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 181 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 174 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 125.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -236.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -214.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.2059 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.5592 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.1566 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 29 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interpretation:</span></span></span>
<span class="r-in"><span><span class="co"># - Beta: Precision varies with both level and time</span></span></span>
<span class="r-in"><span><span class="co">#   Early measurements may be more variable than late measurements</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Test heteroscedasticity</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_kw_hetero</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: Gas ~ LogT + LogT2 + Level | Level</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: Gas ~ LogT + LogT2 + Level | Level + LogT</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw        175.00000 -207.36034                         </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw_hetero 174.00000 -250.75874  1 43.39840  &lt; 1e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3: Exponentiated Kumaraswamy for decay tails</span></span></span>
<span class="r-in"><span><span class="co"># Gas decay may show different tail behavior at extreme time points</span></span></span>
<span class="r-in"><span><span class="co"># (very fast initial decay or very slow residual decay)</span></span></span>
<span class="r-in"><span><span class="va">fit_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Gas</span> <span class="op">~</span> <span class="va">LogT</span> <span class="op">+</span> <span class="va">LogT2</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span> <span class="co"># alpha: decay curve</span></span></span>
<span class="r-in"><span>    <span class="va">Level</span> <span class="op">+</span> <span class="va">LogT</span> <span class="op">|</span> <span class="co"># beta: heteroscedasticity</span></span></span>
<span class="r-in"><span>    <span class="va">Level</span>, <span class="co"># lambda: tail heaviness by level</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">retinal</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"ekw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_ekw</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: ekw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = Gas ~ LogT + LogT2 + Level | Level + LogT | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Level, data = retinal, family = "ekw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.4958 -0.0799  0.0651  0.0446  0.1693  0.5107 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)   1.36711    1.11962   1.221  0.22207    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT          0.27552    0.32922   0.837  0.40267    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2        -0.16545    0.05963  -2.775  0.00553 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level        -0.38899    0.39384  -0.988  0.32330    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   -1.36470    0.34796  -3.922 8.78e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level          0.25158    0.19003   1.324  0.18555    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:LogT           0.54369    0.12922   4.207 2.58e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -0.32755    0.76219  -0.430  0.66738    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:Level        0.92335    0.39316   2.349  0.01885 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  -0.8273  3.5615</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT         -0.3698  0.9208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2        -0.2823 -0.0486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level        -1.1609  0.3829</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   -2.0467 -0.6827</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level         -0.1209  0.6240</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:LogT           0.2904  0.7970</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -1.8214  1.1663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:Level        0.1528  1.6939</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 2.771</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 1.082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1.08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 181 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 172 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 129.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -240.3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -211.5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.209 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.5458 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.1644 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 37 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Interpretation:</span></span></span>
<span class="r-in"><span><span class="co"># - Lambda varies by level: Different initial concentrations may have</span></span></span>
<span class="r-in"><span><span class="co">#   different rates of extreme decay (very fast or very slow residual gas)</span></span></span>
<span class="r-in"><span><span class="co"># - Important for predicting complete absorption time</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4: McDonald distribution for asymmetric decay</span></span></span>
<span class="r-in"><span><span class="co"># Alternative parameterization for skewed decay patterns</span></span></span>
<span class="r-in"><span><span class="va">fit_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">Gas</span> <span class="op">~</span> <span class="va">LogT</span> <span class="op">+</span> <span class="va">LogT2</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span> <span class="co"># gamma</span></span></span>
<span class="r-in"><span>    <span class="va">LogT</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span> <span class="co"># delta</span></span></span>
<span class="r-in"><span>    <span class="va">Level</span>, <span class="co"># lambda</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">retinal</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"mc"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"BFGS"</span>,</span></span>
<span class="r-in"><span>    maxit <span class="op">=</span> <span class="fl">1500</span>,</span></span>
<span class="r-in"><span>    reltol <span class="op">=</span> <span class="fl">1e-8</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_mc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: mc </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = Gas ~ LogT + LogT2 + Level | LogT + Level | </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Level, data = retinal, family = "mc", control = gkw_control(method = "BFGS", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     maxit = 1500, reltol = 1e-08))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5652 -0.1159  0.0034 -0.0098  0.1214  0.5185 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:(Intercept)   0.99232    1.85227   0.536    0.592    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:LogT          1.11127    0.23830   4.663 3.11e-06 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:LogT2        -0.44693    0.05657  -7.900 2.79e-15 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:Level         0.28447    1.38833   0.205    0.838    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:(Intercept)  -6.27067    0.70158  -8.938  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:LogT          0.17905        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:Level        -0.38972        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept)  0.29057    1.83059   0.159    0.874    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:Level       -0.07583    1.42998  -0.053    0.958    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:(Intercept)  -2.6381  4.6227</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:LogT          0.6442  1.5783</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:LogT2        -0.5578 -0.3360</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:Level        -2.4366  3.0055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:(Intercept)  -7.6458 -4.8956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:LogT             NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:Level            NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -3.2973  3.8785</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:Level       -2.8785  2.7269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: logit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 2.848</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0.0269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1.317</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 181 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 172 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 66.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -115 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -86.18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.2145 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.5216 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.1631 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 26 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model comparison</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_kw_hetero</span>, <span class="va">fit_ekw</span>, <span class="va">fit_mc</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               df       AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw         6 -195.3603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw_hetero  7 -236.7587</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_ekw        9 -240.3186</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_mc         9 -114.9668</span>
<span class="r-in"><span><span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

