
R version 4.5.2 (2025-10-31) -- "[Not] Part in a Rumble"
Copyright (C) 2025 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> pkgname <- "gkwreg"
> source(file.path(R.home("share"), "R", "examples-header.R"))
> options(warn = 1)
> base::assign(".ExTimings", "gkwreg-Ex.timings", pos = 'CheckExEnv')
> base::cat("name\tuser\tsystem\telapsed\n", file=base::get(".ExTimings", pos = 'CheckExEnv'))
> base::assign(".format_ptime",
+ function(x) {
+   if(!is.na(x[4L])) x[1L] <- x[1L] + x[4L]
+   if(!is.na(x[5L])) x[2L] <- x[2L] + x[5L]
+   options(OutDec = '.')
+   format(x[1L:3L], digits = 7L)
+ },
+ pos = 'CheckExEnv')
> 
> ### * </HEADER>
> library('gkwreg')
> 
> base::assign(".oldSearch", base::search(), pos = 'CheckExEnv')
> base::assign(".old_wd", base::getwd(), pos = 'CheckExEnv')
> cleanEx()
> nameEx("AIC.gkwreg")
> ### * AIC.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: AIC.gkwreg
> ### Title: Akaike Information Criterion for GKw Regression Models
> ### Aliases: AIC.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> # Load example data
> data(GasolineYield)
> 
> # Fit competing models
> fit1 <- gkwreg(yield ~ batch, data = GasolineYield, family = "kw")
Note: Using Makevars in /home/jlopes/.R/Makevars 
using C++ compiler: ‘g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
g++ -std=gnu++17 -I"/usr/share/R/include" -DNDEBUG -I"/home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/TMB/include" -I"/tmp/RtmpLzES3v/RLIBS_1c7c11e7227ce/RcppEigen/include"   -DTMB_EIGEN_DISABLE_WARNINGS   -DTMB_LIB_INIT=R_init_kwreg  -DCPPAD_FRAMEWORK      -fpic  -g -O2 -Wall -pedantic -mtune=native  -c kwreg.cpp -o kwreg.o
g++ -std=gnu++17 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -Wl,-z,relro -o kwreg.so kwreg.o -L/usr/lib/R/lib -lR
> fit2 <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> fit3 <- gkwreg(yield ~ temp, data = GasolineYield, family = "kw")
> 
> # Calculate AIC for single model
> AIC(fit1)
[1] -42.93436
> 
> # Compare multiple models (with proper names)
> AIC(fit1, fit2, fit3)
     df        AIC
fit1 11  -42.93436
fit2 12 -169.93865
fit3  3  -74.90259
> 
> # Use different penalty
> AIC(fit1, k = 4)
[1] -20.93436
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("AIC.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("BIC.gkwreg")
> ### * BIC.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: BIC.gkwreg
> ### Title: Bayesian Information Criterion for GKw Regression Models
> ### Aliases: BIC.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> # Load example data
> data(GasolineYield)
> 
> # Fit competing models
> fit1 <- gkwreg(yield ~ batch, data = GasolineYield, family = "kw")
> fit2 <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> fit3 <- gkwreg(yield ~ temp, data = GasolineYield, family = "kw")
> 
> # Calculate BIC for single model
> BIC(fit1)
[1] -26.81126
> 
> # Compare multiple models (with proper names)
> BIC(fit1, fit2, fit3)
     df        BIC
fit1 11  -26.81126
fit2 12 -152.34982
fit3  3  -70.50538
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("BIC.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("CarTask")
> ### * CarTask
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: CarTask
> ### Title: Partition-Primed Probability Judgement Task for Car Dealership
> ### Aliases: CarTask
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(CarTask)
> 
> # Example 1: Task effects on probability judgments
> # Do people judge probabilities differently for car vs. salesperson?
> fit_kw <- gkwreg(
+   probability ~ task,
+   data = CarTask,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = probability ~ task, data = CarTask, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3274 -0.1604 -0.0233 -0.0182  0.0726  0.6057 

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)      0.59548    0.09165   6.498 8.16e-11 ***
alpha:taskSalesperson -0.11015    0.10146  -1.086    0.278    
beta:(Intercept)       1.09659    0.12178   9.004  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                           3%    98%
alpha:(Intercept)      0.4159 0.7751
alpha:taskSalesperson -0.3090 0.0887
beta:(Intercept)       0.8579 1.3353

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1.72
beta: 2.991
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 155 
Number of parameters: 3 
Residual degrees of freedom: 152 
Log-likelihood: 34.76 
AIC: -63.52 
BIC: -54.39 
RMSE: 0.1812 
Efron's R2: -0.002858 
Mean Absolute Error: 0.1485 

Convergence status: Successful 
Iterations: 14 

> 
> # Interpretation:
> # - Alpha: Task type affects mean probability estimate
> #   Salesperson condition (1/4 = 0.25) vs. car type (unclear baseline)
> 
> # Example 2: Individual differences model
> # Need for Closure/Certainty may moderate probability judgments
> fit_kw_nfcc <- gkwreg(
+   probability ~ task * NFCCscale |
+     task,
+   data = CarTask,
+   family = "kw"
+ )
> summary(fit_kw_nfcc)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = probability ~ task * NFCCscale | task, data = CarTask, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3059 -0.1553 -0.0094 -0.0183  0.0915  0.5954 

Coefficients:
                                Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)                 0.0106     0.4239   0.025   0.9801    
alpha:taskSalesperson             0.4263     0.7016   0.608   0.5434    
alpha:NFCCscale                   0.2272     0.1232   1.845   0.0651 .  
alpha:taskSalesperson:NFCCscale  -0.2456     0.2011  -1.221   0.2220    
beta:(Intercept)                  1.4714     0.1864   7.892 2.97e-15 ***
beta:taskSalesperson             -0.6039     0.2487  -2.428   0.0152 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                                     3%     98%
alpha:(Intercept)               -0.8202  0.8414
alpha:taskSalesperson           -0.9489  1.8015
alpha:NFCCscale                 -0.0142  0.4687
alpha:taskSalesperson:NFCCscale -0.6397  0.1486
beta:(Intercept)                 1.1060  1.8368
beta:taskSalesperson            -1.0915 -0.1164

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1.815
beta: 3.373
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 155 
Number of parameters: 6 
Residual degrees of freedom: 149 
Log-likelihood: 38.98 
AIC: -65.96 
BIC: -47.7 
RMSE: 0.1795 
Efron's R2: 0.01639 
Mean Absolute Error: 0.1467 

Convergence status: Successful 
Iterations: 21 

> 
> # Interpretation:
> # - Interaction: NFCC may have different effects depending on task
> #   People high in need for certainty may respond differently to
> #   explicit partitions (4 salespersons) vs. implicit partitions (car types)
> # - Beta: Precision varies by task type
> 
> # Example 3: Exponentiated Kumaraswamy for extreme estimates
> # Some participants may give very extreme probability estimates
> fit_ekw <- gkwreg(
+   probability ~ task * NFCCscale | # alpha
+     task | # beta
+     task, # lambda: extremity differs by task
+   data = CarTask,
+   family = "ekw"
+ )
Note: Using Makevars in /home/jlopes/.R/Makevars 
using C++ compiler: ‘g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
g++ -std=gnu++17 -I"/usr/share/R/include" -DNDEBUG -I"/home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/TMB/include" -I"/tmp/RtmpLzES3v/RLIBS_1c7c11e7227ce/RcppEigen/include"   -DTMB_EIGEN_DISABLE_WARNINGS   -DTMB_LIB_INIT=R_init_ekwreg  -DCPPAD_FRAMEWORK      -fpic  -g -O2 -Wall -pedantic -mtune=native  -c ekwreg.cpp -o ekwreg.o
g++ -std=gnu++17 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -Wl,-z,relro -o ekwreg.so ekwreg.o -L/usr/lib/R/lib -lR
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = probability ~ task * NFCCscale | task | task, 
    data = CarTask, family = "ekw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2927  0.1036  0.1499  0.1947  0.3299  0.9989 

Coefficients:
                                 Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)               -14.59427    0.36201 -40.315  < 2e-16 ***
alpha:taskSalesperson           -11.81563    0.53713 -21.998  < 2e-16 ***
alpha:NFCCscale                   0.22010    0.08734   2.520   0.0117 *  
alpha:taskSalesperson:NFCCscale  -0.31692    0.16846  -1.881   0.0599 .  
beta:(Intercept)                  0.85723    0.02072  41.381  < 2e-16 ***
beta:taskSalesperson             -0.12052    0.02288  -5.267 1.39e-07 ***
lambda:(Intercept)               32.63595        NaN     NaN      NaN    
lambda:taskSalesperson           23.05168        NaN     NaN      NaN    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                                      3%      98%
alpha:(Intercept)               -15.3038 -13.8848
alpha:taskSalesperson           -12.8684 -10.7629
alpha:NFCCscale                   0.0489   0.3913
alpha:taskSalesperson:NFCCscale  -0.6471   0.0133
beta:(Intercept)                  0.8166   0.8978
beta:taskSalesperson             -0.1654  -0.0757
lambda:(Intercept)                   NaN      NaN
lambda:taskSalesperson               NaN      NaN

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 4.848e-07
beta: 2.224
gamma: 1
delta: 0
lambda: 7.595e+23

Model fit statistics:
Number of observations: 155 
Number of parameters: 8 
Residual degrees of freedom: 147 
Log-likelihood: 149.7 
AIC: -283.4 
BIC: -259 
RMSE: 0.3211 
Efron's R2: -2.148 
Mean Absolute Error: 0.2569 

Convergence status: Failed 
Iterations: 57 

> 
> # Interpretation:
> # - Lambda varies by task: Salesperson condition (explicit partition)
> #   may produce more extreme estimates (closer to 0 or 1)
> 
> # Visualization: Probability by task and NFCC
> plot(probability ~ NFCCscale,
+   data = CarTask,
+   col = c("blue", "red")[task], pch = 19,
+   xlab = "Need for Closure/Certainty", ylab = "Probability Estimate",
+   main = "Car Task: Individual Differences in Probability Judgment"
+ )
> legend("topright",
+   legend = levels(CarTask$task),
+   col = c("blue", "red"), pch = 19
+ )
> 
> # Distribution comparison
> boxplot(probability ~ task,
+   data = CarTask,
+   xlab = "Task Condition", ylab = "Probability Estimate",
+   main = "Partition Priming Effects",
+   col = c("lightblue", "lightcoral")
+ )
> abline(h = 0.25, lty = 2, col = "gray")
> text(1.5, 0.27, "Uniform (1/4)", col = "gray")
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("CarTask", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("FoodExpenditure")
> ### * FoodExpenditure
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: FoodExpenditure
> ### Title: Proportion of Household Income Spent on Food
> ### Aliases: FoodExpenditure
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(FoodExpenditure)
> FoodExpenditure$prop <- FoodExpenditure$food / FoodExpenditure$income
> 
> # Example 1: Basic Kumaraswamy regression
> # Proportion spent on food decreases with income (Engel's law)
> # Larger households spend more on food
> fit_kw <- gkwreg(prop ~ income + persons,
+   data = FoodExpenditure,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = prop ~ income + persons, data = FoodExpenditure, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1636 -0.0376  0.0095 -0.0022  0.0480  0.1458 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  1.622786   0.177013   9.168  < 2e-16 ***
alpha:income      -0.007130   0.001623  -4.393 1.12e-05 ***
alpha:persons      0.083647   0.019204   4.356 1.33e-05 ***
beta:(Intercept)   5.162036   0.658351   7.841 4.47e-15 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  1.2758  1.9697
alpha:income      -0.0103 -0.0039
alpha:persons      0.0460  0.1213
beta:(Intercept)   3.8717  6.4524

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 4.598
beta: 174.3
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 38 
Number of parameters: 4 
Residual degrees of freedom: 34 
Log-likelihood: 45.77 
AIC: -83.54 
BIC: -76.99 
RMSE: 0.07455 
Efron's R2: 0.4446 
Mean Absolute Error: 0.05842 

Convergence status: Successful 
Iterations: 17 

> 
> # Interpretation:
> # - Alpha: Negative income effect (Engel's law)
> #   Positive household size effect
> # - Beta: Constant precision (homoscedastic model)
> 
> # Example 2: Heteroscedastic model
> # Variability in food proportion may differ by income and household size
> fit_kw_hetero <- gkwreg(
+   prop ~ income + persons |
+     income + persons,
+   data = FoodExpenditure,
+   family = "kw"
+ )
> summary(fit_kw_hetero)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = prop ~ income + persons | income + persons, 
    data = FoodExpenditure, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1736 -0.0356  0.0125  0.0002  0.0382  0.1546 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  1.891196   0.326327   5.795 6.82e-09 ***
alpha:income       0.001421   0.004482   0.317 0.751221    
alpha:persons     -0.090024   0.045650  -1.972 0.048604 *  
beta:(Intercept)   7.500712   2.073678   3.617 0.000298 ***
beta:income        0.042825   0.030398   1.409 0.158900    
beta:persons      -1.017206   0.291303  -3.492 0.000480 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  1.2516  2.5308
alpha:income      -0.0074  0.0102
alpha:persons     -0.1795 -0.0006
beta:(Intercept)   3.4364 11.5650
beta:income       -0.0168  0.1024
beta:persons      -1.5882 -0.4463

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 5.28
beta: 2782
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 38 
Number of parameters: 6 
Residual degrees of freedom: 32 
Log-likelihood: 51.68 
AIC: -91.36 
BIC: -81.54 
RMSE: 0.06989 
Efron's R2: 0.5118 
Mean Absolute Error: 0.05405 

Convergence status: Successful 
Iterations: 31 

> 
> # Interpretation:
> # - Beta: Precision varies with both income and household size
> #   Wealthier or larger households may show different spending variability
> 
> # Test for heteroscedasticity
> anova(fit_kw, fit_kw_hetero)
Analysis of Deviance Table

Model 1: prop ~ income + persons
Model 2: prop ~ income + persons | income + persons

              Resid. Df Resid. Dev Df Deviance  Pr(>Chi)   
fit_kw         34.00000  -91.53671                         
fit_kw_hetero  32.00000 -103.36364  2 11.82693 0.0027028 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: Exponentiated Kumaraswamy for extreme spending patterns
> # Some households may have unusual food spending (very frugal or lavish)
> fit_ekw <- gkwreg(
+   prop ~ income + persons | # alpha
+     persons | # beta: household size affects precision
+     income, # lambda: income affects extremity
+   data = FoodExpenditure,
+   family = "ekw"
+ )
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = prop ~ income + persons | persons | income, 
    data = FoodExpenditure, family = "ekw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1932 -0.0295  0.0234  0.0037  0.0396  0.1747 

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)   2.188747   0.450856   4.855 1.21e-06 ***
alpha:income       -0.003871   0.001919  -2.018  0.04362 *  
alpha:persons      -0.109282   0.051203  -2.134  0.03282 *  
beta:(Intercept)    9.826068   3.736876   2.629  0.00855 ** 
beta:persons       -1.105766   0.502560  -2.200  0.02779 *  
lambda:(Intercept)  0.682952   1.182022   0.578  0.56341    
lambda:income      -0.010845   0.013268  -0.817  0.41369    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                        3%     98%
alpha:(Intercept)   1.3051  3.0724
alpha:income       -0.0076 -0.0001
alpha:persons      -0.2096 -0.0089
beta:(Intercept)    2.5019 17.1502
beta:persons       -2.0908 -0.1208
lambda:(Intercept) -1.6338  2.9997
lambda:income      -0.0368  0.0152

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 4.906
beta: 1260
gamma: 1
delta: 0
lambda: 1.018

Model fit statistics:
Number of observations: 38 
Number of parameters: 7 
Residual degrees of freedom: 31 
Log-likelihood: 50.31 
AIC: -86.63 
BIC: -75.17 
RMSE: 0.07347 
Efron's R2: 0.4605 
Mean Absolute Error: 0.05648 

Convergence status: Successful 
Iterations: 63 

> 
> # Interpretation:
> # - Lambda: Income level affects tail behavior
> #   Rich households may show more extreme (unusual) spending patterns
> 
> # Visualization: Engel curve
> plot(prop ~ income,
+   data = FoodExpenditure,
+   xlab = "Annual Income ($)", ylab = "Proportion Spent on Food",
+   main = "Engel Curve for Food Expenditure"
+ )
> # Add fitted values
> FoodExpenditure$fitted_kw <- fitted(fit_kw)
> points(FoodExpenditure$income, FoodExpenditure$fitted_kw,
+   col = "blue", pch = 19, cex = 0.8
+ )
> legend("topright",
+   legend = c("Observed", "Fitted"),
+   col = c("black", "blue"), pch = c(1, 19)
+ )
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("FoodExpenditure", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("GasolineYield")
> ### * GasolineYield
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: GasolineYield
> ### Title: Gasoline Yield from Crude Oil
> ### Aliases: GasolineYield
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(GasolineYield)
> 
> # Example 1: Kumaraswamy regression with batch effects
> # Model mean yield as function of batch and temperature
> # Allow precision to vary with temperature (heteroscedasticity)
> fit_kw <- gkwreg(yield ~ batch + temp | temp,
+   data = GasolineYield,
+   family = "kw"
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = yield ~ batch + temp | temp, data = GasolineYield, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.4914 -0.0175 -0.0034 -0.0249  0.0065  0.0745 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  0.319842   0.026078  12.265  < 2e-16 ***
alpha:batch1       0.826719   0.028879  28.627  < 2e-16 ***
alpha:batch2       0.582466   0.030836  18.889  < 2e-16 ***
alpha:batch3       0.710004   0.028636  24.794  < 2e-16 ***
alpha:batch4       0.461921   0.025812  17.895  < 2e-16 ***
alpha:batch5       0.520953   0.026011  20.028  < 2e-16 ***
alpha:batch6       0.447006   0.026950  16.586  < 2e-16 ***
alpha:batch7       0.222963   0.024710   9.023  < 2e-16 ***
alpha:batch8       0.200138   0.024892   8.040 8.96e-16 ***
alpha:batch9       0.138999   0.029271   4.749 2.05e-06 ***
alpha:temp         0.006445        NaN     NaN      NaN    
beta:(Intercept)  18.458156   1.405043  13.137  < 2e-16 ***
beta:temp          0.034533   0.002942  11.737  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  0.2687  0.3710
alpha:batch1       0.7701  0.8833
alpha:batch2       0.5220  0.6429
alpha:batch3       0.6539  0.7661
alpha:batch4       0.4113  0.5125
alpha:batch5       0.4700  0.5719
alpha:batch6       0.3942  0.4998
alpha:batch7       0.1745  0.2714
alpha:batch8       0.1514  0.2489
alpha:batch9       0.0816  0.1964
alpha:temp            NaN     NaN
beta:(Intercept)  15.7043 21.2120
beta:temp          0.0288  0.0403

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 19.51
beta: 4.025e+13
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 13 
Residual degrees of freedom: 19 
Log-likelihood: 96.81 
AIC: -167.6 
BIC: -148.6 
RMSE: 0.09951 
Efron's R2: 0.111 
Mean Absolute Error: 0.04167 

Convergence status: Failed 
Iterations: 93 

> 
> # Interpretation:
> # - Alpha (mean): Different batches have different baseline yields
> #   Temperature affects yield transformation
> # - Beta (precision): Higher temperatures may produce more variable yields
> 
> # Example 2: Full model with all physical-chemical properties
> fit_kw_full <- gkwreg(
+   yield ~ gravity + pressure + temp10 + temp |
+     temp10 + temp,
+   data = GasolineYield,
+   family = "kw"
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_kw_full)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = yield ~ gravity + pressure + temp10 + temp | 
    temp10 + temp, data = GasolineYield, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.0516 -0.0169 -0.0034 -0.0053  0.0033  0.0444 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  0.457548   0.166036   2.756  0.00586 ** 
alpha:gravity      0.001539   0.003912   0.393  0.69400    
alpha:pressure     0.024644   0.012936   1.905  0.05676 .  
alpha:temp10      -0.001364        NaN     NaN      NaN    
alpha:temp         0.005833        NaN     NaN      NaN    
beta:(Intercept)  -1.766735   3.731464  -0.473  0.63588    
beta:temp10        0.059930   0.013139   4.561 5.08e-06 ***
beta:temp          0.008332   0.001735   4.802 1.57e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%    98%
alpha:(Intercept)  0.1321 0.7830
alpha:gravity     -0.0061 0.0092
alpha:pressure    -0.0007 0.0500
alpha:temp10          NaN    NaN
alpha:temp            NaN    NaN
beta:(Intercept)  -9.0803 5.5468
beta:temp10        0.0342 0.0857
beta:temp          0.0049 0.0117

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 9.935
beta: 59340318
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 8 
Residual degrees of freedom: 24 
Log-likelihood: 80.45 
AIC: -144.9 
BIC: -133.2 
RMSE: 0.02081 
Efron's R2: 0.9611 
Mean Absolute Error: 0.01542 

Convergence status: Successful 
Iterations: 70 

> 
> # Interpretation:
> # - Mean model captures effects of crude oil properties
> # - Precision varies with vaporization temperatures
> 
> # Example 3: Exponentiated Kumaraswamy for extreme yields
> # Some batches may produce unusually high/low yields
> fit_ekw <- gkwreg(
+   yield ~ batch + temp | # alpha: batch effects
+     temp | # beta: temperature precision
+     batch, # lambda: batch-specific tail behavior
+   data = GasolineYield,
+   family = "ekw"
+ )
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = yield ~ batch + temp | temp | batch, data = GasolineYield, 
    family = "ekw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.0356 -0.0133 -0.0020  0.0048  0.0082  0.2229 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)  -0.36374        NaN     NaN      NaN
alpha:batch1        0.52791        NaN     NaN      NaN
alpha:batch2        0.49225        NaN     NaN      NaN
alpha:batch3        0.67943        NaN     NaN      NaN
alpha:batch4        0.31973        NaN     NaN      NaN
alpha:batch5        0.50498        NaN     NaN      NaN
alpha:batch6        0.30367        NaN     NaN      NaN
alpha:batch7        0.16380        NaN     NaN      NaN
alpha:batch8        0.19265        NaN     NaN      NaN
alpha:batch9        0.09724        NaN     NaN      NaN
alpha:temp          0.00610        NaN     NaN      NaN
beta:(Intercept)    9.81853        NaN     NaN      NaN
beta:temp           0.01178        NaN     NaN      NaN
lambda:(Intercept) -0.14664        NaN     NaN      NaN
lambda:batch1      36.09593        NaN     NaN      NaN
lambda:batch2       3.21155        NaN     NaN      NaN
lambda:batch3       1.08510        NaN     NaN      NaN
lambda:batch4       7.26510        NaN     NaN      NaN
lambda:batch5       0.63205        NaN     NaN      NaN
lambda:batch6       7.47889        NaN     NaN      NaN
lambda:batch7       2.23889        NaN     NaN      NaN
lambda:batch8       0.72835        NaN     NaN      NaN
lambda:batch9       1.47656        NaN     NaN      NaN

Confidence intervals (95%):
                    3% 98%
alpha:(Intercept)  NaN NaN
alpha:batch1       NaN NaN
alpha:batch2       NaN NaN
alpha:batch3       NaN NaN
alpha:batch4       NaN NaN
alpha:batch5       NaN NaN
alpha:batch6       NaN NaN
alpha:batch7       NaN NaN
alpha:batch8       NaN NaN
alpha:batch9       NaN NaN
alpha:temp         NaN NaN
beta:(Intercept)   NaN NaN
beta:temp          NaN NaN
lambda:(Intercept) NaN NaN
lambda:batch1      NaN NaN
lambda:batch2      NaN NaN
lambda:batch3      NaN NaN
lambda:batch4      NaN NaN
lambda:batch5      NaN NaN
lambda:batch6      NaN NaN
lambda:batch7      NaN NaN
lambda:batch8      NaN NaN
lambda:batch9      NaN NaN

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 7.912
beta: 1225127
gamma: 1
delta: 0
lambda: 5.123e+14

Model fit statistics:
Number of observations: 32 
Number of parameters: 23 
Residual degrees of freedom: 9 
Log-likelihood: 114.3 
AIC: -182.5 
BIC: -148.8 
RMSE: 0.04235 
Efron's R2: 0.839 
Mean Absolute Error: 0.01908 

Convergence status: Failed 
Iterations: 99 

> 
> # Interpretation:
> # - Lambda varies by batch: Some crude oils have more extreme
> #   yield distributions (heavy tails for very high/low yields)
> 
> # Model comparison: Does tail flexibility improve fit?
> anova(fit_kw, fit_ekw)
Analysis of Deviance Table

Model 1: yield ~ batch + temp | temp
Model 2: yield ~ batch + temp | temp | batch

        Resid. Df Resid. Dev Df Deviance   Pr(>Chi)    
fit_kw   19.00000 -193.61594                           
fit_ekw   9.00000 -228.53221 10 34.91627 0.00012904 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Diagnostic plots
> par(mfrow = c(2, 2))
> plot(fit_kw, which = c(1, 2, 4, 5))
Simulating envelope ( 100 iterations): .......... Done!
> par(mfrow = c(1, 1))
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("GasolineYield", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("ImpreciseTask")
> ### * ImpreciseTask
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: ImpreciseTask
> ### Title: Imprecise Probabilities for Sunday Weather and Boeing Stock Task
> ### Aliases: ImpreciseTask
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(ImpreciseTask)
> 
> # Example 1: Basic model with task effects
> # Probability location varies by task type and uncertainty level
> fit_kw <- gkwreg(location ~ task * difference,
+   data = ImpreciseTask,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = location ~ task * difference, data = ImpreciseTask, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3556 -0.0788  0.0274  0.0019  0.0944  0.3499 

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)                    1.25134    0.11593  10.794   <2e-16 ***
alpha:taskSunday weather            -0.09543    0.11108  -0.859   0.3903    
alpha:difference                     0.28623    0.21709   1.318   0.1874    
alpha:taskSunday weather:difference  0.43791    0.25964   1.687   0.0917 .  
beta:(Intercept)                     2.74022    0.15340  17.864   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                                         3%    98%
alpha:(Intercept)                    1.0241 1.4786
alpha:taskSunday weather            -0.3131 0.1223
alpha:difference                    -0.1393 0.7117
alpha:taskSunday weather:difference -0.0710 0.9468
beta:(Intercept)                     2.4396 3.0409

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 3.805
beta: 15.47
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 242 
Number of parameters: 5 
Residual degrees of freedom: 237 
Log-likelihood: 162.2 
AIC: -314.3 
BIC: -296.9 
RMSE: 0.1198 
Efron's R2: 0.101 
Mean Absolute Error: 0.0981 

Convergence status: Successful 
Iterations: 21 

> 
> # Interpretation:
> # - Alpha: Task type and uncertainty (difference) interact to affect
> #   probability estimates
> # - Different tasks may have different baseline probability assessments
> 
> # Example 2: Heteroscedastic model
> # Precision of estimates may vary by task and uncertainty
> fit_kw_hetero <- gkwreg(
+   location ~ task * difference |
+     task + difference,
+   data = ImpreciseTask,
+   family = "kw"
+ )
> summary(fit_kw_hetero)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = location ~ task * difference | task + difference, 
    data = ImpreciseTask, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3607 -0.0787  0.0333  0.0010  0.0907  0.3574 

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)                     1.7403     0.1329  13.092  < 2e-16 ***
alpha:taskSunday weather             -0.4913     0.1365  -3.598 0.000320 ***
alpha:difference                     -0.1068     0.2145  -0.498 0.618539    
alpha:taskSunday weather:difference   0.3001     0.2410   1.245 0.213134    
beta:(Intercept)                      4.4688     0.4707   9.493  < 2e-16 ***
beta:taskSunday weather              -1.4832     0.4354  -3.407 0.000658 ***
beta:difference                      -1.3788     0.5970  -2.309 0.020925 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                                         3%     98%
alpha:(Intercept)                    1.4798  2.0009
alpha:taskSunday weather            -0.7589 -0.2237
alpha:difference                    -0.5272  0.3136
alpha:taskSunday weather:difference -0.1723  0.7725
beta:(Intercept)                     3.5462  5.3914
beta:taskSunday weather             -2.3366 -0.6298
beta:difference                     -2.5489 -0.2086

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 4.164
beta: 25.37
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 242 
Number of parameters: 7 
Residual degrees of freedom: 235 
Log-likelihood: 170.6 
AIC: -327.3 
BIC: -302.9 
RMSE: 0.1197 
Efron's R2: 0.102 
Mean Absolute Error: 0.09725 

Convergence status: Successful 
Iterations: 26 

> 
> # Interpretation:
> # - Beta: Variability in estimates differs between tasks
> #   Higher uncertainty (difference) may lead to less precise estimates
> 
> # Example 3: McDonald distribution for extreme uncertainty
> # Some participants may show very extreme probability assessments
> fit_mc <- gkwreg(
+   location ~ task * difference | # gamma: full interaction
+     task * difference | # delta: full interaction
+     task, # lambda: task affects extremity
+   data = ImpreciseTask,
+   family = "mc",
+   control = gkw_control(
+     method = "BFGS",
+     maxit = 1500
+   )
+ )
Note: Using Makevars in /home/jlopes/.R/Makevars 
using C++ compiler: ‘g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
g++ -std=gnu++17 -I"/usr/share/R/include" -DNDEBUG -I"/home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/TMB/include" -I"/tmp/RtmpLzES3v/RLIBS_1c7c11e7227ce/RcppEigen/include"   -DTMB_EIGEN_DISABLE_WARNINGS   -DTMB_LIB_INIT=R_init_mcreg  -DCPPAD_FRAMEWORK      -fpic  -g -O2 -Wall -pedantic -mtune=native  -c mcreg.cpp -o mcreg.o
g++ -std=gnu++17 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -Wl,-z,relro -o mcreg.so mcreg.o -L/usr/lib/R/lib -lR
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_mc)

Generalized Kumaraswamy Regression Model Summary

Family: mc 

Call:
gkwreg(formula = location ~ task * difference | task * difference | 
    task, data = ImpreciseTask, family = "mc", control = gkw_control(method = "BFGS", 
    maxit = 1500))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2631  0.1058  0.2147  0.1669  0.2255  0.6379 

Coefficients:
                                    Estimate Std. Error z value Pr(>|z|)
gamma:(Intercept)                    0.12000        NaN     NaN      NaN
gamma:taskSunday weather             0.08321    0.37727   0.221    0.825
gamma:difference                     0.03513        NaN     NaN      NaN
gamma:taskSunday weather:difference  0.01876        NaN     NaN      NaN
delta:(Intercept)                   -0.08309        NaN     NaN      NaN
delta:taskSunday weather            -0.05747    0.58059  -0.099    0.921
delta:difference                    -0.02637        NaN     NaN      NaN
delta:taskSunday weather:difference -0.01482    1.06142  -0.014    0.989
lambda:(Intercept)                   0.25123        NaN     NaN      NaN
lambda:taskSunday weather            0.17376        NaN     NaN      NaN

Confidence intervals (95%):
                                         3%    98%
gamma:(Intercept)                       NaN    NaN
gamma:taskSunday weather            -0.6562 0.8226
gamma:difference                        NaN    NaN
gamma:taskSunday weather:difference     NaN    NaN
delta:(Intercept)                       NaN    NaN
delta:taskSunday weather            -1.1954 1.0805
delta:difference                        NaN    NaN
delta:taskSunday weather:difference -2.0952 2.0655
lambda:(Intercept)                      NaN    NaN
lambda:taskSunday weather               NaN    NaN

Link functions:
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 1
beta: 1
gamma: 1.212
delta: 4.668
lambda: 1.457

Model fit statistics:
Number of observations: 242 
Number of parameters: 10 
Residual degrees of freedom: 232 
Log-likelihood: 20.49 
AIC: -20.97 
BIC: 13.92 
RMSE: 0.2123 
Efron's R2: -1.824 
Mean Absolute Error: 0.1885 

Convergence status: Successful 
Iterations: 7 

> 
> # Interpretation:
> # - Lambda varies by task: Weather vs. stock may produce
> #   different patterns of extreme probability assessments
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("ImpreciseTask", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("LossAversion")
> ### * LossAversion
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: LossAversion
> ### Title: (No) Myopic Loss Aversion in Adolescents
> ### Aliases: LossAversion
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(LossAversion)
> # Control bounds
> 
> LossAversion$invest <- with(
+   LossAversion,
+   ifelse(invest <= 0, 0.000001,
+     ifelse(invest >= 1, 0.999999, invest)
+   )
+ )
> # Example 1: Test for myopic loss aversion
> # Do short-term players invest less? (They shouldn't, per Sutter et al.)
> fit_kw <- gkwreg(
+   invest ~ arrangement + age + male + grade |
+     arrangement + male,
+   data = LossAversion,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = invest ~ arrangement + age + male + grade | 
    arrangement + male, data = LossAversion, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.5002 -0.2002  0.0000  0.0037  0.1999  0.5000 

Coefficients:
                        Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)     -2.841e-10  4.735e-01       0        1
alpha:arrangementteam  2.126e-10  1.836e-01       0        1
alpha:age             -4.949e-09  3.771e-02       0        1
alpha:maleyes          1.889e-11  1.210e-01       0        1
alpha:grade10-12      -4.135e-10  1.732e-01       0        1
beta:(Intercept)       4.573e-10  9.653e-02       0        1
beta:arrangementteam  -3.177e-11  1.694e-01       0        1
beta:maleyes          -1.490e-11  1.394e-01       0        1

Confidence intervals (95%):
                           3%    98%
alpha:(Intercept)     -0.9281 0.9281
alpha:arrangementteam -0.3598 0.3598
alpha:age             -0.0739 0.0739
alpha:maleyes         -0.2372 0.2372
alpha:grade10-12      -0.3396 0.3396
beta:(Intercept)      -0.1892 0.1892
beta:arrangementteam  -0.3320 0.3320
beta:maleyes          -0.2733 0.2733

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1
beta: 0.9996
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 570 
Number of parameters: 8 
Residual degrees of freedom: 562 
Log-likelihood: -3e+11 
AIC: 6e+11 
BIC: 6e+11 
RMSE: 0.2678 
Efron's R2: 7.819e-05 
Mean Absolute Error: 0.2217 

Convergence status: Failed 
Iterations: 2 

> 
> # Interpretation:
> # - Alpha: Effect of investment horizon (arrangement) on mean investment
> #   Age and gender effects on risk-taking
> # - Beta: Precision varies by horizon and gender
> #   (some groups more consistent than others)
> 
> # Example 2: Interaction effects
> # Does the horizon effect differ by age/grade?
> fit_kw_interact <- gkwreg(
+   invest ~ grade * (arrangement + age) + male |
+     arrangement + male + grade,
+   data = LossAversion,
+   family = "kw"
+ )
> summary(fit_kw_interact)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = invest ~ grade * (arrangement + age) + male | 
    arrangement + male + grade, data = LossAversion, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.5002 -0.2002  0.0000  0.0037  0.2000  0.5000 

Coefficients:
                                   Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)                -1.698e-10  6.753e-01       0        1
alpha:grade10-12                 -2.471e-10  1.120e+00       0        1
alpha:arrangementteam             1.270e-10  2.113e-01       0        1
alpha:age                        -2.958e-09  5.342e-02       0        1
alpha:maleyes                     1.129e-11  1.224e-01       0        1
alpha:grade10-12:arrangementteam  3.069e-11  2.261e-01       0        1
alpha:grade10-12:age             -4.007e-09  7.630e-02       0        1
beta:(Intercept)                  2.733e-10  1.126e-01       0        1
beta:arrangementteam             -1.898e-11  1.720e-01       0        1
beta:maleyes                     -8.903e-12  1.398e-01       0        1
beta:grade10-12                   1.314e-10  1.440e-01       0        1

Confidence intervals (95%):
                                      3%    98%
alpha:(Intercept)                -1.3237 1.3237
alpha:grade10-12                 -2.1959 2.1959
alpha:arrangementteam            -0.4142 0.4142
alpha:age                        -0.1047 0.1047
alpha:maleyes                    -0.2398 0.2398
alpha:grade10-12:arrangementteam -0.4431 0.4431
alpha:grade10-12:age             -0.1495 0.1495
beta:(Intercept)                 -0.2208 0.2208
beta:arrangementteam             -0.3371 0.3371
beta:maleyes                     -0.2740 0.2740
beta:grade10-12                  -0.2823 0.2823

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1
beta: 0.9996
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 570 
Number of parameters: 11 
Residual degrees of freedom: 559 
Log-likelihood: -3e+11 
AIC: 6e+11 
BIC: 6e+11 
RMSE: 0.2679 
Efron's R2: -0.0001649 
Mean Absolute Error: 0.2218 

Convergence status: Failed 
Iterations: 2 

> 
> # Interpretation:
> # - Grade × arrangement interaction tests if myopic loss aversion
> #   emerges differently at different developmental stages
> 
> # Example 3: Extended-support for boundary observations
> # Some students invest 0% or 100% of tokens
> # Original 'invest' variable may include exact 0 and 1 values
> fit_xbx <- gkwreg(
+   invest ~ grade * (arrangement + age) + male |
+     arrangement + male + grade,
+   data = LossAversion,
+   family = "kw" # Note: for true [0,1] support, use extended-support models
+ )
> summary(fit_xbx)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = invest ~ grade * (arrangement + age) + male | 
    arrangement + male + grade, data = LossAversion, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.5002 -0.2002  0.0000  0.0037  0.2000  0.5000 

Coefficients:
                                   Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)                -1.698e-10  6.753e-01       0        1
alpha:grade10-12                 -2.471e-10  1.120e+00       0        1
alpha:arrangementteam             1.270e-10  2.113e-01       0        1
alpha:age                        -2.958e-09  5.342e-02       0        1
alpha:maleyes                     1.129e-11  1.224e-01       0        1
alpha:grade10-12:arrangementteam  3.069e-11  2.261e-01       0        1
alpha:grade10-12:age             -4.007e-09  7.630e-02       0        1
beta:(Intercept)                  2.733e-10  1.126e-01       0        1
beta:arrangementteam             -1.898e-11  1.720e-01       0        1
beta:maleyes                     -8.903e-12  1.398e-01       0        1
beta:grade10-12                   1.314e-10  1.440e-01       0        1

Confidence intervals (95%):
                                      3%    98%
alpha:(Intercept)                -1.3237 1.3237
alpha:grade10-12                 -2.1959 2.1959
alpha:arrangementteam            -0.4142 0.4142
alpha:age                        -0.1047 0.1047
alpha:maleyes                    -0.2398 0.2398
alpha:grade10-12:arrangementteam -0.4431 0.4431
alpha:grade10-12:age             -0.1495 0.1495
beta:(Intercept)                 -0.2208 0.2208
beta:arrangementteam             -0.3371 0.3371
beta:maleyes                     -0.2740 0.2740
beta:grade10-12                  -0.2823 0.2823

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1
beta: 0.9996
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 570 
Number of parameters: 11 
Residual degrees of freedom: 559 
Log-likelihood: -3e+11 
AIC: 6e+11 
BIC: 6e+11 
RMSE: 0.2679 
Efron's R2: -0.0001649 
Mean Absolute Error: 0.2218 

Convergence status: Failed 
Iterations: 2 

> 
> # Interpretation:
> # - Model accommodates extreme risk-taking (all-in or all-out strategies)
> 
> # Compare models
> anova(fit_kw, fit_kw_interact)
Analysis of Deviance Table

Model 1: invest ~ arrangement + age + male + grade | arrangement + male
Model 2: invest ~ grade * (arrangement + age) + male | arrangement + male + 
Model 2:     grade

                Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
fit_kw          562.00000      6e+11                       
fit_kw_interact 559.00000      6e+11  3  0.00000        1  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Visualization: Investment by horizon
> boxplot(invest ~ arrangement,
+   data = LossAversion,
+   xlab = "Investment Horizon", ylab = "Proportion Invested",
+   main = "No Myopic Loss Aversion in Adolescents",
+   col = c("lightblue", "lightgreen", "lightyellow")
+ )
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("LossAversion", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("MockJurors")
> ### * MockJurors
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: MockJurors
> ### Title: Confidence of Mock Jurors in Their Verdicts
> ### Aliases: MockJurors
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(MockJurors)
> 
> # Example 1: Main effects model with heteroscedasticity
> # Confidence depends on verdict options and conflicting evidence
> # Variability may also depend on these factors
> fit_kw <- gkwreg(
+   confidence ~ verdict + conflict |
+     verdict * conflict,
+   data = MockJurors,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = confidence ~ verdict + conflict | verdict * 
    conflict, data = MockJurors, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.6484 -0.1143  0.0515  0.0152  0.1827  0.3416 

Coefficients:
                      Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)      0.70572    0.13722   5.143 2.71e-07 ***
alpha:verdict         -0.31540    0.15835  -1.992  0.04640 *  
alpha:conflict         0.21806    0.15492   1.408  0.15925    
beta:(Intercept)      -0.14787    0.12674  -1.167  0.24332    
beta:verdict          -0.35402    0.13337  -2.654  0.00794 ** 
beta:conflict          0.10940    0.13351   0.819  0.41258    
beta:verdict:conflict -0.12932    0.09992  -1.294  0.19558    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                           3%     98%
alpha:(Intercept)      0.4368  0.9747
alpha:verdict         -0.6258 -0.0050
alpha:conflict        -0.0856  0.5217
beta:(Intercept)      -0.3963  0.1005
beta:verdict          -0.6154 -0.0926
beta:conflict         -0.1523  0.3711
beta:verdict:conflict -0.3252  0.0665

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 2.184
beta: 0.9347
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 104 
Number of parameters: 7 
Residual degrees of freedom: 97 
Log-likelihood: 35.56 
AIC: -57.12 
BIC: -38.61 
RMSE: 0.2084 
Efron's R2: 0.0305 
Mean Absolute Error: 0.1657 

Convergence status: Successful 
Iterations: 18 

> 
> # Interpretation:
> # - Alpha (mean): Additive effects of verdict type and conflict
> #   Three-option verdicts may reduce confidence
> #   Conflicting evidence reduces confidence
> # - Beta (precision): Interaction suggests confidence variability
> #   depends on combination of verdict options and evidence type
> 
> # Example 2: Full interaction in mean model
> fit_kw_interact <- gkwreg(
+   confidence ~ verdict * conflict |
+     verdict * conflict,
+   data = MockJurors,
+   family = "kw"
+ )
> summary(fit_kw_interact)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = confidence ~ verdict * conflict | verdict * 
    conflict, data = MockJurors, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.6078 -0.1026  0.0131  0.0076  0.1653  0.3822 

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)       0.78602    0.13396   5.867 4.43e-09 ***
alpha:verdict          -0.31171    0.13396  -2.327  0.01997 *  
alpha:conflict          0.30523    0.13396   2.278  0.02270 *  
alpha:verdict:conflict  0.41032    0.13396   3.063  0.00219 ** 
beta:(Intercept)       -0.09854    0.12599  -0.782  0.43415    
beta:verdict           -0.34600    0.12599  -2.746  0.00603 ** 
beta:conflict           0.11003    0.12599   0.873  0.38250    
beta:verdict:conflict   0.10701    0.12599   0.849  0.39569    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                            3%     98%
alpha:(Intercept)       0.5235  1.0486
alpha:verdict          -0.5743 -0.0491
alpha:conflict          0.0427  0.5678
alpha:verdict:conflict  0.1478  0.6729
beta:(Intercept)       -0.3455  0.1484
beta:verdict           -0.5929 -0.0991
beta:conflict          -0.1369  0.3570
beta:verdict:conflict  -0.1399  0.3539

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 2.549
beta: 0.9711
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 104 
Number of parameters: 8 
Residual degrees of freedom: 96 
Log-likelihood: 40.12 
AIC: -64.24 
BIC: -43.09 
RMSE: 0.2078 
Efron's R2: 0.03573 
Mean Absolute Error: 0.1631 

Convergence status: Successful 
Iterations: 18 

> 
> # Interpretation:
> # - Full interaction: Third verdict option may have different effects
> #   depending on whether evidence is conflicting
> 
> # Test interaction significance
> anova(fit_kw, fit_kw_interact)
Analysis of Deviance Table

Model 1: confidence ~ verdict + conflict | verdict * conflict
Model 2: confidence ~ verdict * conflict | verdict * conflict

                Resid. Df Resid. Dev Df Deviance  Pr(>Chi)   
fit_kw           97.00000  -71.12225                         
fit_kw_interact  96.00000  -80.24264  1  9.12039 0.0025278 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: McDonald distribution for extreme confidence patterns
> # Jurors may show very high confidence (ceiling effects) or very low
> # confidence depending on conditions
> fit_mc <- gkwreg(
+   confidence ~ verdict * conflict | # gamma: full interaction
+     verdict * conflict | # delta: full interaction
+     verdict + conflict, # lambda: additive extremity effects
+   data = MockJurors,
+   family = "mc",
+   control = gkw_control(
+     method = "BFGS",
+     maxit = 1500,
+     reltol = 1e-8
+   )
+ )
> summary(fit_mc)

Generalized Kumaraswamy Regression Model Summary

Family: mc 

Call:
gkwreg(formula = confidence ~ verdict * conflict | verdict * 
    conflict | verdict + conflict, data = MockJurors, family = "mc", 
    control = gkw_control(method = "BFGS", maxit = 1500, reltol = 1e-08))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.4395 -0.0471  0.0520  0.1064  0.2500  0.7032 

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
gamma:(Intercept)        3.2186     5.7452   0.560   0.5753    
gamma:verdict            2.0199     5.5102   0.367   0.7139    
gamma:conflict          -0.7418     0.6489  -1.143   0.2530    
gamma:verdict:conflict   0.9145     0.1266   7.224 5.04e-13 ***
delta:(Intercept)       -3.6223     0.3943  -9.186  < 2e-16 ***
delta:verdict           -0.8930     0.3948  -2.262   0.0237 *  
delta:conflict           0.2426     0.3944   0.615   0.5386    
delta:verdict:conflict   0.7301     0.3960   1.843   0.0653 .  
lambda:(Intercept)      -2.2131     5.7326  -0.386   0.6995    
lambda:verdict          -2.3000     5.5063  -0.418   0.6762    
lambda:conflict          1.0677     0.6352   1.681   0.0928 .  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                             3%     98%
gamma:(Intercept)       -8.0418 14.4790
gamma:verdict           -8.7798 12.8196
gamma:conflict          -2.0136  0.5300
gamma:verdict:conflict   0.6664  1.1627
delta:(Intercept)       -4.3952 -2.8494
delta:verdict           -1.6667 -0.1193
delta:conflict          -0.5305  1.0156
delta:verdict:conflict  -0.0461  1.5063
lambda:(Intercept)     -13.4488  9.0225
lambda:verdict         -13.0922  8.4921
lambda:conflict         -0.1773  2.3127

Link functions:
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 1
beta: 1
gamma: 100.7
delta: 0.4194
lambda: 0.8955

Model fit statistics:
Number of observations: 104 
Number of parameters: 11 
Residual degrees of freedom: 93 
Log-likelihood: 19.98 
AIC: -17.96 
BIC: 11.13 
RMSE: 0.2857 
Efron's R2: -0.8222 
Mean Absolute Error: 0.2204 

Convergence status: Successful 
Iterations: 38 

> 
> # Interpretation:
> # - Lambda: Models asymmetry and extreme confidence
> #   Some conditions produce more polarized confidence (very high or very low)
> 
> # Example 4: Exponentiated Kumaraswamy alternative
> fit_ekw <- gkwreg(
+   confidence ~ verdict * conflict | # alpha
+     verdict + conflict | # beta
+     conflict, # lambda: conflict affects extremity
+   data = MockJurors,
+   family = "ekw",
+   control = gkw_control(
+     method = "BFGS",
+     maxit = 1500
+   )
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = confidence ~ verdict * conflict | verdict + 
    conflict | conflict, data = MockJurors, family = "ekw", control = gkw_control(method = "BFGS", 
    maxit = 1500))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.7253 -0.2066 -0.0576 -0.0722  0.0744  0.2647 

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)       0.45685        NaN     NaN      NaN
alpha:verdict          -0.05041    0.12348  -0.408    0.683
alpha:conflict          0.09766        NaN     NaN      NaN
alpha:verdict:conflict  0.13324    0.10132   1.315    0.189
beta:(Intercept)       -0.64393        NaN     NaN      NaN
beta:verdict           -0.17246    0.12703  -1.358    0.175
beta:conflict          -0.07422        NaN     NaN      NaN
lambda:(Intercept)      0.45685        NaN     NaN      NaN
lambda:conflict         0.09766        NaN     NaN      NaN

Confidence intervals (95%):
                            3%    98%
alpha:(Intercept)          NaN    NaN
alpha:verdict          -0.2924 0.1916
alpha:conflict             NaN    NaN
alpha:verdict:conflict -0.0654 0.3318
beta:(Intercept)           NaN    NaN
beta:verdict           -0.4214 0.0765
beta:conflict              NaN    NaN
lambda:(Intercept)         NaN    NaN
lambda:conflict            NaN    NaN

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 1.608
beta: 0.5339
gamma: 1
delta: 0
lambda: 1.589

Model fit statistics:
Number of observations: 104 
Number of parameters: 9 
Residual degrees of freedom: 95 
Log-likelihood: 9.75 
AIC: -1.499 
BIC: 22.3 
RMSE: 0.2213 
Efron's R2: -0.09353 
Mean Absolute Error: 0.1677 

Convergence status: Successful 
Iterations: 5 

> 
> # Compare 3-parameter models
> AIC(fit_ekw, fit_mc)
        df        AIC
fit_ekw  9  -1.499307
fit_mc  11 -17.957086
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("MockJurors", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("ReadingSkills")
> ### * ReadingSkills
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: ReadingSkills
> ### Title: Dyslexia and IQ Predicting Reading Accuracy
> ### Aliases: ReadingSkills
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(ReadingSkills)
> 
> # Example 1: Standard Kumaraswamy with interaction and heteroscedasticity
> # Mean: Dyslexia × IQ interaction (do groups differ in IQ effect?)
> # Precision: Main effects (variability differs by group and IQ level)
> fit_kw <- gkwreg(
+   accuracy ~ dyslexia * iq |
+     dyslexia + iq,
+   data = ReadingSkills,
+   family = "kw",
+   control = gkw_control(method = "L-BFGS-B", maxit = 2000)
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = accuracy ~ dyslexia * iq | dyslexia + iq, data = ReadingSkills, 
    family = "kw", control = gkw_control(method = "L-BFGS-B", 
        maxit = 2000))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2641 -0.0305  0.0093  0.0159  0.0601  0.2986 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)   1.7158     0.2387   7.187 6.61e-13 ***
alpha:dyslexia      0.8632     0.2522   3.422 0.000621 ***
alpha:iq            1.2727     0.2244   5.671 1.42e-08 ***
alpha:dyslexia:iq  -1.1788     0.1920  -6.139 8.29e-10 ***
beta:(Intercept)    2.8774     0.5252   5.479 4.29e-08 ***
beta:dyslexia       3.5541     0.5621   6.323 2.56e-10 ***
beta:iq             1.0895     0.3788   2.876 0.004029 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  1.2479  2.1837
alpha:dyslexia     0.3689  1.3576
alpha:iq           0.8329  1.7125
alpha:dyslexia:iq -1.5551 -0.8024
beta:(Intercept)   1.8480  3.9068
beta:dyslexia      2.4525  4.6558
beta:iq            0.3470  1.8320

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 26.55
beta: 204.8
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 44 
Number of parameters: 7 
Residual degrees of freedom: 37 
Log-likelihood: 68.45 
AIC: -122.9 
BIC: -110.4 
RMSE: 0.1094 
Efron's R2: 0.6179 
Mean Absolute Error: 0.0753 

Convergence status: Successful 
Iterations: 82 

> 
> # Interpretation:
> # - Alpha (mean): Interaction shows dyslexic children benefit less from
> #   higher IQ compared to controls
> # - Beta (precision): Controls show more variable accuracy (higher precision)
> #   IQ increases consistency of performance
> 
> # Example 2: Simpler model without interaction
> fit_kw_simple <- gkwreg(
+   accuracy ~ dyslexia + iq |
+     dyslexia + iq,
+   data = ReadingSkills,
+   family = "kw",
+   control = gkw_control(method = "L-BFGS-B", maxit = 2000)
+ )
> 
> # Test if interaction is significant
> anova(fit_kw_simple, fit_kw)
Analysis of Deviance Table

Model 1: accuracy ~ dyslexia + iq | dyslexia + iq
Model 2: accuracy ~ dyslexia * iq | dyslexia + iq

              Resid. Df Resid. Dev Df Deviance   Pr(>Chi)    
fit_kw_simple  38.00000 -124.28762                           
fit_kw         37.00000 -136.89181  1 12.60419 0.00038488 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: Exponentiated Kumaraswamy for ceiling effects
> # Reading accuracy often shows ceiling effects (many perfect/near-perfect scores)
> # Lambda parameter can model this right-skewed asymmetry
> fit_ekw <- gkwreg(
+   accuracy ~ dyslexia * iq | # alpha
+     dyslexia + iq | # beta
+     dyslexia, # lambda: ceiling effect by group
+   data = ReadingSkills,
+   family = "ekw",
+   control = gkw_control(method = "L-BFGS-B", maxit = 2000)
+ )
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = accuracy ~ dyslexia * iq | dyslexia + iq | dyslexia, 
    data = ReadingSkills, family = "ekw", control = gkw_control(method = "L-BFGS-B", 
        maxit = 2000))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2447 -0.0243  0.0120  0.0152  0.0686  0.2096 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)  
alpha:(Intercept)   -1.9487     4.6708  -0.417   0.6765  
alpha:dyslexia       5.3238     5.0741   1.049   0.2941  
alpha:iq             2.3183     1.0622   2.182   0.0291 *
alpha:dyslexia:iq   -2.3858     1.1040  -2.161   0.0307 *
beta:(Intercept)     6.0559    16.7532   0.361   0.7177  
beta:dyslexia        6.3640    16.7322   0.380   0.7037  
beta:iq              0.5124     0.2990   1.714   0.0866 .
lambda:(Intercept)   2.6537     4.0631   0.653   0.5137  
lambda:dyslexia     -3.9242     4.5629  -0.860   0.3898  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                         3%     98%
alpha:(Intercept)  -11.1033  7.2059
alpha:dyslexia      -4.6212 15.2689
alpha:iq             0.2364  4.4003
alpha:dyslexia:iq   -4.5496 -0.2219
beta:(Intercept)   -26.7797 38.8915
beta:dyslexia      -26.4305 39.1585
beta:iq             -0.0736  1.0984
lambda:(Intercept)  -5.3098 10.6172
lambda:dyslexia    -12.8673  5.0188

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 13.48
beta: 84001
gamma: 1
delta: 0
lambda: 409.1

Model fit statistics:
Number of observations: 44 
Number of parameters: 9 
Residual degrees of freedom: 35 
Log-likelihood: 70.62 
AIC: -123.2 
BIC: -107.2 
RMSE: 0.09653 
Efron's R2: 0.7024 
Mean Absolute Error: 0.07239 

Convergence status: Failed 
Iterations: 118 

> 
> # Interpretation:
> # - Lambda varies by dyslexia status: Controls have stronger ceiling effect
> #   (more compression at high accuracy) than dyslexic children
> 
> # Test if ceiling effect modeling improves fit
> anova(fit_kw, fit_ekw)
Analysis of Deviance Table

Model 1: accuracy ~ dyslexia * iq | dyslexia + iq
Model 2: accuracy ~ dyslexia * iq | dyslexia + iq | dyslexia

        Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
fit_kw   37.00000 -136.89181                       
fit_ekw  35.00000 -141.23391  2  4.34210  0.11406  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 4: McDonald distribution alternative
> # Provides different parameterization for extreme values
> fit_mc <- gkwreg(
+   accuracy ~ dyslexia * iq | # gamma
+     dyslexia + iq | # delta
+     dyslexia * iq, # lambda: interaction affects tails
+   data = ReadingSkills,
+   family = "mc",
+   control = gkw_control(method = "L-BFGS-B", maxit = 2000)
+ )
> summary(fit_mc)

Generalized Kumaraswamy Regression Model Summary

Family: mc 

Call:
gkwreg(formula = accuracy ~ dyslexia * iq | dyslexia + iq | dyslexia * 
    iq, data = ReadingSkills, family = "mc", control = gkw_control(method = "L-BFGS-B", 
    maxit = 2000))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1259  0.0350  0.7058  0.5210  0.9899  0.9899 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)
gamma:(Intercept)    7.8675        NaN     NaN      NaN
gamma:dyslexia       9.1494        NaN     NaN      NaN
gamma:iq             0.9036        NaN     NaN      NaN
gamma:dyslexia:iq   -2.9325        NaN     NaN      NaN
delta:(Intercept)  -23.0435        NaN     NaN      NaN
delta:dyslexia      63.6331        NaN     NaN      NaN
delta:iq            -1.2728        NaN     NaN      NaN
lambda:(Intercept)  -5.4452        NaN     NaN      NaN
lambda:dyslexia     -8.5214        NaN     NaN      NaN
lambda:iq           -0.3551        NaN     NaN      NaN
lambda:dyslexia:iq   2.3403        NaN     NaN      NaN

Confidence intervals (95%):
                    3% 98%
gamma:(Intercept)  NaN NaN
gamma:dyslexia     NaN NaN
gamma:iq           NaN NaN
gamma:dyslexia:iq  NaN NaN
delta:(Intercept)  NaN NaN
delta:dyslexia     NaN NaN
delta:iq           NaN NaN
lambda:(Intercept) NaN NaN
lambda:dyslexia    NaN NaN
lambda:iq          NaN NaN
lambda:dyslexia:iq NaN NaN

Link functions:
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 1
beta: 1
gamma: 104076816
delta: 4.318
lambda: 19.5

Model fit statistics:
Number of observations: 44 
Number of parameters: 11 
Residual degrees of freedom: 33 
Log-likelihood: 60.78 
AIC: -99.55 
BIC: -79.93 
RMSE: 0.6856 
Efron's R2: -14.01 
Mean Absolute Error: 0.5337 

Convergence status: Failed 
Iterations: 142 

> 
> # Compare 3-parameter models
> AIC(fit_ekw, fit_mc)
        df        AIC
fit_ekw  9 -123.23391
fit_mc  11  -99.55191
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("ReadingSkills", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("StressAnxiety")
> ### * StressAnxiety
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: StressAnxiety
> ### Title: Dependency of Anxiety on Stress
> ### Aliases: StressAnxiety
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(StressAnxiety)
> 
> # Example 1: Basic heteroscedastic relationship
> # Mean anxiety increases with stress
> # Variability in anxiety also changes with stress
> fit_kw <- gkwreg(
+   anxiety ~ stress |
+     stress,
+   data = StressAnxiety,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = anxiety ~ stress | stress, data = StressAnxiety, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2943 -0.0394 -0.0152  0.0012  0.0231  0.2738 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept) -0.15576    0.09639  -1.616    0.106    
alpha:stress       0.53167    0.33774   1.574    0.115    
beta:(Intercept)   3.67043    0.30158  12.171  < 2e-16 ***
beta:stress       -3.96207    0.81439  -4.865 1.14e-06 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept) -0.3447  0.0332
alpha:stress      -0.1303  1.1936
beta:(Intercept)   3.0793  4.2615
beta:stress       -5.5582 -2.3659

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 0.9902
beta: 17.4
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 166 
Number of parameters: 4 
Residual degrees of freedom: 162 
Log-likelihood: 305.5 
AIC: -602.9 
BIC: -590.5 
RMSE: 0.08686 
Efron's R2: 0.5677 
Mean Absolute Error: 0.05871 

Convergence status: Successful 
Iterations: 16 

> 
> # Interpretation:
> # - Alpha: Positive relationship between stress and mean anxiety
> # - Beta: Precision changes with stress level
> #   (anxiety becomes more/less variable at different stress levels)
> 
> # Compare to homoscedastic model
> fit_kw_homo <- gkwreg(anxiety ~ stress,
+   data = StressAnxiety, family = "kw"
+ )
> anova(fit_kw_homo, fit_kw)
Analysis of Deviance Table

Model 1: anxiety ~ stress
Model 2: anxiety ~ stress | stress

            Resid. Df Resid. Dev Df Deviance Pr(>Chi)    
fit_kw_homo 163.00000 -588.89928                         
fit_kw      162.00000 -610.94842  1 22.04913  < 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 2: Nonlinear stress effects via polynomial
> # Stress-anxiety relationship often shows threshold or saturation effects
> fit_kw_poly <- gkwreg(
+   anxiety ~ poly(stress, 2) | # quadratic mean
+     poly(stress, 2), # quadratic precision
+   data = StressAnxiety,
+   family = "kw"
+ )
> summary(fit_kw_poly)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = anxiety ~ poly(stress, 2) | poly(stress, 2), 
    data = StressAnxiety, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3104 -0.0498 -0.0116 -0.0028  0.0228  0.2447 

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)       0.01689    0.06512   0.259 0.795292    
alpha:poly(stress, 2)1  2.43589    1.01831   2.392 0.016752 *  
alpha:poly(stress, 2)2  2.86240    1.04517   2.739 0.006168 ** 
beta:(Intercept)        2.72015    0.17477  15.565  < 2e-16 ***
beta:poly(stress, 2)1  -9.58460    2.55838  -3.746 0.000179 ***
beta:poly(stress, 2)2   7.09996    2.66543   2.664 0.007728 ** 
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                             3%     98%
alpha:(Intercept)       -0.1107  0.1445
alpha:poly(stress, 2)1   0.4400  4.4317
alpha:poly(stress, 2)2   0.8139  4.9109
beta:(Intercept)         2.3776  3.0627
beta:poly(stress, 2)1  -14.5989 -4.5703
beta:poly(stress, 2)2    1.8758 12.3241

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1.082
beta: 24.18
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 166 
Number of parameters: 6 
Residual degrees of freedom: 160 
Log-likelihood: 309.9 
AIC: -607.9 
BIC: -589.2 
RMSE: 0.08802 
Efron's R2: 0.5561 
Mean Absolute Error: 0.06071 

Convergence status: Successful 
Iterations: 20 

> 
> # Interpretation:
> # - Quadratic terms allow for:
> #   * Threshold effects (anxiety accelerates at high stress)
> #   * Saturation effects (anxiety plateaus at extreme stress)
> 
> # Test nonlinearity
> anova(fit_kw, fit_kw_poly)
Analysis of Deviance Table

Model 1: anxiety ~ stress | stress
Model 2: anxiety ~ poly(stress, 2) | poly(stress, 2)

            Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
fit_kw      162.00000 -610.94842                       
fit_kw_poly 160.00000 -619.88378  2  8.93537 0.011474 *
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: Exponentiated Kumaraswamy for extreme anxiety patterns
> # Some individuals may show very extreme anxiety responses to stress
> fit_ekw <- gkwreg(
+   anxiety ~ poly(stress, 2) | # alpha: quadratic mean
+     poly(stress, 2) | # beta: quadratic precision
+     stress, # lambda: linear tail effect
+   data = StressAnxiety,
+   family = "ekw"
+ )
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = anxiety ~ poly(stress, 2) | poly(stress, 2) | 
    stress, data = StressAnxiety, family = "ekw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1974 -0.0324 -0.0052  0.0110  0.0310  0.2990 

Coefficients:
                       Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)       -1.9135     0.5103  -3.750 0.000177 ***
alpha:poly(stress, 2)1   5.4724     1.7206   3.180 0.001470 ** 
alpha:poly(stress, 2)2   8.3272     1.2083   6.892 5.51e-12 ***
beta:(Intercept)         1.6775     0.1531  10.954  < 2e-16 ***
beta:poly(stress, 2)1   -5.0750     0.9539  -5.320 1.04e-07 ***
beta:poly(stress, 2)2    5.2634     1.5502   3.395 0.000685 ***
lambda:(Intercept)       7.7664     2.1310   3.644 0.000268 ***
lambda:stress          -10.2013     2.7870  -3.660 0.000252 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                             3%     98%
alpha:(Intercept)       -2.9136 -0.9133
alpha:poly(stress, 2)1   2.1000  8.8448
alpha:poly(stress, 2)2   5.9591 10.6954
beta:(Intercept)         1.3774  1.9777
beta:poly(stress, 2)1   -6.9447 -3.2053
beta:poly(stress, 2)2    2.2251  8.3016
lambda:(Intercept)       3.5897 11.9430
lambda:stress          -15.6637 -4.7389

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 0.3187
beta: 6.38
gamma: 1
delta: 0
lambda: 510.3

Model fit statistics:
Number of observations: 166 
Number of parameters: 8 
Residual degrees of freedom: 158 
Log-likelihood: 337.9 
AIC: -659.9 
BIC: -635 
RMSE: 0.08709 
Efron's R2: 0.5654 
Mean Absolute Error: 0.05688 

Convergence status: Successful 
Iterations: 37 

> 
> # Interpretation:
> # - Lambda: Linear component captures asymmetry at extreme stress levels
> #   (very high stress may produce different tail behavior)
> 
> # Example 4: McDonald distribution for highly skewed anxiety
> # Anxiety distributions are often right-skewed (ceiling effects)
> fit_mc <- gkwreg(
+   anxiety ~ poly(stress, 2) | # gamma
+     poly(stress, 2) | # delta
+     stress, # lambda: extremity
+   data = StressAnxiety,
+   family = "mc",
+   control = gkw_control(method = "BFGS", maxit = 1500)
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_mc)

Generalized Kumaraswamy Regression Model Summary

Family: mc 

Call:
gkwreg(formula = anxiety ~ poly(stress, 2) | poly(stress, 2) | 
    stress, data = StressAnxiety, family = "mc", control = gkw_control(method = "BFGS", 
    maxit = 1500))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.0499 -0.0499 -0.0297  0.0315  0.0701  0.6311 

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
gamma:(Intercept)      -0.2351921  0.2665143  -0.882    0.378    
gamma:poly(stress, 2)1  0.0190891        NaN     NaN      NaN    
gamma:poly(stress, 2)2 -0.0009618  0.7054250  -0.001    0.999    
delta:(Intercept)       0.0375628  0.1891093   0.199    0.843    
delta:poly(stress, 2)1 -0.0066401  1.6486664  -0.004    0.997    
delta:poly(stress, 2)2 -0.0032370        NaN     NaN      NaN    
lambda:(Intercept)     -0.3680521  0.0287293 -12.811   <2e-16 ***
lambda:stress          -0.0152252        NaN     NaN      NaN    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                            3%     98%
gamma:(Intercept)      -0.7576  0.2872
gamma:poly(stress, 2)1     NaN     NaN
gamma:poly(stress, 2)2 -1.3836  1.3816
delta:(Intercept)      -0.3331  0.4082
delta:poly(stress, 2)1 -3.2380  3.2247
delta:poly(stress, 2)2     NaN     NaN
lambda:(Intercept)     -0.4244 -0.3117
lambda:stress              NaN     NaN

Link functions:
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 1
beta: 1
gamma: 0.7904
delta: 5.094
lambda: 0.6891

Model fit statistics:
Number of observations: 166 
Number of parameters: 8 
Residual degrees of freedom: 158 
Log-likelihood: 227.8 
AIC: -439.5 
BIC: -414.6 
RMSE: 0.136 
Efron's R2: -0.05914 
Mean Absolute Error: 0.08386 

Convergence status: Successful 
Iterations: 6 

> 
> # Compare models
> AIC(fit_kw, fit_kw_poly, fit_ekw, fit_mc)
            df       AIC
fit_kw       4 -602.9484
fit_kw_poly  6 -607.8838
fit_ekw      8 -659.8696
fit_mc       8 -439.5397
> 
> # Visualization: Stress-Anxiety relationship
> plot(anxiety ~ stress,
+   data = StressAnxiety,
+   xlab = "Stress Level", ylab = "Anxiety Level",
+   main = "Stress-Anxiety Relationship with Heteroscedasticity",
+   pch = 19, col = rgb(0, 0, 1, 0.3)
+ )
> 
> # Add fitted curve
> stress_seq <- seq(min(StressAnxiety$stress), max(StressAnxiety$stress),
+   length.out = 100
+ )
> pred_mean <- predict(fit_kw, newdata = data.frame(stress = stress_seq))
> lines(stress_seq, pred_mean, col = "red", lwd = 2)
> 
> # Add lowess smooth for comparison
> lines(lowess(StressAnxiety$stress, StressAnxiety$anxiety),
+   col = "blue", lwd = 2, lty = 2
+ )
> legend("topleft",
+   legend = c("Kumaraswamy fit", "Lowess smooth"),
+   col = c("red", "blue"), lwd = 2, lty = c(1, 2)
+ )
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("StressAnxiety", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("WeatherTask")
> ### * WeatherTask
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: WeatherTask
> ### Title: Weather Task with Priming and Precise and Imprecise
> ###   Probabilities
> ### Aliases: WeatherTask
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(WeatherTask)
> 
> # Example 1: Main effects model
> # Probability judgments affected by priming and elicitation format
> fit_kw <- gkwreg(
+   agreement ~ priming + eliciting,
+   data = WeatherTask,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = agreement ~ priming + eliciting, data = WeatherTask, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2941 -0.1053 -0.0494 -0.0063  0.0899  0.7053 

Coefficients:
                         Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)         0.39534    0.06067   6.516 7.24e-11 ***
alpha:primingseven-fold  -0.18903    0.05241  -3.606  0.00031 ***
alpha:elicitingimprecise  0.21471    0.05233   4.103 4.07e-05 ***
beta:(Intercept)          1.81969    0.09799  18.571  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                              3%     98%
alpha:(Intercept)         0.2764  0.5143
alpha:primingseven-fold  -0.2918 -0.0863
alpha:elicitingimprecise  0.1122  0.3173
beta:(Intercept)          1.6276  2.0117

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1.524
beta: 6.164
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 345 
Number of parameters: 4 
Residual degrees of freedom: 341 
Log-likelihood: 201.6 
AIC: -395.2 
BIC: -379.9 
RMSE: 0.1541 
Efron's R2: 0.08752 
Mean Absolute Error: 0.1253 

Convergence status: Successful 
Iterations: 25 

> 
> # Interpretation:
> # - Alpha: Seven-fold priming may shift probability estimates
> #   Imprecise elicitation may produce different mean estimates
> 
> # Example 2: Interaction model with heteroscedasticity
> # Priming effects may differ by elicitation format
> # Variability may also depend on conditions
> fit_kw_interact <- gkwreg(
+   agreement ~ priming * eliciting |
+     priming + eliciting,
+   data = WeatherTask,
+   family = "kw"
+ )
> summary(fit_kw_interact)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = agreement ~ priming * eliciting | priming + 
    eliciting, data = WeatherTask, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2930 -0.1159 -0.0320 -0.0052  0.0910  0.6891 

Coefficients:
                                           Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)                           0.26198    0.08991   2.914  0.00357
alpha:primingseven-fold                     0.10566    0.10814   0.977  0.32850
alpha:elicitingimprecise                    0.21199    0.11980   1.769  0.07681
alpha:primingseven-fold:elicitingimprecise  0.08181    0.10438   0.784  0.43317
beta:(Intercept)                            1.46021    0.15558   9.385  < 2e-16
beta:primingseven-fold                      0.85229    0.20297   4.199 2.68e-05
beta:elicitingimprecise                     0.09174    0.19953   0.460  0.64566
                                              
alpha:(Intercept)                          ** 
alpha:primingseven-fold                       
alpha:elicitingimprecise                   .  
alpha:primingseven-fold:elicitingimprecise    
beta:(Intercept)                           ***
beta:primingseven-fold                     ***
beta:elicitingimprecise                       
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                                                3%    98%
alpha:(Intercept)                           0.0858 0.4382
alpha:primingseven-fold                    -0.1063 0.3176
alpha:elicitingimprecise                   -0.0228 0.4468
alpha:primingseven-fold:elicitingimprecise -0.1228 0.2864
beta:(Intercept)                            1.1553 1.7651
beta:primingseven-fold                      0.4545 1.2501
beta:elicitingimprecise                    -0.2993 0.4828

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1.566
beta: 7.428
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 345 
Number of parameters: 7 
Residual degrees of freedom: 338 
Log-likelihood: 210.9 
AIC: -407.8 
BIC: -380.9 
RMSE: 0.1537 
Efron's R2: 0.09164 
Mean Absolute Error: 0.124 

Convergence status: Successful 
Iterations: 31 

> 
> # Interpretation:
> # - Alpha: Interaction tests if partition priming works differently
> #   for precise vs. imprecise probability judgments
> # - Beta: Precision varies by experimental condition
> 
> # Test interaction
> anova(fit_kw, fit_kw_interact)
Analysis of Deviance Table

Model 1: agreement ~ priming + eliciting
Model 2: agreement ~ priming * eliciting | priming + eliciting

                Resid. Df Resid. Dev Df Deviance   Pr(>Chi)    
fit_kw          341.00000 -403.23406                           
fit_kw_interact 338.00000 -421.81480  3 18.58074 0.00033376 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: McDonald distribution for polarized responses
> # Probability judgments often show polarization (clustering at extremes)
> # particularly under certain priming conditions
> fit_mc <- gkwreg(
+   agreement ~ priming * eliciting | # gamma
+     priming * eliciting | # delta
+     priming, # lambda: priming affects polarization
+   data = WeatherTask,
+   family = "mc",
+   control = gkw_control(method = "BFGS", maxit = 1500)
+ )
> summary(fit_mc)

Generalized Kumaraswamy Regression Model Summary

Family: mc 

Call:
gkwreg(formula = agreement ~ priming * eliciting | priming * 
    eliciting | priming, data = WeatherTask, family = "mc", control = gkw_control(method = "BFGS", 
    maxit = 1500))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.2027 -0.0727 -0.0416  0.0351  0.1084  0.7564 

Coefficients:
                                            Estimate Std. Error z value
gamma:(Intercept)                           0.090319   0.222111   0.407
gamma:primingseven-fold                     0.036067   0.426063   0.085
gamma:elicitingimprecise                    0.054185   0.522357   0.104
gamma:primingseven-fold:elicitingimprecise  0.023760   0.566762   0.042
delta:(Intercept)                          -0.039825   0.534925  -0.074
delta:primingseven-fold                    -0.010793   0.644386  -0.017
delta:elicitingimprecise                   -0.025605   1.096937  -0.023
delta:primingseven-fold:elicitingimprecise -0.008725   1.274826  -0.007
lambda:(Intercept)                          0.165563   0.026202   6.319
lambda:primingseven-fold                    0.062143   0.216997   0.286
                                           Pr(>|z|)    
gamma:(Intercept)                             0.684    
gamma:primingseven-fold                       0.933    
gamma:elicitingimprecise                      0.917    
gamma:primingseven-fold:elicitingimprecise    0.967    
delta:(Intercept)                             0.941    
delta:primingseven-fold                       0.987    
delta:elicitingimprecise                      0.981    
delta:primingseven-fold:elicitingimprecise    0.995    
lambda:(Intercept)                         2.64e-10 ***
lambda:primingseven-fold                      0.775    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                                                3%    98%
gamma:(Intercept)                          -0.3450 0.5256
gamma:primingseven-fold                    -0.7990 0.8711
gamma:elicitingimprecise                   -0.9696 1.0780
gamma:primingseven-fold:elicitingimprecise -1.0871 1.1346
delta:(Intercept)                          -1.0883 1.0086
delta:primingseven-fold                    -1.2738 1.2522
delta:elicitingimprecise                   -2.1756 2.1244
delta:primingseven-fold:elicitingimprecise -2.5073 2.4899
lambda:(Intercept)                          0.1142 0.2169
lambda:primingseven-fold                   -0.3632 0.4874

Link functions:
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 1
beta: 1
gamma: 1.151
delta: 4.851
lambda: 1.216

Model fit statistics:
Number of observations: 345 
Number of parameters: 10 
Residual degrees of freedom: 335 
Log-likelihood: 175.9 
AIC: -331.8 
BIC: -293.4 
RMSE: 0.1669 
Efron's R2: -0.07105 
Mean Absolute Error: 0.1242 

Convergence status: Successful 
Iterations: 7 

> 
> # Interpretation:
> # - Lambda varies by priming: Seven-fold priming may produce more
> #   extreme/polarized probability judgments
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("WeatherTask", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("anova.gkwreg")
> ### * anova.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: anova.gkwreg
> ### Title: Analysis of Deviance for GKw Regression Models
> ### Aliases: anova.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> # Load example data
> data(GasolineYield)
> 
> # Fit a series of nested models
> fit1 <- gkwreg(yield ~ 1, data = GasolineYield, family = "kw")
> fit2 <- gkwreg(yield ~ temp, data = GasolineYield, family = "kw")
> fit3 <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # ANOVA table for single model
> anova(fit3)
Analysis of Deviance Table

Model: gkwreg(formula = yield ~ batch + temp, data = GasolineYield, 
Model:     family = "kw")

  Resid. Df Resid. Dev
1  20.00000 -193.93865
> 
> # Compare nested models using likelihood ratio tests
> anova(fit1, fit2, fit3)
Analysis of Deviance Table

Model 1: yield ~ 1
Model 2: yield ~ temp
Model 3: yield ~ batch + temp

     Resid. Df Resid. Dev Df  Deviance Pr(>Chi)    
fit1  30.00000  -57.02258                          
fit2  29.00000  -80.90259  1  23.88001  < 1e-04 ***
fit3  20.00000 -193.93865  9 113.03606  < 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> #> Model 1 vs 2: Adding temperature is highly significant (p < 0.001)
> #> Model 2 vs 3: Adding batch is highly significant (p < 0.001)
> 
> # Compare two models
> anova(fit2, fit3, test = "Chisq")
Analysis of Deviance Table

Model 1: yield ~ temp
Model 2: yield ~ batch + temp

     Resid. Df Resid. Dev Df  Deviance Pr(>Chi)    
fit2  29.00000  -80.90259                          
fit3  20.00000 -193.93865  9 113.03606  < 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Suppress test statistics
> anova(fit1, fit2, fit3, test = "none")
Analysis of Deviance Table

Model 1: yield ~ 1
Model 2: yield ~ temp
Model 3: yield ~ batch + temp

     Resid. Df Resid. Dev Df  Deviance
fit1  30.00000  -57.02258             
fit2  29.00000  -80.90259  1  23.88001
fit3  20.00000 -193.93865  9 113.03606
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("anova.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("confint.gkwreg")
> ### * confint.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: confint.gkwreg
> ### Title: Confidence Intervals for Generalized Kumaraswamy Regression
> ###   Parameters
> ### Aliases: confint.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # 95 percent confidence intervals
> confint(fit)
Warning: some standard errors are NA or infinite; intervals may be unreliable
                        2.5 %     97.5 %
alpha:(Intercept)  0.61309049  0.7255762
alpha:batch1       0.78581980  0.8904463
alpha:batch2       0.53531608  0.6472063
alpha:batch3       0.65446611  0.7660917
alpha:batch4       0.41447097  0.5190488
alpha:batch5       0.46459924  0.5759595
alpha:batch6       0.39388604  0.5056496
alpha:batch7       0.17258723  0.2769559
alpha:batch8       0.14773407  0.2586001
alpha:batch9       0.07935147  0.2043948
alpha:temp                NaN        NaN
beta:(Intercept)  28.03819235 29.7240822
> 
> # 90 percent confidence intervals
> confint(fit, level = 0.90)
Warning: some standard errors are NA or infinite; intervals may be unreliable
                         5 %       95 %
alpha:(Intercept)  0.6221328  0.7165338
alpha:batch1       0.7942304  0.8820357
alpha:batch2       0.5443106  0.6382118
alpha:batch3       0.6634393  0.7571185
alpha:batch4       0.4228776  0.5106421
alpha:batch5       0.4735511  0.5670076
alpha:batch6       0.4028704  0.4966653
alpha:batch7       0.1809771  0.2685661
alpha:batch8       0.1566462  0.2496880
alpha:batch9       0.0894033  0.1943430
alpha:temp               NaN        NaN
beta:(Intercept)  28.1737156 29.5885589
> 
> # Specific parameters
> confint(fit, parm = "alpha:(Intercept)")
Warning: some standard errors are NA or infinite; intervals may be unreliable
                      2.5 %    97.5 %
alpha:(Intercept) 0.6130905 0.7255762
> confint(fit, parm = 1:3)
Warning: some standard errors are NA or infinite; intervals may be unreliable
                      2.5 %    97.5 %
alpha:(Intercept) 0.6130905 0.7255762
alpha:batch1      0.7858198 0.8904463
alpha:batch2      0.5353161 0.6472063
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("confint.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("family.gkwreg")
> ### * family.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: family.gkwreg
> ### Title: Extract Family from GKw Regression Model
> ### Aliases: family.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> family(fit)
[1] "kw"
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("family.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("fitted.gkwreg")
> ### * fitted.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: fitted.gkwreg
> ### Title: Extract Fitted Values from a Generalized Kumaraswamy Regression
> ###   Model
> ### Aliases: fitted.gkwreg
> ### Keywords: fitted methods regression
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> # Example 1: Basic usage with FoodExpenditure data
> data(FoodExpenditure)
> FoodExpenditure$prop <- FoodExpenditure$food / FoodExpenditure$income
> 
> fit_kw <- gkwreg(prop ~ income + persons | income,
+   data = FoodExpenditure,
+   family = "kw"
+ )
> 
> # Extract fitted values
> fitted_vals <- fitted(fit_kw)
> 
> # Visualize fit quality
> plot(FoodExpenditure$prop, fitted_vals,
+   xlab = "Observed Proportion",
+   ylab = "Fitted Values",
+   main = "Observed vs Fitted: Food Expenditure",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> abline(0, 1, col = "red", lwd = 2)
> 
> # Calculate R-squared analogue
> cor(FoodExpenditure$prop, fitted_vals)^2
[1] 0.4596754
> 
> # Example 2: Comparing fitted values across families
> data(GasolineYield)
> 
> fit_ekw <- gkwreg(yield ~ batch + temp | temp | batch,
+   data = GasolineYield,
+   family = "ekw"
+ )
> 
> # Fitted values under different family assumptions
> fitted_ekw <- fitted(fit_ekw)
> fitted_kw <- fitted(fit_ekw, family = "kw")
Using different family (kw) than what was used to fit the model (ekw). Recalculating fitted values...
> fitted_beta <- fitted(fit_ekw, family = "beta")
Using different family (beta) than what was used to fit the model (ekw). Recalculating fitted values...
> 
> # Compare differences
> comparison <- data.frame(
+   EKW = fitted_ekw,
+   KW = fitted_kw,
+   Beta = fitted_beta,
+   Diff_EKW_KW = fitted_ekw - fitted_kw,
+   Diff_EKW_Beta = fitted_ekw - fitted_beta
+ )
> head(comparison)
         EKW         KW       Beta Diff_EKW_KW Diff_EKW_Beta
1 0.12232274 0.12232274 0.12232274           0             0
2 0.00010000 0.00010000 0.00010000           0             0
3 0.35297369 0.35297369 0.35297369           0             0
4 0.46181798 0.46181798 0.46181798           0             0
5 0.06734392 0.06734392 0.06734392           0             0
6 0.12847689 0.12847689 0.12847689           0             0
> 
> # Visualize differences
> par(mfrow = c(1, 2))
> plot(fitted_ekw, fitted_kw,
+   xlab = "EKW Fitted", ylab = "KW Fitted",
+   main = "EKW vs KW Family Assumptions",
+   pch = 19, col = "darkblue"
+ )
> abline(0, 1, col = "red", lty = 2)
> 
> plot(fitted_ekw, fitted_beta,
+   xlab = "EKW Fitted", ylab = "Beta Fitted",
+   main = "EKW vs Beta Family Assumptions",
+   pch = 19, col = "darkgreen"
+ )
> abline(0, 1, col = "red", lty = 2)
> par(mfrow = c(1, 1))
> 
> # Example 3: Diagnostic plot with confidence bands
> data(ReadingSkills)
> 
> fit_mc <- gkwreg(
+   accuracy ~ dyslexia * iq | dyslexia + iq | dyslexia,
+   data = ReadingSkills,
+   family = "mc"
+ )
> 
> fitted_vals <- fitted(fit_mc)
> 
> # Residual plot
> residuals_resp <- ReadingSkills$accuracy - fitted_vals
> 
> plot(fitted_vals, residuals_resp,
+   xlab = "Fitted Values",
+   ylab = "Raw Residuals",
+   main = "Residual Plot: Reading Accuracy",
+   pch = 19, col = ReadingSkills$dyslexia,
+   ylim = range(residuals_resp) * 1.2
+ )
> abline(h = 0, col = "red", lwd = 2, lty = 2)
> lowess_fit <- lowess(fitted_vals, residuals_resp)
> lines(lowess_fit, col = "blue", lwd = 2)
> legend("topright",
+   legend = c("Control", "Dyslexic", "Zero Line", "Lowess"),
+   col = c("black", "red", "red", "blue"),
+   pch = c(19, 19, NA, NA),
+   lty = c(NA, NA, 2, 1),
+   lwd = c(NA, NA, 2, 2)
+ )
> 
> # Example 4: Large dataset efficiency check
> set.seed(2024)
> n <- 5000
> x1 <- rnorm(n)
> x2 <- runif(n, -2, 2)
> alpha <- exp(0.3 + 0.5 * x1)
> beta <- exp(1.2 - 0.4 * x2)
> y <- rkw(n, alpha, beta)
> large_data <- data.frame(y = y, x1 = x1, x2 = x2)
> 
> fit_large <- gkwreg(y ~ x1 | x2,
+   data = large_data,
+   family = "kw"
+ )
> 
> # Time the extraction
> system.time({
+   fitted_large <- fitted(fit_large)
+ })
   user  system elapsed 
      0       0       0 
> 
> # Verify extraction
> length(fitted_large)
[1] 5000
> summary(fitted_large)
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
0.003856 0.207005 0.322890 0.330228 0.440560 0.848744 
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("fitted.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("formula.gkwreg")
> ### * formula.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: formula.gkwreg
> ### Title: Extract Formula from GKw Regression Model
> ### Aliases: formula.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> 
> # Simple formula
> fit1 <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> formula(fit1)
yield ~ batch + temp
> 
> # Two-part formula
> fit2 <- gkwreg(yield ~ temp | batch, data = GasolineYield, family = "kw")
> formula(fit2)
yield ~ temp | batch
> 
> # Five-part formula
> fit3 <- gkwreg(yield ~ temp | batch | temp | 1 | 1,
+   data = GasolineYield, family = "gkw"
+ )
Note: Using Makevars in /home/jlopes/.R/Makevars 
using C++ compiler: ‘g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
g++ -std=gnu++17 -I"/usr/share/R/include" -DNDEBUG -I"/home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/TMB/include" -I"/tmp/RtmpLzES3v/RLIBS_1c7c11e7227ce/RcppEigen/include"   -DTMB_EIGEN_DISABLE_WARNINGS   -DTMB_LIB_INIT=R_init_gkwreg  -DCPPAD_FRAMEWORK      -fpic  -g -O2 -Wall -pedantic -mtune=native  -c gkwreg.cpp -o gkwreg.o
g++ -std=gnu++17 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -Wl,-z,relro -o gkwreg.so gkwreg.o -L/usr/lib/R/lib -lR
> formula(fit3)
yield ~ temp | batch | temp | 1 | 1
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("formula.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("getCall.gkwreg")
> ### * getCall.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: getCall.gkwreg
> ### Title: Get Call from GKw Regression Model
> ### Aliases: getCall.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> getCall(fit)
gkwreg(formula = yield ~ batch + temp, data = GasolineYield, 
    family = "kw")
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("getCall.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("gkw_control")
> ### * gkw_control
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: gkw_control
> ### Title: Control Parameters for Generalized Kumaraswamy Regression
> ### Aliases: gkw_control print.gkw_control
> 
> ### ** Examples
> 
> ## No test: 
> # Default control (used automatically if not specified)
> ctrl <- gkw_control()
> print(ctrl)
Generalized Kumaraswamy Control Parameters
===========================================

Optimization:
  Method:             nlminb 
  Max evaluations:    500 
  Max iterations:     300 
  Relative tolerance: 1.490116e-08 
  Absolute tolerance: 0e+00 

Output:
  Compute Hessian:    TRUE 
  Silent mode:        TRUE 
> 
> # Increase iterations for difficult problem
> ctrl_robust <- gkw_control(maxit = 1000, trace = 1)
> 
> # Try alternative optimizer
> ctrl_bfgs <- gkw_control(method = "BFGS")
> 
> # Fast fitting without standard errors
> ctrl_fast <- gkw_control(hessian = FALSE)
> 
> # Verbose debugging
> ctrl_debug <- gkw_control(silent = FALSE, trace = 2)
> 
> # Custom starting values
> ctrl_start <- gkw_control(
+   start = list(
+     alpha = c(0.5, 0.2),
+     beta = c(1.0, -0.3)
+   )
+ )
> 
> # Configure Nelder-Mead with custom reflection/contraction
> ctrl_nm <- gkw_control(
+   method = "Nelder-Mead",
+   alpha = 1.5,
+   beta = 0.75
+ )
> 
> # Configure L-BFGS-B for bounded optimization
> ctrl_lbfgsb <- gkw_control(
+   method = "L-BFGS-B",
+   factr = 1e6,
+   lmm = 10
+ )
> 
> # Configure SANN for rough surfaces
> ctrl_sann <- gkw_control(
+   method = "SANN",
+   temp = 20,
+   tmax = 20,
+   maxit = 20000
+ )
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("gkw_control", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("gkwreg")
> ### * gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: gkwreg
> ### Title: Fit Generalized Kumaraswamy Regression Models
> ### Aliases: gkwreg
> ### Keywords: models regression
> 
> ### ** Examples
> 
> ## No test: 
> # SECTION 1: Basic Usage - Getting Started
> # Load packages and data
> library(gkwreg)
> library(gkwdist)
> data(GasolineYield)
> 
> # Example 1.1: Simplest possible model (intercept-only, all defaults)
> fit_basic <- gkwreg(yield ~ 1, data = GasolineYield, family = "kw")
> summary(fit_basic)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = yield ~ 1, data = GasolineYield, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1688 -0.0803 -0.0188 -0.0002  0.0737  0.2602 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)   0.6342     0.1538   4.124 3.73e-05 ***
beta:(Intercept)    2.7951     0.4319   6.472 9.68e-11 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                      3%    98%
alpha:(Intercept) 0.3328 0.9356
beta:(Intercept)  1.9486 3.6416

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 1.886
beta: 16.35
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 2 
Residual degrees of freedom: 30 
Log-likelihood: 28.51 
AIC: -53.02 
BIC: -50.09 
RMSE: 0.1055 
Efron's R2: -4.747e-06 
Mean Absolute Error: 0.09088 

Convergence status: Successful 
Iterations: 11 

> 
> # Example 1.2: Model with predictors (uses all defaults)
> # Default: family = "gkw", method = "nlminb", hessian = TRUE
> fit_default <- gkwreg(yield ~ batch + temp, data = GasolineYield)
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_default)

Generalized Kumaraswamy Regression Model Summary

Family: gkw 

Call:
gkwreg(formula = yield ~ batch + temp, data = GasolineYield)

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.0235 -0.0071 -0.0017 -0.0002  0.0072  0.0285 

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  -1.419893   0.666514  -2.130   0.0331 *  
alpha:batch1        0.918498   0.032368  28.377  < 2e-16 ***
alpha:batch2        0.676328   0.034627  19.532  < 2e-16 ***
alpha:batch3        0.781489   0.034587  22.595  < 2e-16 ***
alpha:batch4        0.557260   0.032509  17.142  < 2e-16 ***
alpha:batch5        0.562416   0.034498  16.303  < 2e-16 ***
alpha:batch6        0.539377   0.034694  15.547  < 2e-16 ***
alpha:batch7        0.308696   0.032499   9.499  < 2e-16 ***
alpha:batch8        0.254507   0.034578   7.360 1.83e-13 ***
alpha:batch9        0.198134   0.038561   5.138 2.77e-07 ***
alpha:temp          0.005403        NaN     NaN      NaN    
beta:(Intercept)    5.511544   2.754889   2.001   0.0454 *  
gamma:(Intercept)   2.560940   2.294913   1.116   0.2645    
delta:(Intercept)  -2.153490   2.535825  -0.849   0.3958    
lambda:(Intercept)  2.190526   2.324758   0.942   0.3461    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                        3%     98%
alpha:(Intercept)  -2.7262 -0.1135
alpha:batch1        0.8551  0.9819
alpha:batch2        0.6085  0.7442
alpha:batch3        0.7137  0.8493
alpha:batch4        0.4935  0.6210
alpha:batch5        0.4948  0.6300
alpha:batch6        0.4714  0.6074
alpha:batch7        0.2450  0.3724
alpha:batch8        0.1867  0.3223
alpha:batch9        0.1226  0.2737
alpha:temp             NaN     NaN
beta:(Intercept)    0.1121 10.9110
gamma:(Intercept)  -1.9370  7.0589
delta:(Intercept)  -7.1236  2.8166
lambda:(Intercept) -2.3659  6.7470

Link functions:
alpha: log
beta: log
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 2.552
beta: 247.5
gamma: 12.95
delta: 1.04
lambda: 8.931

Model fit statistics:
Number of observations: 32 
Number of parameters: 15 
Residual degrees of freedom: 17 
Log-likelihood: 95.61 
AIC: -161.2 
BIC: -139.2 
RMSE: 0.0139 
Efron's R2: 0.9826 
Mean Absolute Error: 0.01113 

Convergence status: Successful 
Iterations: 145 

> 
> # Example 1.3: Kumaraswamy model (two-parameter family)
> # Default link functions: log for both alpha and beta
> fit_kw <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = yield ~ batch + temp, data = GasolineYield, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.0307 -0.0074  0.0036 -0.0007  0.0086  0.0175 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  0.669333   0.028696  23.325  < 2e-16 ***
alpha:batch1       0.838133   0.026691  31.401  < 2e-16 ***
alpha:batch2       0.591261   0.028544  20.714  < 2e-16 ***
alpha:batch3       0.710279   0.028476  24.943  < 2e-16 ***
alpha:batch4       0.466760   0.026679  17.496  < 2e-16 ***
alpha:batch5       0.520279   0.028409  18.314  < 2e-16 ***
alpha:batch6       0.449768   0.028512  15.775  < 2e-16 ***
alpha:batch7       0.224772   0.026625   8.442  < 2e-16 ***
alpha:batch8       0.203167   0.028283   7.183 6.80e-13 ***
alpha:batch9       0.141873   0.031899   4.448 8.69e-06 ***
alpha:temp         0.005282        NaN     NaN      NaN    
beta:(Intercept)  28.881137   0.430082  67.153  < 2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  0.6131  0.7256
alpha:batch1       0.7858  0.8904
alpha:batch2       0.5353  0.6472
alpha:batch3       0.6545  0.7661
alpha:batch4       0.4145  0.5190
alpha:batch5       0.4646  0.5760
alpha:batch6       0.3939  0.5056
alpha:batch7       0.1726  0.2770
alpha:batch8       0.1477  0.2586
alpha:batch9       0.0794  0.2044
alpha:temp            NaN     NaN
beta:(Intercept)  28.0382 29.7241

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 18.47
beta: 3.487e+12
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 12 
Residual degrees of freedom: 20 
Log-likelihood: 96.97 
AIC: -169.9 
BIC: -152.3 
RMSE: 0.01292 
Efron's R2: 0.985 
Mean Absolute Error: 0.01068 

Convergence status: Failed 
Iterations: 77 

> 
> par(mfrow = c(3, 2))
> plot(fit_kw, ask = FALSE)
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Example 1.4: Beta model for comparison
> # Default links: log for gamma and delta
> fit_beta <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "beta")
Note: Using Makevars in /home/jlopes/.R/Makevars 
using C++ compiler: ‘g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
g++ -std=gnu++17 -I"/usr/share/R/include" -DNDEBUG -I"/home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/TMB/include" -I"/tmp/RtmpLzES3v/RLIBS_1c7c11e7227ce/RcppEigen/include"   -DTMB_EIGEN_DISABLE_WARNINGS   -DTMB_LIB_INIT=R_init_gkwbetareg  -DCPPAD_FRAMEWORK      -fpic  -g -O2 -Wall -pedantic -mtune=native  -c gkwbetareg.cpp -o gkwbetareg.o
g++ -std=gnu++17 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -Wl,-z,relro -o gkwbetareg.so gkwbetareg.o -L/usr/lib/R/lib -lR
> 
> # Compare models using AIC/BIC
> AIC(fit_kw, fit_beta)
         df        AIC
fit_kw   12 -169.93865
fit_beta 12  -66.52315
> BIC(fit_kw, fit_beta)
         df        BIC
fit_kw   12 -152.34982
fit_beta 12  -48.93432
> 
> # SECTION 2: Using gkw_control() for Customization
> 
> # Example 2.1: Change optimization method to BFGS
> fit_bfgs <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   control = gkw_control(method = "BFGS")
+ )
> summary(fit_bfgs)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = yield ~ batch + temp, data = GasolineYield, 
    family = "kw", control = gkw_control(method = "BFGS"))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.4270 -0.3404 -0.2601 -0.2400 -0.1571  0.0346 

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept) -2.642e-06  1.244e+00   0.000    1.000
alpha:batch1      -1.481e-07  7.956e-01   0.000    1.000
alpha:batch2      -2.952e-07  7.610e-01   0.000    1.000
alpha:batch3      -2.558e-07  7.878e-01   0.000    1.000
alpha:batch4      -3.067e-07  6.980e-01   0.000    1.000
alpha:batch5      -1.339e-07  7.555e-01   0.000    1.000
alpha:batch6      -1.890e-07  7.388e-01   0.000    1.000
alpha:batch7      -5.561e-07  6.586e-01   0.000    1.000
alpha:batch8      -2.938e-07  6.854e-01   0.000    1.000
alpha:batch9      -1.461e-07  7.854e-01   0.000    1.000
alpha:temp        -7.717e-04  3.133e-03  -0.246    0.805
beta:(Intercept)   2.530e-06  5.131e-01   0.000    1.000

Confidence intervals (95%):
                       3%    98%
alpha:(Intercept) -2.4382 2.4382
alpha:batch1      -1.5593 1.5593
alpha:batch2      -1.4916 1.4916
alpha:batch3      -1.5441 1.5441
alpha:batch4      -1.3680 1.3680
alpha:batch5      -1.4808 1.4808
alpha:batch6      -1.4479 1.4479
alpha:batch7      -1.2908 1.2908
alpha:batch8      -1.3433 1.3433
alpha:batch9      -1.5394 1.5394
alpha:temp        -0.0069 0.0054
beta:(Intercept)  -1.0057 1.0057

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 0.775
beta: 0.999
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 12 
Residual degrees of freedom: 20 
Log-likelihood: 4.18 
AIC: 15.64 
BIC: 33.23 
RMSE: 0.2662 
Efron's R2: -5.362 
Mean Absolute Error: 0.2422 

Convergence status: Successful 
Iterations: 12 

> 
> # Example 2.2: Increase iterations and enable verbose output
> fit_verbose <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   control = gkw_control(
+     method = "nlminb",
+     maxit = 1000,
+     silent = FALSE, # Show optimization progress
+     trace = 1 # Print iteration details
+   )
+ )
Using TMB model: kwreg
[TMB] Preparing TMB model: kwreg
[TMB] Loaded DLL: kwreg.so
[TMB] Loaded cached DLL: kwreg
Optimizing with nlminb...
outer mgc:  7535.888 
  0:     0.0000000:  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000
outer mgc:  1043.999 
  1:    -5.4751175: -4.63847e-06 -2.59943e-07 -5.18250e-07 -4.49143e-07 -5.38512e-07 -2.35055e-07 -3.31849e-07 -9.76418e-07 -5.15872e-07 -2.56583e-07 -0.00135487 4.44139e-06
outer mgc:  248.2347 
  2:    -5.6372510: -0.000220415 4.16287e-05 -6.57121e-05 -4.96481e-05 -2.17994e-05 4.41064e-05 1.14631e-05 -0.000146966 -2.99241e-05 1.37058e-05 -0.00157060 0.00131183
outer mgc:  473.1837 
  3:    -17.969328: -0.136724 0.0277276 -0.0411281 -0.0307797 -0.0132258 0.0285480 0.00773975 -0.0933782 -0.0190868 0.00856339 0.000220983 0.807421
outer mgc:  9403.659 
  4:    -26.755529: -1.05462 0.724290 -0.0972976 0.0815258 -0.00801223 0.221600 0.0531230 -0.597665 -0.396572 -0.204538 0.00463826  1.75768
outer mgc:  2886.778 
  5:    -37.161577: -1.99422 0.532895 0.375388 0.595205 0.184898 0.118380 0.0752171 0.0400090 -0.446348 -0.559931 0.00739496  2.61648
outer mgc:  7.749627 
  6:    -37.319116: -1.99422 0.532895 0.375388 0.595205 0.184898 0.118380 0.0752172 0.0400089 -0.446347 -0.559931 0.00728617  2.61648
outer mgc:  550.0578 
  7:    -41.464061: -2.02667 0.914794  1.02259 0.900567 0.498035 0.229685 0.432451 0.250005 0.606057 -0.140198 0.00692665  3.32846
outer mgc:  5344.69 
  8:    -45.753042: -1.76430  1.27538  1.24545  1.16880 0.977965 0.907505 0.936306 0.774485  1.02539 0.611458 0.00552332  4.00061
outer mgc:  1670.43 
  9:    -47.955163: -1.64864  1.22488  1.11887  1.24717 0.859116 0.813747 0.957285 0.611050 0.863210 0.747015 0.00532993  4.07981
outer mgc:  9795.288 
 10:    -51.767663: -1.40959  1.20843 0.839361 0.870775 0.757785 0.725397 0.685794 0.396577 0.539655 0.627278 0.00501252  4.22953
outer mgc:  2710.496 
 11:    -53.248253: -1.12767  1.06051 0.668602 0.815387 0.477102 0.862767 0.718959 0.248646 0.338869 0.171931 0.00481642  4.46311
outer mgc:  16842.91 
 12:    -53.429246: -1.03560 0.930350 0.552767 0.812949 0.558985 0.739392 0.653578 0.201404 0.199360 0.0828970 0.00510502  4.64797
outer mgc:  1617.054 
 13:    -56.920478: -1.04556 0.887457 0.544651 0.761934 0.449875 0.698924 0.597230 0.252503 0.149860 0.124954 0.00497747  4.71163
outer mgc:  2975.096 
 14:    -57.122716: -1.05628 0.887144 0.621162 0.746286 0.377752 0.704226 0.517575 0.263577 0.114298 0.184229 0.00515212  4.80920
outer mgc:  5629.443 
 15:    -59.508340: -1.16932 0.831867 0.647262 0.740311 0.473678 0.698786 0.442163 0.126740 0.190201 0.212037 0.00583191  5.38867
outer mgc:  4395.124 
 16:    -63.076455: -1.15522 0.976613 0.645814 0.760813 0.523103 0.518533 0.436436 0.149771 0.199569 0.171118 0.00602373  5.96632
outer mgc:  196.8215 
 17:    -63.160743: -1.15522 0.976613 0.645814 0.760813 0.523103 0.518533 0.436436 0.149771 0.199569 0.171118 0.00598723  5.96632
outer mgc:  18.42406 
 18:    -63.161178: -1.15521 0.976604 0.645809 0.760798 0.523100 0.518521 0.436445 0.149773 0.199566 0.171117 0.00598550  5.96635
outer mgc:  461.7689 
 19:    -63.890234: -1.12318 0.928341 0.620142 0.679521 0.504704 0.446154 0.489708 0.158607 0.181216 0.166103 0.00601617  6.12062
outer mgc:  791.2478 
 20:    -66.036596: -0.800206 0.769772 0.518142 0.643273 0.495658 0.295760 0.349990 0.156598 0.120672 0.0735364 0.00553780  6.68285
outer mgc:  8171.629 
 21:    -69.640060: -0.668180 0.830978 0.522586 0.674831 0.529395 0.393655 0.415273 0.236722 0.179303 0.125246 0.00532357  7.36258
outer mgc:  1565.565 
 22:    -70.355079: -0.626741 0.844078 0.585063 0.678075 0.561437 0.412512 0.448970 0.234407 0.160557 0.127507 0.00518349  7.51316
outer mgc:  16132.41 
 23:    -70.925305: -0.656731 0.855902 0.591969 0.712135 0.557942 0.437277 0.462929 0.267301 0.186961 0.131086 0.00519836  7.67594
outer mgc:  992.5871 
 24:    -72.287011: -0.656650 0.866594 0.616989 0.732895 0.565204 0.457702 0.481938 0.284546 0.196027 0.134163 0.00530147  7.84613
outer mgc:  10629.38 
 25:    -75.105520: -0.494803 0.937004 0.806321 0.861938 0.579462 0.628636 0.624693 0.384401 0.289508 0.186246 0.00521692  9.70792
outer mgc:  18969.12 
 26:    -76.692255: -0.333361 0.887587 0.734577 0.783233 0.508464 0.600339 0.566039 0.306909 0.258688 0.197094 0.00500158  10.0584
outer mgc:  6260.027 
 27:    -79.259103: -0.369687 0.862439 0.670965 0.759088 0.497862 0.596401 0.509338 0.276911 0.163088 0.176222 0.00526577  10.4567
outer mgc:  16287.87 
 28:    -81.053798: -0.376928 0.870388 0.626177 0.705981 0.497203 0.570252 0.452039 0.237364 0.224924 0.150962 0.00537596  10.8617
outer mgc:  12963.16 
 29:    -82.151851: -0.364627 0.880116 0.606015 0.722805 0.507469 0.549036 0.458418 0.233001 0.224630 0.156515 0.00551800  11.2830
outer mgc:  8317.292 
 30:    -83.329837: -0.312697 0.874169 0.594294 0.739479 0.490313 0.514716 0.475484 0.229621 0.224870 0.172911 0.00546802  11.6999
outer mgc:  16486.14 
 31:    -84.986835: -0.192865 0.853400 0.595130 0.717311 0.477081 0.490337 0.460508 0.235518 0.216189 0.162595 0.00536386  12.5363
outer mgc:  16178.4 
 32:    -86.555130: -0.103660 0.852072 0.593116 0.723514 0.494456 0.507035 0.475202 0.234153 0.220827 0.171784 0.00526956  13.3773
outer mgc:  29858.1 
 33:    -88.596572: -0.0142778 0.872344 0.620063 0.744182 0.474163 0.523267 0.479167 0.257521 0.213986 0.146453 0.00535175  15.0663
outer mgc:  4090.948 
 34:    -88.615340: -0.000990117 0.902580 0.704435 0.787394 0.558575 0.568736 0.517017 0.339891 0.253565 0.244840 0.00543371  16.7473
outer mgc:  6187 
 35:    -90.392361: 0.0985384 0.859188 0.666724 0.747058 0.538160 0.535854 0.494613 0.299087 0.221230 0.165105 0.00537535  17.5781
outer mgc:  23677.04 
 36:    -90.601186: 0.285604 0.888612 0.601393 0.700915 0.510188 0.513569 0.451882 0.236701 0.192324 0.123306 0.00521226  19.2551
outer mgc:  5588.837 
 37:    -92.504039: 0.314495 0.858162 0.577322 0.696464 0.473482 0.521344 0.444638 0.208070 0.197319 0.121994 0.00516530  19.3876
outer mgc:  3309.009 
 38:    -93.042485: 0.316922 0.850751 0.574503 0.695607 0.469865 0.519612 0.445518 0.208463 0.198603 0.125129 0.00518065  19.5362
outer mgc:  3996.36 
 39:    -93.550654: 0.320696 0.843080 0.584565 0.705608 0.469072 0.517989 0.444761 0.205085 0.200705 0.126715 0.00520644  19.8338
outer mgc:  17352.89 
 40:    -93.849295: 0.332284 0.837333 0.584783 0.707135 0.467210 0.521063 0.448395 0.208314 0.202877 0.128243 0.00522856  20.1314
outer mgc:  3406.956 
 41:    -94.407020: 0.332577 0.839173 0.587505 0.710933 0.467005 0.525668 0.458377 0.222651 0.205102 0.130060 0.00524213  20.4289
outer mgc:  3404.857 
 42:    -94.965671: 0.338916 0.840802 0.596147 0.710362 0.473493 0.511103 0.456749 0.226911 0.203994 0.151337 0.00533729  21.2777
outer mgc:  11746.01 
 43:    -95.316481: 0.385958 0.835928 0.593772 0.718096 0.472879 0.514803 0.454766 0.233790 0.209386 0.152955 0.00531950  22.1256
outer mgc:  29124.99 
 44:    -95.424086: 0.420780 0.842717 0.608497 0.718265 0.475043 0.523533 0.473657 0.236527 0.216088 0.158017 0.00532031  22.9738
outer mgc:  26417.85 
 45:    -95.903344: 0.450111 0.857226 0.610561 0.733603 0.486468 0.535142 0.464887 0.241711 0.218040 0.154498 0.00532283  23.8222
outer mgc:  7281.973 
 46:    -96.130130: 0.482702 0.846683 0.602675 0.722989 0.477554 0.529472 0.454392 0.235030 0.210302 0.152475 0.00525428  24.0048
outer mgc:  494.6355 
 47:    -96.419388: 0.517818 0.839957 0.588196 0.712568 0.469754 0.516728 0.450185 0.224012 0.204822 0.138567 0.00526935  24.7520
outer mgc:  15964.68 
 48:    -96.538002: 0.550105 0.835039 0.586860 0.706279 0.466407 0.518103 0.446995 0.221504 0.199669 0.138062 0.00527778  25.4999
outer mgc:  15028.28 
 49:    -96.659094: 0.557183 0.845174 0.599214 0.713727 0.475068 0.523387 0.461330 0.230087 0.209579 0.142691 0.00531772  26.2480
outer mgc:  13673.4 
 50:    -96.710876: 0.582408 0.845663 0.596602 0.717699 0.467337 0.516888 0.457807 0.228836 0.201827 0.146314 0.00530960  26.7750
outer mgc:  16619.74 
 51:    -96.746241: 0.612360 0.835150 0.589210 0.710122 0.466433 0.522171 0.443317 0.223072 0.203398 0.146455 0.00526606  27.1802
outer mgc:  3054.736 
 52:    -96.856463: 0.631709 0.834716 0.589077 0.709364 0.467876 0.521535 0.445105 0.223566 0.205436 0.144513 0.00525975  27.5866
outer mgc:  4217.137 
 53:    -96.912975: 0.623191 0.838384 0.591612 0.710755 0.468407 0.522122 0.450088 0.225337 0.202047 0.142101 0.00528500  27.6164
outer mgc:  3813.301 
 54:    -96.927619: 0.626130 0.839374 0.592800 0.710696 0.467798 0.521047 0.450428 0.226009 0.203536 0.141804 0.00528609  27.7159
outer mgc:  3275.102 
 55:    -96.941344: 0.633626 0.839508 0.592871 0.711675 0.468597 0.520734 0.452080 0.226002 0.204363 0.142919 0.00528373  27.9150
outer mgc:  5367.523 
 56:    -96.953941: 0.648499 0.839078 0.592276 0.711195 0.467637 0.520243 0.451059 0.225383 0.204036 0.142143 0.00528447  28.3133
outer mgc:  91.20114 
 57:    -96.965449: 0.663007 0.838436 0.591593 0.710283 0.467228 0.519854 0.450467 0.225472 0.203644 0.141673 0.00528054  28.6904
outer mgc:  169.5495 
 58:    -96.967491: 0.668964 0.838083 0.591585 0.710668 0.466347 0.520488 0.449882 0.224093 0.203429 0.141829 0.00528374  28.8833
outer mgc:  495.9119 
 59:    -96.968845: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  495.1999 
 60:    -96.968917: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  493.7759 
 61:    -96.969061: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  493.4911 
 62:    -96.969090: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  492.9215 
 63:    -96.969148: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.7823 
 64:    -96.969263: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.5545 
 65:    -96.969286: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.5089 
 66:    -96.969290: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.4178 
 67:    -96.969300: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.2355 
 68:    -96.969318: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1991 
 69:    -96.969322: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1918 
 70:    -96.969322: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1903 
 71:    -96.969323: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1874 
 72:    -96.969323: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1816 
 73:    -96.969323: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1804 
 74:    -96.969324: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1781 
 75:    -96.969324: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
outer mgc:  491.1776 
 76:    -96.969324: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
 77:    -96.969324: 0.669333 0.838133 0.591261 0.710279 0.466760 0.520279 0.449768 0.224772 0.203167 0.141873 0.00528250  28.8811
Computing standard errors...
outer mgc:  491.1776 
outer mgc:  9023.392 
outer mgc:  8261.428 
outer mgc:  1308.121 
outer mgc:  346.914 
outer mgc:  1106.839 
outer mgc:  140.4563 
outer mgc:  1222.261 
outer mgc:  258.8762 
outer mgc:  1491.92 
outer mgc:  535.7422 
outer mgc:  1433.164 
outer mgc:  474.8577 
outer mgc:  1299.185 
outer mgc:  337.9714 
outer mgc:  1612.674 
outer mgc:  659.4646 
outer mgc:  1475.661 
outer mgc:  518.811 
outer mgc:  1063.454 
outer mgc:  95.80996 
outer mgc:  433814.8 
outer mgc:  1598167413 
outer mgc:  188.426 
outer mgc:  793.6266 
outer mgc:  1 
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Example 2.3: Fast fitting without standard errors
> # Useful for model exploration or large datasets
> fit_fast <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   control = gkw_control(hessian = FALSE)
+ )
> # Note: Cannot compute confint() without hessian
> coef(fit_fast) # Point estimates still available
alpha:(Intercept)      alpha:batch1      alpha:batch2      alpha:batch3 
      0.669333319       0.838133049       0.591261201       0.710278918 
     alpha:batch4      alpha:batch5      alpha:batch6      alpha:batch7 
      0.466759877       0.520279363       0.449767828       0.224771574 
     alpha:batch8      alpha:batch9        alpha:temp  beta:(Intercept) 
      0.203167110       0.141873137       0.005282497      28.881137258 
> 
> # Example 2.4: Custom convergence tolerances
> fit_tight <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   control = gkw_control(
+     reltol = 1e-10, # Tighter convergence
+     maxit = 2000 # More iterations allowed
+   )
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # SECTION 3: Advanced Formula Specifications
> 
> # Example 3.1: Different predictors for different parameters
> # alpha depends on batch, beta depends on temp
> fit_diff <- gkwreg(
+   yield ~ batch | temp,
+   data = GasolineYield,
+   family = "kw"
+ )
> summary(fit_diff)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = yield ~ batch | temp, data = GasolineYield, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.0989 -0.0233  0.0005 -0.0108  0.0118  0.0214 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  1.88013    0.12809  14.678  < 2e-16 ***
alpha:batch1       0.86260    0.05709  15.109  < 2e-16 ***
alpha:batch2       0.60776    0.05797  10.484  < 2e-16 ***
alpha:batch3       0.75706    0.05723  13.229  < 2e-16 ***
alpha:batch4       0.51423    0.05689   9.039  < 2e-16 ***
alpha:batch5       0.51897    0.06013   8.631  < 2e-16 ***
alpha:batch6       0.49736    0.05944   8.368  < 2e-16 ***
alpha:batch7       0.25282    0.05727   4.414 1.01e-05 ***
alpha:batch8       0.20432    0.06025   3.391 0.000695 ***
alpha:batch9       0.20744    0.06828   3.038 0.002381 ** 
beta:(Intercept)  51.66408    6.11692   8.446  < 2e-16 ***
beta:temp         -0.10073    0.01231  -8.181 2.82e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  1.6291  2.1312
alpha:batch1       0.7507  0.9745
alpha:batch2       0.4941  0.7214
alpha:batch3       0.6449  0.8692
alpha:batch4       0.4027  0.6257
alpha:batch5       0.4011  0.6368
alpha:batch6       0.3809  0.6139
alpha:batch7       0.1406  0.3651
alpha:batch8       0.0862  0.3224
alpha:batch9       0.0736  0.3413
beta:(Intercept)  39.6751 63.6530
beta:temp         -0.1249 -0.0766

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 10.72
beta: 1.393e+12
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 12 
Residual degrees of freedom: 20 
Log-likelihood: 80.5 
AIC: -137 
BIC: -119.4 
RMSE: 0.0345 
Efron's R2: 0.8931 
Mean Absolute Error: 0.02294 

Convergence status: Failed 
Iterations: 59 

> 
> # Example 3.2: Intercept-only for one parameter
> # alpha varies with predictors, beta is constant
> fit_partial <- gkwreg(
+   yield ~ batch + temp | 1,
+   data = GasolineYield,
+   family = "kw"
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Example 3.3: Complex model with interactions
> fit_interact <- gkwreg(
+   yield ~ batch * temp | temp + I(temp^2),
+   data = GasolineYield,
+   family = "kw"
+ )
> 
> # SECTION 4: Working with Different Families
> 
> # Example 4.1: Fit multiple families and compare
> families <- c("beta", "kw", "ekw", "bkw", "gkw")
> fits <- lapply(families, function(fam) {
+   gkwreg(yield ~ batch + temp, data = GasolineYield, family = fam)
+ })
Warning in sqrt(diag(cov)) : NaNs produced
Warning in sqrt(diag(cov)) : NaNs produced
Note: Using Makevars in /home/jlopes/.R/Makevars 
using C++ compiler: ‘g++ (Ubuntu 13.3.0-6ubuntu2~24.04) 13.3.0’
g++ -std=gnu++17 -I"/usr/share/R/include" -DNDEBUG -I"/home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/TMB/include" -I"/tmp/RtmpLzES3v/RLIBS_1c7c11e7227ce/RcppEigen/include"   -DTMB_EIGEN_DISABLE_WARNINGS   -DTMB_LIB_INIT=R_init_bkwreg  -DCPPAD_FRAMEWORK      -fpic  -g -O2 -Wall -pedantic -mtune=native  -c bkwreg.cpp -o bkwreg.o
g++ -std=gnu++17 -shared -L/usr/lib/R/lib -Wl,-Bsymbolic-functions -flto=auto -ffat-lto-objects -Wl,-z,relro -o bkwreg.so bkwreg.o -L/usr/lib/R/lib -lR
Warning in sqrt(diag(cov)) : NaNs produced
Warning in sqrt(diag(cov)) : NaNs produced
> names(fits) <- families
> 
> # Compare via information criteria
> comparison <- data.frame(
+   Family = families,
+   LogLik = sapply(fits, logLik),
+   AIC = sapply(fits, AIC),
+   BIC = sapply(fits, BIC),
+   npar = sapply(fits, function(x) x$npar)
+ )
> print(comparison)
     Family   LogLik        AIC        BIC npar
beta   beta 45.26157  -66.52315  -48.93432   12
kw       kw 96.96932 -169.93865 -152.34982   12
ekw     ekw 97.31460 -168.62921 -149.57464   13
bkw     bkw 96.44294 -164.88587 -144.36557   14
gkw     gkw 95.60590 -161.21180 -139.22576   15
> 
> # Example 4.2: Formal nested model testing
> fit_kw <- gkwreg(yield ~ batch + temp, GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> fit_ekw <- gkwreg(yield ~ batch + temp, GasolineYield, family = "ekw")
Warning in sqrt(diag(cov)) : NaNs produced
> fit_gkw <- gkwreg(yield ~ batch + temp, GasolineYield, family = "gkw")
Warning in sqrt(diag(cov)) : NaNs produced
> anova(fit_kw, fit_ekw, fit_gkw)
Warning: negative deviance change detected; models may not be nested
Analysis of Deviance Table

Model 1: yield ~ batch + temp
Model 2: yield ~ batch + temp
Model 3: yield ~ batch + temp

        Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
fit_kw   20.00000 -193.93865                       
fit_ekw  19.00000 -194.62921  1  0.69056  0.40597  
fit_gkw  17.00000 -191.21180  2 -3.41741           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # SECTION 5: Link Functions and Scales
> 
> # Example 5.1: Custom link functions
> fit_links <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   link = list(alpha = "sqrt", beta = "log")
+ )
> 
> # Example 5.2: Custom link scales
> # Smaller scale = steeper response curve
> fit_scale <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   link_scale = list(alpha = 5, beta = 15)
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Example 5.3: Uniform link for all parameters
> fit_uniform <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   link = "log" # Single string applied to all
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # SECTION 6: Prediction and Inference
> 
> # Fit model for prediction examples
> fit <- gkwreg(yield ~ batch + temp, GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Example 6.1: Confidence intervals at different levels
> confint(fit, level = 0.95) # 95% CI
Warning: some standard errors are NA or infinite; intervals may be unreliable
                        2.5 %     97.5 %
alpha:(Intercept)  0.61309049  0.7255762
alpha:batch1       0.78581980  0.8904463
alpha:batch2       0.53531608  0.6472063
alpha:batch3       0.65446611  0.7660917
alpha:batch4       0.41447097  0.5190488
alpha:batch5       0.46459924  0.5759595
alpha:batch6       0.39388604  0.5056496
alpha:batch7       0.17258723  0.2769559
alpha:batch8       0.14773407  0.2586001
alpha:batch9       0.07935147  0.2043948
alpha:temp                NaN        NaN
beta:(Intercept)  28.03819235 29.7240822
> confint(fit, level = 0.90) # 90% CI
Warning: some standard errors are NA or infinite; intervals may be unreliable
                         5 %       95 %
alpha:(Intercept)  0.6221328  0.7165338
alpha:batch1       0.7942304  0.8820357
alpha:batch2       0.5443106  0.6382118
alpha:batch3       0.6634393  0.7571185
alpha:batch4       0.4228776  0.5106421
alpha:batch5       0.4735511  0.5670076
alpha:batch6       0.4028704  0.4966653
alpha:batch7       0.1809771  0.2685661
alpha:batch8       0.1566462  0.2496880
alpha:batch9       0.0894033  0.1943430
alpha:temp               NaN        NaN
beta:(Intercept)  28.1737156 29.5885589
> confint(fit, level = 0.99) # 99% CI
Warning: some standard errors are NA or infinite; intervals may be unreliable
                        0.5 %     99.5 %
alpha:(Intercept)  0.59541771  0.7432489
alpha:batch1       0.76938179  0.9068843
alpha:batch2       0.51773685  0.6647856
alpha:batch3       0.63692846  0.7836294
alpha:batch4       0.39804060  0.5354792
alpha:batch5       0.44710328  0.5934554
alpha:batch6       0.37632671  0.5232089
alpha:batch7       0.15618972  0.2933534
alpha:batch8       0.13031575  0.2760185
alpha:batch9       0.05970574  0.2240405
alpha:temp                NaN        NaN
beta:(Intercept)  27.77331987 29.9889546
> 
> # SECTION 7: Diagnostic Plots and Model Checking
> 
> fit <- gkwreg(yield ~ batch + temp, GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Example 7.1: All diagnostic plots (default)
> par(mfrow = c(3, 2))
> plot(fit, ask = FALSE)
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Example 7.2: Select specific plots
> par(mfrow = c(3, 1))
> plot(fit, which = c(2, 4, 5)) # Cook's distance, Residuals, Half-normal
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Example 7.3: Using ggplot2 for modern graphics
> plot(fit, use_ggplot = TRUE, arrange_plots = TRUE)
Simulating envelope ( 100 iterations): .......... Done!
Warning: Removed 1 row containing missing values or values outside the scale range
(`geom_segment()`).
> 
> # Example 7.4: Customized half-normal plot
> par(mfrow = c(1, 1))
> plot(fit,
+   which = 5,
+   type = "quantile",
+   nsim = 200, # More simulations for smoother envelope
+   level = 0.95
+ ) # 95% confidence envelope
Simulating envelope ( 200 iterations): .......... Done!
> 
> # Example 7.5: Extract diagnostic data programmatically
> diagnostics <- plot(fit, save_diagnostics = TRUE)
Simulating envelope ( 100 iterations): .......... Done!
> head(diagnostics$data) # Residuals, Cook's distance, etc.
  index y_obs    fitted    resid abs_resid  cook_dist  leverage  linpred
1     1 0.122 0.1110263 1.872237  1.872237 0.08621090 0.3877694 2.590378
2     2 0.223 0.2173790 1.872237  1.872237 0.08689243 0.3891166 2.960153
3     3 0.347 0.3528410 1.872237  1.872237 0.08664095 0.3886207 3.329928
4     4 0.457 0.4674384 1.872237  1.872237 0.08179665 0.3787881 3.657443
5     5 0.080 0.0716840 1.872237  1.872237 0.08537067 0.3860943 2.412179
6     6 0.131 0.1403505 1.872237  1.872237 0.09161626 0.3981830 2.702716
> 
> # SECTION 8: Real Data Example - Food Expenditure
> 
> # Load and prepare data
> data(FoodExpenditure, package = "betareg")
> food_data <- FoodExpenditure
> food_data$prop <- food_data$food / food_data$income
> 
> # Example 8.1: Basic model
> fit_food <- gkwreg(
+   prop ~ persons | income,
+   data = food_data,
+   family = "kw"
+ )
> summary(fit_food)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = prop ~ persons | income, data = food_data, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.1668 -0.0417  0.0098 -0.0047  0.0396  0.1527 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  1.26876    0.14206   8.931  < 2e-16 ***
alpha:persons      0.07210    0.01895   3.805 0.000142 ***
beta:(Intercept)   3.21312    0.63879   5.030  4.9e-07 ***
beta:income        0.03623    0.00922   3.930  8.5e-05 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                      3%    98%
alpha:(Intercept) 0.9903 1.5472
alpha:persons     0.0350 0.1092
beta:(Intercept)  1.9611 4.4651
beta:income       0.0182 0.0543

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 4.638
beta: 244.4
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 38 
Number of parameters: 4 
Residual degrees of freedom: 34 
Log-likelihood: 46.34 
AIC: -84.69 
BIC: -78.14 
RMSE: 0.07442 
Efron's R2: 0.4465 
Mean Absolute Error: 0.05784 

Convergence status: Successful 
Iterations: 18 

> 
> # Example 8.2: Compare with Beta regression
> fit_food_beta <- gkwreg(
+   prop ~ persons | income,
+   data = food_data,
+   family = "beta"
+ )
> 
> # Which fits better?
> AIC(fit_food, fit_food_beta)
              df       AIC
fit_food       4 -84.68830
fit_food_beta  4 -70.28298
> 
> # Example 8.3: Model diagnostics
> par(mfrow = c(3, 1))
> plot(fit_food, which = c(2, 5, 6))
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Example 8.4: Interpretation via effects
> # How does proportion spent on food change with income?
> income_seq <- seq(min(food_data$income), max(food_data$income), length = 50)
> pred_data <- data.frame(
+   persons = median(food_data$persons),
+   income = income_seq
+ )
> pred_food <- predict(fit_food, newdata = pred_data, type = "response")
> 
> par(mfrow = c(1, 1))
> plot(food_data$income, food_data$prop,
+   xlab = "Income", ylab = "Proportion Spent on Food",
+   main = "Food Expenditure Pattern"
+ )
> lines(income_seq, pred_food, col = "red", lwd = 2)
> 
> # SECTION 9: Simulation Studies
> 
> # Example 9.1: Simple Kumaraswamy simulation
> set.seed(123)
> n <- 500
> x1 <- runif(n, -2, 2)
> x2 <- rnorm(n)
> 
> # True model: log(alpha) = 0.8 + 0.3*x1, log(beta) = 1.2 - 0.2*x2
> eta_alpha <- 0.8 + 0.3 * x1
> eta_beta <- 1.2 - 0.2 * x2
> alpha_true <- exp(eta_alpha)
> beta_true <- exp(eta_beta)
> 
> # Generate response
> y <- rkw(n, alpha = alpha_true, beta = beta_true)
> sim_data <- data.frame(y = y, x1 = x1, x2 = x2)
> 
> # Fit and check parameter recovery
> fit_sim <- gkwreg(y ~ x1 | x2, data = sim_data, family = "kw")
> 
> # Compare estimated vs true coefficients
> cbind(
+   True = c(0.8, 0.3, 1.2, -0.2),
+   Estimated = coef(fit_sim),
+   SE = fit_sim$se
+ )
                  True  Estimated         SE
alpha:(Intercept)  0.8  0.8013394 0.04562729
alpha:x1           0.3  0.3011747 0.02418262
beta:(Intercept)   1.2  1.1896310 0.07482055
beta:x2           -0.2 -0.2419618 0.04607844
> 
> # Example 9.2: Complex simulation with all five parameters
> set.seed(2203)
> n <- 2000
> x <- runif(n, -1, 1)
> 
> # True parameters
> alpha <- exp(0.5 + 0.3 * x)
> beta <- exp(1.0 - 0.2 * x)
> gamma <- exp(0.7 + 0.4 * x)
> delta <- plogis(0.0 + 0.5 * x) # logit scale
> lambda <- exp(-0.3 + 0.2 * x)
> 
> # Generate from GKw
> y <- rgkw(n,
+   alpha = alpha, beta = beta, gamma = gamma,
+   delta = delta, lambda = lambda
+ )
> sim_data2 <- data.frame(y = y, x = x)
> 
> # Fit GKw model
> fit_gkw <- gkwreg(
+   y ~ x | x | x | x | x,
+   data = sim_data2,
+   family = "gkw",
+   control = gkw_control(method = "L-BFGS-B", maxit = 2000)
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_gkw)

Generalized Kumaraswamy Regression Model Summary

Family: gkw 

Call:
gkwreg(formula = y ~ x | x | x | x | x, data = sim_data2, family = "gkw", 
    control = gkw_control(method = "L-BFGS-B", maxit = 2000))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.4611 -0.1656 -0.0594 -0.0454  0.0650  0.6181 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)
alpha:(Intercept)    0.6486     1.1164   0.581    0.561
alpha:x              0.6769     0.7349   0.921    0.357
beta:(Intercept)    -0.1854        NaN     NaN      NaN
beta:x              -0.4238        NaN     NaN      NaN
gamma:(Intercept)    1.3684        NaN     NaN      NaN
gamma:x              1.2902        NaN     NaN      NaN
delta:(Intercept)   -0.5532        NaN     NaN      NaN
delta:x              0.6949        NaN     NaN      NaN
lambda:(Intercept)  -0.9061     1.3832  -0.655    0.512
lambda:x            -0.9115     1.2738  -0.716    0.474

Confidence intervals (95%):
                        3%    98%
alpha:(Intercept)  -1.5394 2.8366
alpha:x            -0.7636 2.1173
beta:(Intercept)       NaN    NaN
beta:x                 NaN    NaN
gamma:(Intercept)      NaN    NaN
gamma:x                NaN    NaN
delta:(Intercept)      NaN    NaN
delta:x                NaN    NaN
lambda:(Intercept) -3.6170 1.8049
lambda:x           -3.4081 1.5850

Link functions:
alpha: log
beta: log
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 2.045
beta: 0.8589
gamma: 5.02
delta: 3.683
lambda: 0.4654

Model fit statistics:
Number of observations: 2000 
Number of parameters: 10 
Residual degrees of freedom: 1990 
Log-likelihood: 860.6 
AIC: -1701 
BIC: -1645 
RMSE: 0.1749 
Efron's R2: 0.2997 
Mean Absolute Error: 0.1429 

Convergence status: Failed 
Iterations: 116 

> 
> # SECTION 10: Handling Convergence Issues
> 
> # Example 10.1: Try different optimizers
> methods <- c("nlminb", "BFGS", "Nelder-Mead", "CG")
> fits_methods <- lapply(methods, function(m) {
+   tryCatch(
+     gkwreg(yield ~ batch + temp, GasolineYield,
+       family = "kw",
+       control = gkw_control(method = m, silent = TRUE)
+     ),
+     error = function(e) NULL
+   )
+ })
Warning in sqrt(diag(cov)) : NaNs produced
Warning in sqrt(diag(cov)) : NaNs produced
> names(fits_methods) <- methods
> 
> # Check which converged
> converged <- sapply(fits_methods, function(f) {
+   if (is.null(f)) {
+     return(FALSE)
+   }
+   f$convergence
+ })
> print(converged)
     nlminb        BFGS Nelder-Mead          CG 
      FALSE        TRUE        TRUE       FALSE 
> 
> # Example 10.2: Verbose mode for debugging
> fit_debug <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   control = gkw_control(
+     method = "BFGS",
+     silent = TRUE,
+     trace = 0, # 2, Maximum verbosity
+     maxit = 1000
+   )
+ )
> 
> # SECTION 11: Memory and Performance Optimization
> 
> # Example 11.1: Minimal object for large datasets
> fit_minimal <- gkwreg(
+   yield ~ batch + temp,
+   data = GasolineYield,
+   family = "kw",
+   model = FALSE, # Don't store model frame
+   x = FALSE, # Don't store design matrices
+   y = FALSE, # Don't store response
+   control = gkw_control(hessian = FALSE) # Skip Hessian
+ )
> 
> # Much smaller object
> object.size(fit_minimal)
745256 bytes
> 
> # Trade-off: Limited post-fitting capabilities
> # Can still use: coef(), logLik(), AIC(), BIC()
> # Cannot use: predict(), some diagnostics
> 
> # Example 11.2: Fast exploratory analysis
> # Fit many models quickly without standard errors
> formulas <- list(
+   yield ~ batch,
+   yield ~ temp,
+   yield ~ batch + temp,
+   yield ~ batch * temp
+ )
> 
> fast_fits <- lapply(formulas, function(f) {
+   gkwreg(f, GasolineYield,
+     family = "kw",
+     control = gkw_control(hessian = FALSE),
+     model = FALSE, x = FALSE, y = FALSE
+   )
+ })
> 
> # Compare models via AIC
> sapply(fast_fits, AIC)
[1]  -42.93436  -74.90259 -169.93865 -292.55289
> 
> # Refit best model with full inference
> best_formula <- formulas[[which.min(sapply(fast_fits, AIC))]]
> fit_final <- gkwreg(best_formula, GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_final)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = best_formula, data = GasolineYield, family = "kw")

Residuals:
          Min        Q1.25%        Median          Mean        Q3.75% 
-1.030369e+22 -1.030369e+22 -1.030369e+22 -1.030369e+22 -1.030369e+22 
          Max 
-1.030369e+22 

Coefficients:
                    Estimate Std. Error  z value Pr(>|z|)    
alpha:(Intercept)  2.101e+00  4.024e-03    522.2   <2e-16 ***
alpha:batch1       1.255e-01        NaN      NaN      NaN    
alpha:batch2      -2.415e-01  9.235e-04   -261.5   <2e-16 ***
alpha:batch3      -3.067e-01  1.713e-03   -179.1   <2e-16 ***
alpha:batch4      -3.853e-01  3.984e-05  -9670.6   <2e-16 ***
alpha:batch5      -7.100e-01        NaN      NaN      NaN    
alpha:batch6      -2.994e-01  7.516e-05  -3983.1   <2e-16 ***
alpha:batch7      -6.844e-01  1.121e-04  -6104.4   <2e-16 ***
alpha:batch8      -9.483e-01  1.895e-04  -5004.7   <2e-16 ***
alpha:batch9      -3.894e-01  1.951e-05 -19954.5   <2e-16 ***
alpha:temp         2.980e-03        NaN      NaN      NaN    
alpha:batch1:temp  1.697e-03        NaN      NaN      NaN    
alpha:batch2:temp  2.170e-03        NaN      NaN      NaN    
alpha:batch3:temp  2.813e-03        NaN      NaN      NaN    
alpha:batch4:temp  2.174e-03        NaN      NaN      NaN    
alpha:batch5:temp  3.178e-03        NaN      NaN      NaN    
alpha:batch6:temp  1.894e-03        NaN      NaN      NaN    
alpha:batch7:temp  2.360e-03        NaN      NaN      NaN    
alpha:batch8:temp  3.080e-03        NaN      NaN      NaN    
alpha:batch9:temp  1.325e-03        NaN      NaN      NaN    
beta:(Intercept)   5.069e+01  1.326e-01    382.2   <2e-16 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  2.0934  2.1091
alpha:batch1          NaN     NaN
alpha:batch2      -0.2433 -0.2397
alpha:batch3      -0.3100 -0.3033
alpha:batch4      -0.3854 -0.3852
alpha:batch5          NaN     NaN
alpha:batch6      -0.2995 -0.2992
alpha:batch7      -0.6846 -0.6842
alpha:batch8      -0.9486 -0.9479
alpha:batch9      -0.3894 -0.3893
alpha:temp            NaN     NaN
alpha:batch1:temp     NaN     NaN
alpha:batch2:temp     NaN     NaN
alpha:batch3:temp     NaN     NaN
alpha:batch4:temp     NaN     NaN
alpha:batch5:temp     NaN     NaN
alpha:batch6:temp     NaN     NaN
alpha:batch7:temp     NaN     NaN
alpha:batch8:temp     NaN     NaN
alpha:batch9:temp     NaN     NaN
beta:(Intercept)  50.4279 50.9477

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 31.63
beta: 1.03e+22
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 32 
Number of parameters: 21 
Residual degrees of freedom: 11 
Log-likelihood: 167.3 
AIC: -292.6 
BIC: -261.8 
RMSE: 1.03e+22 
Efron's R2: -9.532e+45 
Mean Absolute Error: 1.03e+22 

Convergence status: Failed 
Iterations: 286 

> 
> # SECTION 12: Model Selection and Comparison
> 
> # Example 12.1: Nested model testing
> fit1 <- gkwreg(yield ~ 1, GasolineYield, family = "kw")
> fit2 <- gkwreg(yield ~ batch, GasolineYield, family = "kw")
> fit3 <- gkwreg(yield ~ batch + temp, GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Likelihood ratio tests
> anova(fit1, fit2, fit3)
Analysis of Deviance Table

Model 1: yield ~ 1
Model 2: yield ~ batch
Model 3: yield ~ batch + temp

     Resid. Df Resid. Dev Df  Deviance Pr(>Chi)    
fit1  30.00000  -57.02258                          
fit2  21.00000  -64.93436  9   7.91178  0.54306    
fit3  20.00000 -193.93865  1 129.00429  < 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 12.2: Information criteria table
> models <- list(
+   "Intercept only" = fit1,
+   "Batch effect" = fit2,
+   "Batch + Temp" = fit3
+ )
> 
> ic_table <- data.frame(
+   Model = names(models),
+   df = sapply(models, function(m) m$npar),
+   LogLik = sapply(models, logLik),
+   AIC = sapply(models, AIC),
+   BIC = sapply(models, BIC),
+   Delta_AIC = sapply(models, AIC) - min(sapply(models, AIC))
+ )
> print(ic_table)
                        Model df   LogLik        AIC        BIC Delta_AIC
Intercept only Intercept only  2 28.51129  -53.02258  -50.09111  116.9161
Batch effect     Batch effect 11 32.46718  -42.93436  -26.81126  127.0043
Batch + Temp     Batch + Temp 12 96.96932 -169.93865 -152.34982    0.0000
> 
> # Example 12.3: Cross-validation for predictive performance
> # 5-fold cross-validation
> set.seed(2203)
> n <- nrow(GasolineYield)
> folds <- sample(rep(1:5, length.out = n))
> 
> cv_rmse <- sapply(1:5, function(fold) {
+   train <- GasolineYield[folds != fold, ]
+   test <- GasolineYield[folds == fold, ]
+ 
+   fit_train <- gkwreg(yield ~ batch + temp, train,
+     family = "kw"
+   )
+   pred_test <- predict(fit_train, newdata = test, type = "response")
+ 
+   sqrt(mean((test$yield - pred_test)^2))
+ })
Warning in sqrt(diag(cov)) : NaNs produced
Warning in sqrt(diag(cov)) : NaNs produced
Warning in sqrt(diag(cov)) : NaNs produced
Warning in sqrt(diag(cov)) : NaNs produced
> 
> cat("Cross-validated RMSE:", mean(cv_rmse), "\n")
Cross-validated RMSE: 0.09025705 
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("logLik.gkwreg")
> ### * logLik.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: logLik.gkwreg
> ### Title: Extract Log-Likelihood from Generalized Kumaraswamy Regression
> ###   Models
> ### Aliases: logLik.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> # Load example data
> data(GasolineYield)
> 
> # Fit a Kumaraswamy regression model
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Extract log-likelihood
> ll <- logLik(fit)
> print(ll)
'log Lik.' 96.96932 (df=12)
> 
> # Access attributes
> cat("Log-likelihood:", as.numeric(ll), "\n")
Log-likelihood: 96.96932 
> cat("Parameters:", attr(ll, "df"), "\n")
Parameters: 12 
> cat("Observations:", attr(ll, "nobs"), "\n")
Observations: 32 
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("logLik.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("lrtest")
> ### * lrtest
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: lrtest
> ### Title: Likelihood Ratio Test for Nested GKw Models
> ### Aliases: lrtest
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> 
> # Fit nested models
> fit_restricted <- gkwreg(yield ~ temp, data = GasolineYield, family = "kw")
> fit_full <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Likelihood ratio test
> lrtest(fit_restricted, fit_full)

	Likelihood Ratio Test for Nested GKw Models

data:  fit_restricted vs fit_full
LRT = 113.04, df = 9, p-value < 2.2e-16

> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("lrtest", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("model.frame.gkwreg")
> ### * model.frame.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: model.frame.gkwreg
> ### Title: Extract Model Frame from GKw Regression Model
> ### Aliases: model.frame.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> head(model.frame(fit))
  yield batch temp
1 0.122     1  205
2 0.223     1  275
3 0.347     1  345
4 0.457     1  407
5 0.080     2  218
6 0.131     2  273
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("model.frame.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("model.matrix.gkwreg")
> ### * model.matrix.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: model.matrix.gkwreg
> ### Title: Extract Model Matrix from GKw Regression Model
> ### Aliases: model.matrix.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> head(model.matrix(fit))
  (Intercept) batch1 batch2 batch3 batch4 batch5 batch6 batch7 batch8 batch9
1           1      1      0      0      0      0      0      0      0      0
2           1      1      0      0      0      0      0      0      0      0
3           1      1      0      0      0      0      0      0      0      0
4           1      1      0      0      0      0      0      0      0      0
5           1      0      1      0      0      0      0      0      0      0
6           1      0      1      0      0      0      0      0      0      0
  temp
1  205
2  275
3  345
4  407
5  218
6  273
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("model.matrix.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("nobs.gkwreg")
> ### * nobs.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: nobs.gkwreg
> ### Title: Number of Observations for GKw Regression Models
> ### Aliases: nobs.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> nobs(fit)
[1] 32
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("nobs.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("plot.gkwreg")
> ### * plot.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: plot.gkwreg
> ### Title: Diagnostic Plots for Generalized Kumaraswamy Regression Models
> ### Aliases: plot.gkwreg
> ### Keywords: diagnostics hplot methods plot regression
> 
> ### ** Examples
> 
> ## No test: 
> # EXAMPLE 1: Basic Usage with Default Settings
> 
> # Simulate data
> library(gkwdist)
> 
> set.seed(123)
> n <- 200
> x1 <- runif(n, -2, 2)
> x2 <- rnorm(n)
> 
> # True model parameters
> alpha_true <- exp(0.7 + 0.3 * x1)
> beta_true <- exp(1.2 - 0.2 * x2)
> 
> # Generate response
> y <- rkw(n, alpha = alpha_true, beta = beta_true)
> df <- data.frame(y = y, x1 = x1, x2 = x2)
> 
> # Fit model
> model <- gkwreg(y ~ x1 | x2, data = df, family = "kw")
> 
> # Generate all diagnostic plots with defaults
> par(mfrow = c(3, 2))
> plot(model, ask = FALSE)
Simulating envelope ( 100 iterations): .......... Done!
> 
> # EXAMPLE 2: Selective Plots with Custom Residual Type
> 
> # Focus on key diagnostic plots only
> par(mfrow = c(3, 1))
> plot(model,
+   which = c(2, 4, 5), # Cook's distance, Resid vs LinPred, Half-normal
+   type = "pearson"
+ ) # Use Pearson residuals
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Check for influential points (plot 2) and non-linearity (plot 4)
> par(mfrow = c(2, 1))
> plot(model,
+   which = c(2, 4),
+   type = "deviance"
+ )
> 
> # EXAMPLE 3: Caption Customization - New Named List Interface
> 
> # Customize only specific plot titles (RECOMMENDED NEW WAY)
> par(mfrow = c(3, 1))
> plot(model,
+   which = c(1, 4, 6),
+   caption = list(
+     "1" = "Time Pattern Check",
+     "4" = "Linearity Assessment",
+     "6" = "Predictive Accuracy"
+   )
+ )
> 
> # Customize subtitle and main title
> par(mfrow = c(2, 1))
> plot(model,
+   which = c(1, 5),
+   main = "Model Diagnostics",
+   sub.caption = "Kumaraswamy Regression - Training Data",
+   caption = list("5" = "Normality Check with 95% Envelope")
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Suppress subtitle entirely
> par(mfrow = c(3, 2))
> plot(model, sub.caption = "")
Simulating envelope ( 100 iterations): .......... Done!
> 
> # EXAMPLE 4: Backward Compatible Caption (Vector Interface)
> 
> # OLD WAY - still fully supported
> par(mfrow = c(3, 2))
> plot(model,
+   which = 1:6,
+   caption = c(
+     "Residual Pattern Analysis",
+     "Influence Diagnostics",
+     "Leverage Assessment",
+     "Linearity Check",
+     "Distributional Fit",
+     "Prediction Quality"
+   )
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> # EXAMPLE 5: ggplot2 Graphics with Theming
> 
> # Modern publication-quality plots
> plot(model,
+   use_ggplot = TRUE,
+   arrange_plots = TRUE
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> # With custom theme
> plot(model,
+   use_ggplot = TRUE,
+   theme_fn = ggplot2::theme_bw,
+   arrange_plots = TRUE
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> # With classic theme and custom colors (via ...)
> plot(model,
+   use_ggplot = TRUE,
+   theme_fn = ggplot2::theme_classic,
+   arrange_plots = TRUE
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> # EXAMPLE 6: Arranged Multi-Panel ggplot2 Display
> 
> # Requires gridExtra or ggpubr package
> plot(model,
+   which = 1:4,
+   use_ggplot = TRUE,
+   arrange_plots = TRUE, # Arrange in grid
+   theme_fn = ggplot2::theme_minimal
+ )
> 
> # Focus plots in 2x2 grid
> plot(model,
+   which = c(2, 3, 4, 6),
+   use_ggplot = TRUE,
+   arrange_plots = TRUE,
+   caption = list(
+     "2" = "Influential Cases",
+     "3" = "High Leverage Points"
+   )
+ )
> 
> # EXAMPLE 7: Half-Normal Plot Customization
> 
> # Higher precision envelope (more simulations)
> par(mfrow = c(1, 2))
> plot(model,
+   which = 5,
+   nsim = 500, # More accurate envelope
+   level = 0.95
+ ) # 95% confidence level
Simulating envelope ( 500 iterations): .......... Done!
> 
> # Quick envelope for large datasets
> plot(model,
+   which = 5,
+   nsim = 500, # Faster computation
+   level = 0.90
+ )
Simulating envelope ( 500 iterations): .......... Done!
> 
> # EXAMPLE 8: Different Residual Types Comparison
> 
> # Compare different residual types
> par(mfrow = c(2, 2))
> plot(model, which = 4, type = "quantile", main = "Quantile")
> plot(model, which = 4, type = "pearson", main = "Pearson")
> plot(model, which = 4, type = "deviance", main = "Deviance")
> par(mfrow = c(1, 1))
> 
> # Quantile residuals for half-normal plot (recommended)
> plot(model, which = 5, type = "quantile")
Simulating envelope ( 100 iterations): .......... Done!
> 
> # EXAMPLE 9: Family Comparison Diagnostics
> 
> # Compare diagnostics under different distributional assumptions
> # Helps assess if alternative family would fit better
> par(mfrow = c(2, 2))
> plot(model,
+   which = c(5, 6),
+   family = "kw", # Original family
+   main = "Kumaraswamy"
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> plot(model,
+   which = c(5, 6),
+   family = "beta", # Alternative family
+   main = "Beta"
+ )
Using different family (beta) than what was used to fit the model (kw) for diagnostics.
Using different family (beta) than what was used to fit the model (kw). Recalculating fitted values...
Simulating envelope ( 100 iterations): .......... Done!
> par(mfrow = c(1, 1))
> 
> # EXAMPLE 10: Large Dataset - Performance Optimization
> 
> # Simulate large dataset
> set.seed(456)
> n_large <- 50000
> x1_large <- runif(n_large, -2, 2)
> x2_large <- rnorm(n_large)
> alpha_large <- exp(0.5 + 0.2 * x1_large)
> beta_large <- exp(1.0 - 0.1 * x2_large)
> y_large <- rkw(n_large, alpha = alpha_large, beta = beta_large)
> df_large <- data.frame(y = y_large, x1 = x1_large, x2 = x2_large)
> 
> model_large <- gkwreg(y ~ x1 | x2, data = df_large, family = "kw")
> 
> # Optimized plotting for large dataset
> par(mfrow = c(2, 2), mar = c(3, 3, 2, 2))
> plot(model_large,
+   which = c(1, 2, 4, 6), # Skip computationally intensive plot 5
+   sample_size = 2000, # Use random sample of 2000 observations
+   ask = FALSE
+ ) # Don't prompt
> 
> # If half-normal plot needed, reduce simulations
> par(mfrow = c(1, 1))
> plot(model_large,
+   which = 5,
+   sample_size = 1000, # Smaller sample
+   nsim = 50
+ ) # Fewer simulations
Simulating envelope ( 50 iterations): .......... Done!
> 
> # EXAMPLE 11: Saving Diagnostic Data for Custom Analysis
> 
> # Extract diagnostic measures without plotting
> par(mfrow = c(1, 1))
> diag_data <- plot(model_large,
+   which = 1:6,
+   save_diagnostics = TRUE
+ )
Simulating envelope ( 100 iterations): .......... Done!
> 
> # Examine structure
> str(diag_data)
List of 3
 $ data       :'data.frame':	50000 obs. of  8 variables:
  ..$ index    : int [1:50000] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ y_obs    : num [1:50000] 0.185 0.272 0.771 0.135 0.833 ...
  ..$ fitted   : num [1:50000] 0.329 0.352 0.472 0.506 0.498 ...
  ..$ resid    : num [1:50000] -0.45 -0.196 1.363 -1.821 1.697 ...
  ..$ abs_resid: num [1:50000] 0.45 0.196 1.363 1.821 1.697 ...
  ..$ cook_dist: num [1:50000] 3.66e-04 6.51e-05 1.08e-02 3.33e-03 9.21e-03 ...
  ..$ leverage : num [1:50000] 0.00716 0.00669 0.02227 0.00401 0.01253 ...
  ..$ linpred  : num [1:50000] 0.165 0.262 0.681 0.776 0.725 ...
 $ model_info :List of 8
  ..$ n                 : int 50000
  ..$ p                 : num 4
  ..$ cook_threshold    : num 8e-05
  ..$ leverage_threshold: num 0.00016
  ..$ family            : chr "kw"
  ..$ type              : chr "quantile"
  ..$ param_info        :List of 4
  .. ..$ names    : chr [1:2] "alpha" "beta"
  .. ..$ n        : num 2
  .. ..$ fixed    :List of 3
  .. .. ..$ gamma : num 1
  .. .. ..$ delta : num 0
  .. .. ..$ lambda: num 1
  .. ..$ positions:List of 2
  .. .. ..$ alpha: num 1
  .. .. ..$ beta : num 2
  ..$ level             : num 0.9
 $ half_normal:'data.frame':	50000 obs. of  5 variables:
  ..$ index      : int [1:50000] 1 2 3 4 5 6 7 8 9 10 ...
  ..$ theoretical: num [1:50000] 1.25e-05 3.76e-05 6.27e-05 8.77e-05 1.13e-04 ...
  ..$ observed   : num [1:50000] 3.04e-05 3.62e-05 7.93e-05 9.25e-05 1.07e-04 ...
  ..$ lower      : num [1:50000] 7.54e-07 8.56e-06 1.97e-05 3.05e-05 4.20e-05 ...
  ..$ upper      : num [1:50000] 6.62e-05 1.18e-04 1.43e-04 1.70e-04 2.02e-04 ...
> 
> # Access diagnostic measures
> head(diag_data$data) # Residuals, Cook's distance, leverage, etc.
  index     y_obs    fitted      resid abs_resid    cook_dist    leverage
1     1 0.1850315 0.3293218 -0.4500848 0.4500848 3.660713e-04 0.007162107
2     2 0.2724554 0.3517257 -0.1964963 0.1964963 6.513023e-05 0.006691892
3     3 0.7706749 0.4715884  1.3630349 1.3630349 1.076532e-02 0.022271859
4     4 0.1350742 0.5059801 -1.8211089 1.8211089 3.331286e-03 0.004006455
5     5 0.8325809 0.4979620  1.6974135 1.6974135 9.205032e-03 0.012525889
6     6 0.4941673 0.3895391  0.5363847 0.5363847 8.755918e-04 0.011945865
    linpred
1 0.1652265
2 0.2621458
3 0.6807510
4 0.7762421
5 0.7251742
6 0.3594552
> 
> # Identify influential observations
> influential <- which(diag_data$data$cook_dist > diag_data$model_info$cook_threshold)
> cat("Influential observations:", head(influential), "\n")
Influential observations: 1 3 4 5 6 7 
> 
> # High leverage points
> high_lev <- which(diag_data$data$leverage > diag_data$model_info$leverage_threshold)
> cat("High leverage points:", head(high_lev), "\n")
High leverage points: 1 2 3 4 5 6 
> 
> # Custom diagnostic plot using saved data
> plot(diag_data$data$fitted, diag_data$data$resid,
+   xlab = "Fitted Values", ylab = "Residuals",
+   main = "Custom Diagnostic Plot",
+   col = ifelse(diag_data$data$cook_dist >
+     diag_data$model_info$cook_threshold, "red", "black"),
+   pch = 16
+ )
> abline(h = 0, col = "gray", lty = 2)
> legend("topright", legend = "Influential", col = "red", pch = 16)
> 
> # EXAMPLE 12: Interactive Plotting Control
> 
> # ask = TRUE Force prompting between plots (useful for presentations)
> # Disable prompting (batch processing)
> par(mfrow = c(3, 2))
> plot(model,
+   which = 1:6,
+   ask = FALSE
+ ) # Never prompts
Simulating envelope ( 100 iterations): .......... Done!
> 
> # EXAMPLE 13: Base R Graphics Customization via ...
> 
> # Customize point appearance
> par(mfrow = c(2, 2))
> plot(model,
+   which = c(1, 4, 6),
+   pch = 16, # Filled circles
+   col = "steelblue", # Blue points
+   cex = 0.8
+ ) # Smaller points
> 
> # Multiple customizations
> plot(model,
+   which = 2,
+   pch = 21, # Circles with border
+   col = "black", # Border color
+   bg = "lightblue", # Fill color
+   cex = 1.2, # Larger points
+   lwd = 2
+ ) # Thicker lines
> 
> # EXAMPLE 14: Comparing Models
> 
> # Fit competing models
> model_kw <- gkwreg(y ~ x1 | x2, data = df, family = "kw")
> model_beta <- gkwreg(y ~ x1 | x2, data = df, family = "beta")
> 
> # Compare diagnostics side-by-side
> par(mfrow = c(2, 2))
> 
> # Kumaraswamy model
> plot(model_kw, which = 5, main = "Kumaraswamy - Half-Normal")
Simulating envelope ( 100 iterations): .......... Done!
> plot(model_kw, which = 6, main = "Kumaraswamy - Pred vs Obs")
> 
> # Beta model
> plot(model_beta, which = 5, main = "Beta - Half-Normal")
Simulating envelope ( 100 iterations): .......... Done!
> plot(model_beta, which = 6, main = "Beta - Pred vs Obs")
> 
> par(mfrow = c(1, 1))
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("plot.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("predict.gkwreg")
> ### * predict.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: predict.gkwreg
> ### Title: Predictions from a Fitted Generalized Kumaraswamy Regression
> ###   Model
> ### Aliases: predict.gkwreg
> ### Keywords: models predict regression
> 
> ### ** Examples
> 
> ## No test: 
> # Generate a sample dataset (n = 1000)
> library(gkwdist)
> set.seed(123)
> n <- 1000
> 
> # Create predictors
> x1 <- runif(n, -2, 2)
> x2 <- rnorm(n)
> x3 <- factor(rbinom(n, 1, 0.4))
> 
> # Simulate Kumaraswamy distributed data
> # True parameters with specific relationships to predictors
> true_alpha <- exp(0.7 + 0.3 * x1)
> true_beta <- exp(1.2 - 0.2 * x2 + 0.4 * (x3 == "1"))
> 
> # Generate random responses
> y <- rkw(n, alpha = true_alpha, beta = true_beta)
> 
> # Ensure responses are strictly in (0, 1)
> y <- pmax(pmin(y, 1 - 1e-7), 1e-7)
> 
> # Create data frame
> df <- data.frame(y = y, x1 = x1, x2 = x2, x3 = x3)
> 
> # Split into training and test sets
> set.seed(456)
> train_idx <- sample(n, 800)
> train_data <- df[train_idx, ]
> test_data <- df[-train_idx, ]
> 
> # ====================================================================
> # Example 1: Basic usage - Fit a Kumaraswamy model and make predictions
> # ====================================================================
> 
> # Fit the model
> kw_model <- gkwreg(y ~ x1 | x2 + x3, data = train_data, family = "kw")
> 
> # Predict mean response for test data
> pred_mean <- predict(kw_model, newdata = test_data, type = "response")
> 
> # Calculate prediction error
> mse <- mean((test_data$y - pred_mean)^2)
> cat("Mean Squared Error:", mse, "\n")
Mean Squared Error: 0.02982227 
> 
> # ====================================================================
> # Example 2: Different prediction types
> # ====================================================================
> 
> # Create a grid of values for visualization
> x1_grid <- seq(-2, 2, length.out = 100)
> grid_data <- data.frame(x1 = x1_grid, x2 = 0, x3 = 0)
> 
> # Predict different quantities
> pred_mean <- predict(kw_model, newdata = grid_data, type = "response")
> pred_var <- predict(kw_model, newdata = grid_data, type = "variance")
> pred_params <- predict(kw_model, newdata = grid_data, type = "parameter")
> pred_alpha <- predict(kw_model, newdata = grid_data, type = "alpha")
> pred_beta <- predict(kw_model, newdata = grid_data, type = "beta")
> 
> # Plot predicted mean and parameters against x1
> plot(x1_grid, pred_mean,
+   type = "l", col = "blue",
+   xlab = "x1", ylab = "Predicted Mean", main = "Mean Response vs x1"
+ )
> plot(x1_grid, pred_var,
+   type = "l", col = "red",
+   xlab = "x1", ylab = "Predicted Variance", main = "Response Variance vs x1"
+ )
> plot(x1_grid, pred_alpha,
+   type = "l", col = "purple",
+   xlab = "x1", ylab = "Alpha", main = "Alpha Parameter vs x1"
+ )
> plot(x1_grid, pred_beta,
+   type = "l", col = "green",
+   xlab = "x1", ylab = "Beta", main = "Beta Parameter vs x1"
+ )
> 
> # ====================================================================
> # Example 3: Computing densities, CDFs, and quantiles
> # ====================================================================
> 
> # Select a single observation
> obs_data <- test_data[1, ]
> 
> # Create a sequence of y values for plotting
> y_seq <- seq(0.01, 0.99, length.out = 100)
> 
> # Compute density at each y value
> dens_values <- predict(kw_model,
+   newdata = obs_data,
+   type = "density", at = y_seq, elementwise = FALSE
+ )
> 
> # Compute CDF at each y value
> cdf_values <- predict(kw_model,
+   newdata = obs_data,
+   type = "probability", at = y_seq, elementwise = FALSE
+ )
> 
> # Compute quantiles for a sequence of probabilities
> prob_seq <- seq(0.1, 0.9, by = 0.1)
> quant_values <- predict(kw_model,
+   newdata = obs_data,
+   type = "quantile", at = prob_seq, elementwise = FALSE
+ )
> 
> # Plot density and CDF
> plot(y_seq, dens_values,
+   type = "l", col = "blue",
+   xlab = "y", ylab = "Density", main = "Predicted PDF"
+ )
> plot(y_seq, cdf_values,
+   type = "l", col = "red",
+   xlab = "y", ylab = "Cumulative Probability", main = "Predicted CDF"
+ )
> 
> # ====================================================================
> # Example 4: Prediction under different distributional assumptions
> # ====================================================================
> 
> # Fit models with different families
> beta_model <- gkwreg(y ~ x1 | x2 + x3, data = train_data, family = "beta")
> gkw_model <- gkwreg(y ~ x1 | x2 + x3 | 1 | 1 | x3, data = train_data, family = "gkw")
> 
> # Predict means using different families
> pred_kw <- predict(kw_model, newdata = test_data, type = "response")
> pred_beta <- predict(beta_model, newdata = test_data, type = "response")
> pred_gkw <- predict(gkw_model, newdata = test_data, type = "response")
> 
> # Calculate MSE for each family
> mse_kw <- mean((test_data$y - pred_kw)^2)
> mse_beta <- mean((test_data$y - pred_beta)^2)
> mse_gkw <- mean((test_data$y - pred_gkw)^2)
> 
> cat("MSE by family:\n")
MSE by family:
> cat("Kumaraswamy:", mse_kw, "\n")
Kumaraswamy: 0.02982227 
> cat("Beta:", mse_beta, "\n")
Beta: 0.06684878 
> cat("GKw:", mse_gkw, "\n")
GKw: 0.03221942 
> 
> # Compare predictions from different families visually
> plot(test_data$y, pred_kw,
+   col = "blue", pch = 16,
+   xlab = "Observed", ylab = "Predicted", main = "Predicted vs Observed"
+ )
> points(test_data$y, pred_beta, col = "red", pch = 17)
> points(test_data$y, pred_gkw, col = "green", pch = 18)
> abline(0, 1, lty = 2)
> legend("topleft",
+   legend = c("Kumaraswamy", "Beta", "GKw"),
+   col = c("blue", "red", "green"), pch = c(16, 17, 18)
+ )
> 
> # ====================================================================
> # Example 5: Working with linear predictors and link functions
> # ====================================================================
> 
> # Extract linear predictors and parameter values
> lp <- predict(kw_model, newdata = test_data, type = "link")
> params <- predict(kw_model, newdata = test_data, type = "parameter")
> 
> # Verify that inverse link transformation works correctly
> # For Kumaraswamy model, alpha and beta use log links by default
> alpha_from_lp <- exp(lp$alpha)
> beta_from_lp <- exp(lp$beta)
> 
> # Compare with direct parameter predictions
> cat("Manual inverse link vs direct parameter prediction:\n")
Manual inverse link vs direct parameter prediction:
> cat("Alpha difference:", max(abs(alpha_from_lp - params$alpha)), "\n")
Alpha difference: 0 
> cat("Beta difference:", max(abs(beta_from_lp - params$beta)), "\n")
Beta difference: 0 
> 
> # ====================================================================
> # Example 6: Elementwise calculations
> # ====================================================================
> 
> # Generate probabilities specific to each observation
> probs <- runif(nrow(test_data), 0.1, 0.9)
> 
> # Calculate quantiles for each observation at its own probability level
> quant_elementwise <- predict(kw_model,
+   newdata = test_data,
+   type = "quantile", at = probs, elementwise = TRUE
+ )
> 
> # Calculate probabilities at each observation's actual value
> prob_at_y <- predict(kw_model,
+   newdata = test_data,
+   type = "probability", at = test_data$y, elementwise = TRUE
+ )
> 
> # Create Q-Q plot
> plot(sort(prob_at_y), seq(0, 1, length.out = length(prob_at_y)),
+   xlab = "Empirical Probability", ylab = "Theoretical Probability",
+   main = "P-P Plot", type = "l"
+ )
> abline(0, 1, lty = 2, col = "red")
> 
> # ====================================================================
> # Example 7: Predicting for the original data
> # ====================================================================
> 
> # Fit a model with original data
> full_model <- gkwreg(y ~ x1 + x2 + x3 | x1 + x2 + x3, data = df, family = "kw")
> 
> # Get fitted values using predict and compare with model's fitted.values
> fitted_from_predict <- predict(full_model, type = "response")
> fitted_from_model <- full_model$fitted.values
> 
> # Compare results
> cat(
+   "Max difference between predict() and fitted.values:",
+   max(abs(fitted_from_predict - fitted_from_model)), "\n"
+ )
Max difference between predict() and fitted.values: 0 
> 
> # ====================================================================
> # Example 8: Handling missing data
> # ====================================================================
> 
> # Create test data with some missing values
> test_missing <- test_data
> test_missing$x1[1:5] <- NA
> test_missing$x2[6:10] <- NA
> 
> # Predict with different na.action options
> pred_na_pass <- tryCatch(
+   predict(kw_model, newdata = test_missing, na.action = na.pass),
+   error = function(e) rep(NA, nrow(test_missing))
+ )
> pred_na_omit <- tryCatch(
+   predict(kw_model, newdata = test_missing, na.action = na.omit),
+   error = function(e) rep(NA, nrow(test_missing))
+ )
> 
> # Show which positions have NAs
> cat("Rows with missing predictors:", which(is.na(pred_na_pass)), "\n")
Rows with missing predictors:  
> cat("Length after na.omit:", length(pred_na_omit), "\n")
Length after na.omit: 195 
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("predict.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("print.gkwreg")
> ### * print.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: print.gkwreg
> ### Title: Print Method for Generalized Kumaraswamy Regression Models
> ### Aliases: print.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> print(fit)

Call:  gkwreg(formula = yield ~ batch + temp, data = GasolineYield, 
    family = "kw")

Deviance Residuals: 
      Min        1Q    Median        3Q       Max 
-0.030691 -0.007432  0.003587  0.008642  0.017537 

Coefficients:
alpha:(Intercept)      alpha:batch1      alpha:batch2      alpha:batch3 
         0.669333          0.838133          0.591261          0.710279 
     alpha:batch4      alpha:batch5      alpha:batch6      alpha:batch7 
         0.466760          0.520279          0.449768          0.224772 
     alpha:batch8      alpha:batch9        alpha:temp  beta:(Intercept) 
         0.203167          0.141873          0.005282         28.881137 

Link functions:  alpha = log, beta = log

Degrees of Freedom: 31 Total (i.e. Null);  20 Residual
Residual Deviance: -193.9	AIC: -169.9
Log-Lik: 96.97,  BIC: -152.3 
R-squared: 0.985,  RMSE: 0.01292 

Number of Fisher Scoring iterations: 77

> 
> # With more digits
> print(fit, digits = 5)

Call:  gkwreg(formula = yield ~ batch + temp, data = GasolineYield, 
    family = "kw")

Deviance Residuals: 
       Min         1Q     Median         3Q        Max 
-0.0306910 -0.0074323  0.0035873  0.0086417  0.0175366 

Coefficients:
alpha:(Intercept)      alpha:batch1      alpha:batch2      alpha:batch3 
        0.6693333         0.8381330         0.5912612         0.7102789 
     alpha:batch4      alpha:batch5      alpha:batch6      alpha:batch7 
        0.4667599         0.5202794         0.4497678         0.2247716 
     alpha:batch8      alpha:batch9        alpha:temp  beta:(Intercept) 
        0.2031671         0.1418731         0.0052825        28.8811373 

Link functions:  alpha = log, beta = log

Degrees of Freedom: 31 Total (i.e. Null);  20 Residual
Residual Deviance: -193.94	AIC: -169.94
Log-Lik: 96.969,  BIC: -152.35 
R-squared: 0.98502,  RMSE: 0.012917 

Number of Fisher Scoring iterations: 77

> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("print.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("residuals.gkwreg")
> ### * residuals.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: residuals.gkwreg
> ### Title: Extract Residuals from a Generalized Kumaraswamy Regression
> ###   Model
> ### Aliases: residuals.gkwreg
> ### Keywords: diagnostics methods regression residuals
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> # Example 1: Comprehensive residual analysis for FoodExpenditure
> data(FoodExpenditure)
> FoodExpenditure$prop <- FoodExpenditure$food / FoodExpenditure$income
> 
> fit_kw <- gkwreg(
+   prop ~ income + persons | income + persons,
+   data = FoodExpenditure,
+   family = "kw"
+ )
> 
> # Extract different types of residuals
> res_response <- residuals(fit_kw, type = "response")
> res_pearson <- residuals(fit_kw, type = "pearson")
> res_deviance <- residuals(fit_kw, type = "deviance")
> res_quantile <- residuals(fit_kw, type = "quantile")
> res_coxsnell <- residuals(fit_kw, type = "cox-snell")
> 
> # Summary statistics
> residual_summary <- data.frame(
+   Type = c("Response", "Pearson", "Deviance", "Quantile", "Cox-Snell"),
+   Mean = c(
+     mean(res_response), mean(res_pearson),
+     mean(res_deviance), mean(res_quantile),
+     mean(res_coxsnell)
+   ),
+   SD = c(
+     sd(res_response), sd(res_pearson),
+     sd(res_deviance), sd(res_quantile),
+     sd(res_coxsnell)
+   ),
+   Min = c(
+     min(res_response), min(res_pearson),
+     min(res_deviance), min(res_quantile),
+     min(res_coxsnell)
+   ),
+   Max = c(
+     max(res_response), max(res_pearson),
+     max(res_deviance), max(res_quantile),
+     max(res_coxsnell)
+   )
+ )
> print(residual_summary)
       Type          Mean         SD          Min       Max
1  Response  0.0001978698 0.07082919 -0.173565885 0.1546289
2   Pearson -0.0026568658 2.43575359 -6.277680405 5.7524149
3  Deviance  0.2017937920 1.71709988 -2.169734396 2.1909681
4  Quantile -0.0052189130 1.02816180 -2.448661750 2.5380310
5 Cox-Snell  0.9964306145 0.97984715  0.007195225 5.1896594
> 
> # Example 2: Diagnostic plots for model assessment
> data(GasolineYield)
> 
> fit_ekw <- gkwreg(
+   yield ~ batch + temp | temp | batch,
+   data = GasolineYield,
+   family = "ekw"
+ )
> 
> # Set up plotting grid
> par(mfrow = c(2, 3))
> 
> # Plot 1: Residuals vs Fitted
> fitted_vals <- fitted(fit_ekw)
> res_pears <- residuals(fit_ekw, type = "pearson")
> plot(fitted_vals, res_pears,
+   xlab = "Fitted Values", ylab = "Pearson Residuals",
+   main = "Residuals vs Fitted",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> abline(h = 0, col = "red", lwd = 2, lty = 2)
> lines(lowess(fitted_vals, res_pears), col = "blue", lwd = 2)
> 
> # Plot 2: Normal QQ-plot (Quantile Residuals)
> res_quant <- residuals(fit_ekw, type = "quantile")
> qqnorm(res_quant,
+   main = "Normal Q-Q Plot (Quantile Residuals)",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> qqline(res_quant, col = "red", lwd = 2)
> 
> # Plot 3: Scale-Location (sqrt of standardized residuals)
> plot(fitted_vals, sqrt(abs(res_pears)),
+   xlab = "Fitted Values", ylab = expression(sqrt("|Std. Residuals|")),
+   main = "Scale-Location",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> lines(lowess(fitted_vals, sqrt(abs(res_pears))), col = "red", lwd = 2)
> 
> # Plot 4: Histogram of Quantile Residuals
> hist(res_quant,
+   breaks = 15, probability = TRUE,
+   xlab = "Quantile Residuals",
+   main = "Histogram with Normal Overlay",
+   col = "lightblue", border = "white"
+ )
> curve(dnorm(x, mean(res_quant), sd(res_quant)),
+   add = TRUE, col = "red", lwd = 2
+ )
> 
> # Plot 5: Cox-Snell Residual Plot
> res_cs <- residuals(fit_ekw, type = "cox-snell")
> plot(qexp(ppoints(length(res_cs))), sort(res_cs),
+   xlab = "Theoretical Exponential Quantiles",
+   ylab = "Ordered Cox-Snell Residuals",
+   main = "Cox-Snell Residual Plot",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> abline(0, 1, col = "red", lwd = 2)
> 
> # Plot 6: Residuals vs Index
> plot(seq_along(res_pears), res_pears,
+   xlab = "Observation Index", ylab = "Pearson Residuals",
+   main = "Residuals vs Index",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> abline(h = 0, col = "red", lwd = 2, lty = 2)
> 
> par(mfrow = c(1, 1))
> 
> # Example 3: Partial residual plots for covariate effects
> data(ReadingSkills)
> 
> fit_interact <- gkwreg(
+   accuracy ~ dyslexia * iq | dyslexia + iq,
+   data = ReadingSkills,
+   family = "kw"
+ )
> 
> # Partial residuals for IQ effect on alpha parameter
> X_alpha <- fit_interact$model_matrices$alpha
> iq_col_alpha <- which(colnames(X_alpha) == "iq")
> 
> if (length(iq_col_alpha) > 0) {
+   res_partial_alpha <- residuals(fit_interact,
+     type = "partial",
+     parameter = "alpha",
+     covariate_idx = iq_col_alpha
+   )
+ 
+   par(mfrow = c(1, 2))
+ 
+   # Partial residual plot for alpha
+   plot(ReadingSkills$iq, res_partial_alpha,
+     xlab = "IQ (z-scores)",
+     ylab = "Partial Residual (alpha)",
+     main = "Effect of IQ on Mean (alpha)",
+     pch = 19, col = ReadingSkills$dyslexia
+   )
+   lines(lowess(ReadingSkills$iq, res_partial_alpha),
+     col = "blue", lwd = 2
+   )
+   legend("topleft",
+     legend = c("Control", "Dyslexic"),
+     col = c("black", "red"), pch = 19
+   )
+ 
+   # Partial residuals for IQ effect on beta parameter
+   X_beta <- fit_interact$model_matrices$beta
+   iq_col_beta <- which(colnames(X_beta) == "iq")
+ 
+   if (length(iq_col_beta) > 0) {
+     res_partial_beta <- residuals(fit_interact,
+       type = "partial",
+       parameter = "beta",
+       covariate_idx = iq_col_beta
+     )
+ 
+     plot(ReadingSkills$iq, res_partial_beta,
+       xlab = "IQ (z-scores)",
+       ylab = "Partial Residual (beta)",
+       main = "Effect of IQ on Precision (beta)",
+       pch = 19, col = ReadingSkills$dyslexia
+     )
+     lines(lowess(ReadingSkills$iq, res_partial_beta),
+       col = "blue", lwd = 2
+     )
+   }
+ 
+   par(mfrow = c(1, 1))
+ }
> 
> # Example 4: Comparing residuals across different families
> data(StressAnxiety)
> 
> fit_kw_stress <- gkwreg(
+   anxiety ~ stress | stress,
+   data = StressAnxiety,
+   family = "kw"
+ )
> 
> # Quantile residuals under different family assumptions
> res_quant_kw <- residuals(fit_kw_stress, type = "quantile", family = "kw")
> res_quant_beta <- residuals(fit_kw_stress, type = "quantile", family = "beta")
Using different family (beta) than what was used to fit the model (kw).
Using different family (beta) than what was used to fit the model (kw). Recalculating fitted values...
> 
> # Compare normality
> par(mfrow = c(1, 2))
> 
> qqnorm(res_quant_kw,
+   main = "QQ-Plot: Kumaraswamy Residuals",
+   pch = 19, col = rgb(0, 0, 1, 0.5)
+ )
> qqline(res_quant_kw, col = "red", lwd = 2)
> 
> qqnorm(res_quant_beta,
+   main = "QQ-Plot: Beta Residuals",
+   pch = 19, col = rgb(0, 0.5, 0, 0.5)
+ )
> qqline(res_quant_beta, col = "red", lwd = 2)
> 
> par(mfrow = c(1, 1))
> 
> # Formal normality tests
> shapiro_kw <- shapiro.test(res_quant_kw)
> shapiro_beta <- shapiro.test(res_quant_beta)
> 
> cat("\nShapiro-Wilk Test Results:\n")

Shapiro-Wilk Test Results:
> cat(
+   "Kumaraswamy:  W =", round(shapiro_kw$statistic, 4),
+   ", p-value =", round(shapiro_kw$p.value, 4), "\n"
+ )
Kumaraswamy:  W = 0.9638 , p-value = 3e-04 
> cat(
+   "Beta:         W =", round(shapiro_beta$statistic, 4),
+   ", p-value =", round(shapiro_beta$p.value, 4), "\n"
+ )
Beta:         W = 0.811 , p-value = 0 
> 
> # Example 5: Outlier detection using standardized residuals
> data(MockJurors)
> 
> fit_mc <- gkwreg(
+   confidence ~ verdict * conflict | verdict + conflict,
+   data = MockJurors,
+   family = "mc"
+ )
> 
> res_dev <- residuals(fit_mc, type = "deviance")
> res_quant <- residuals(fit_mc, type = "quantile")
> 
> # Identify potential outliers (|z| > 2.5)
> outlier_idx <- which(abs(res_quant) > 2.5)
> 
> if (length(outlier_idx) > 0) {
+   cat("\nPotential outliers detected at indices:", outlier_idx, "\n")
+ 
+   # Display outlier information
+   outlier_data <- data.frame(
+     Index = outlier_idx,
+     Confidence = MockJurors$confidence[outlier_idx],
+     Verdict = MockJurors$verdict[outlier_idx],
+     Conflict = MockJurors$conflict[outlier_idx],
+     Quantile_Residual = round(res_quant[outlier_idx], 3),
+     Deviance_Residual = round(res_dev[outlier_idx], 3)
+   )
+   print(outlier_data)
+ 
+   # Influence plot
+   plot(seq_along(res_quant), res_quant,
+     xlab = "Observation Index",
+     ylab = "Quantile Residual",
+     main = "Outlier Detection: Mock Jurors",
+     pch = 19, col = rgb(0, 0, 1, 0.5)
+   )
+   points(outlier_idx, res_quant[outlier_idx],
+     col = "red", pch = 19, cex = 1.5
+   )
+   abline(
+     h = c(-2.5, 0, 2.5), col = c("orange", "black", "orange"),
+     lty = c(2, 1, 2), lwd = 2
+   )
+   legend("topright",
+     legend = c("Normal", "Outlier", "±2.5 SD"),
+     col = c(rgb(0, 0, 1, 0.5), "red", "orange"),
+     pch = c(19, 19, NA),
+     lty = c(NA, NA, 2),
+     lwd = c(NA, NA, 2)
+   )
+ } else {
+   cat("\nNo extreme outliers detected (|z| > 2.5)\n")
+ }

Potential outliers detected at indices: 21 23 39 44 54 
  Index Confidence      Verdict Conflict Quantile_Residual Deviance_Residual
1    21      0.995   two-option      yes             2.609             0.588
2    23      0.995   two-option      yes             2.609             0.588
3    39      0.005 three-option      yes            -3.052        141421.356
4    44      0.005 three-option      yes            -3.052        141421.356
5    54      0.995   two-option       no             2.641             0.288
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("residuals.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> graphics::par(get("par.postscript", pos = 'CheckExEnv'))
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("response")
> ### * response
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: response
> ### Title: Extract Response Variable from GKw Regression Model
> ### Aliases: response response.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> y <- response(fit)
> head(y)
    1     2     3     4     5     6 
0.122 0.223 0.347 0.457 0.080 0.131 
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("response", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("retinal")
> ### * retinal
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: retinal
> ### Title: Intraocular Gas Decay in Retinal Surgery
> ### Aliases: retinal
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(retinal)
> 
> # Example 1: Nonlinear time decay with level effects
> # Model gas decay as quadratic function of log-time
> # Allow precision to vary by initial gas concentration
> fit_kw <- gkwreg(
+   Gas ~ LogT + LogT2 + Level |
+     Level,
+   data = retinal,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = Gas ~ LogT + LogT2 + Level | Level, data = retinal, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.5665 -0.2076  0.0087 -0.0436  0.0971  0.4073 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  1.69138    0.22256   7.600 2.97e-14 ***
alpha:LogT        -0.25598    0.25054  -1.022  0.30693    
alpha:LogT2       -0.12019    0.06061  -1.983  0.04737 *  
alpha:Level        0.51892    0.15828   3.279  0.00104 ** 
beta:(Intercept)  -0.40918    0.09481  -4.316 1.59e-05 ***
beta:Level         0.08475    0.13199   0.642  0.52084    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  1.2552  2.1276
alpha:LogT        -0.7470  0.2351
alpha:LogT2       -0.2390 -0.0014
alpha:Level        0.2087  0.8291
beta:(Intercept)  -0.5950 -0.2233
beta:Level        -0.1740  0.3434

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 2.672
beta: 0.6776
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 181 
Number of parameters: 6 
Residual degrees of freedom: 175 
Log-likelihood: 103.7 
AIC: -195.4 
BIC: -176.2 
RMSE: 0.2194 
Efron's R2: 0.4994 
Mean Absolute Error: 0.177 

Convergence status: Successful 
Iterations: 21 

> 
> # Interpretation:
> # - Alpha: Decay curve shape varies by initial gas concentration
> #   LogT + LogT2 capture nonlinear exponential-like decay
> # - Beta: Precision differs by concentration level
> #   Higher concentration may produce more/less variable decay
> 
> # Example 2: Heteroscedastic model
> # Variability in gas proportion may change over time
> fit_kw_hetero <- gkwreg(
+   Gas ~ LogT + LogT2 + Level |
+     Level + LogT,
+   data = retinal,
+   family = "kw"
+ )
> summary(fit_kw_hetero)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = Gas ~ LogT + LogT2 + Level | Level + LogT, data = retinal, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.5261 -0.1223  0.0192 -0.0081  0.1092  0.5323 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  0.90707    0.34706   2.614  0.00896 ** 
alpha:LogT         0.40385    0.29920   1.350  0.17710    
alpha:LogT2       -0.19493    0.05992  -3.253  0.00114 ** 
alpha:Level        0.41066    0.13956   2.943  0.00326 ** 
beta:(Intercept)  -1.25839    0.18008  -6.988 2.79e-12 ***
beta:Level         0.10830    0.13838   0.783  0.43384    
beta:LogT          0.51739    0.08071   6.410 1.45e-10 ***
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  0.2268  1.5873
alpha:LogT        -0.1826  0.9903
alpha:LogT2       -0.3124 -0.0775
alpha:Level        0.1371  0.6842
beta:(Intercept)  -1.6113 -0.9054
beta:Level        -0.1629  0.3795
beta:LogT          0.3592  0.6756

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 2.25
beta: 1.06
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 181 
Number of parameters: 7 
Residual degrees of freedom: 174 
Log-likelihood: 125.4 
AIC: -236.8 
BIC: -214.4 
RMSE: 0.2059 
Efron's R2: 0.5592 
Mean Absolute Error: 0.1566 

Convergence status: Successful 
Iterations: 29 

> 
> # Interpretation:
> # - Beta: Precision varies with both level and time
> #   Early measurements may be more variable than late measurements
> 
> # Test heteroscedasticity
> anova(fit_kw, fit_kw_hetero)
Analysis of Deviance Table

Model 1: Gas ~ LogT + LogT2 + Level | Level
Model 2: Gas ~ LogT + LogT2 + Level | Level + LogT

              Resid. Df Resid. Dev Df Deviance Pr(>Chi)    
fit_kw        175.00000 -207.36034                         
fit_kw_hetero 174.00000 -250.75874  1 43.39840  < 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: Exponentiated Kumaraswamy for decay tails
> # Gas decay may show different tail behavior at extreme time points
> # (very fast initial decay or very slow residual decay)
> fit_ekw <- gkwreg(
+   Gas ~ LogT + LogT2 + Level | # alpha: decay curve
+     Level + LogT | # beta: heteroscedasticity
+     Level, # lambda: tail heaviness by level
+   data = retinal,
+   family = "ekw"
+ )
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = Gas ~ LogT + LogT2 + Level | Level + LogT | 
    Level, data = retinal, family = "ekw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.4958 -0.0799  0.0651  0.0446  0.1693  0.5107 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)   1.36711    1.11962   1.221  0.22207    
alpha:LogT          0.27552    0.32922   0.837  0.40267    
alpha:LogT2        -0.16545    0.05963  -2.775  0.00553 ** 
alpha:Level        -0.38899    0.39384  -0.988  0.32330    
beta:(Intercept)   -1.36470    0.34796  -3.922 8.78e-05 ***
beta:Level          0.25158    0.19003   1.324  0.18555    
beta:LogT           0.54369    0.12922   4.207 2.58e-05 ***
lambda:(Intercept) -0.32755    0.76219  -0.430  0.66738    
lambda:Level        0.92335    0.39316   2.349  0.01885 *  
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                        3%     98%
alpha:(Intercept)  -0.8273  3.5615
alpha:LogT         -0.3698  0.9208
alpha:LogT2        -0.2823 -0.0486
alpha:Level        -1.1609  0.3829
beta:(Intercept)   -2.0467 -0.6827
beta:Level         -0.1209  0.6240
beta:LogT           0.2904  0.7970
lambda:(Intercept) -1.8214  1.1663
lambda:Level        0.1528  1.6939

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 2.771
beta: 1.082
gamma: 1
delta: 0
lambda: 1.08

Model fit statistics:
Number of observations: 181 
Number of parameters: 9 
Residual degrees of freedom: 172 
Log-likelihood: 129.2 
AIC: -240.3 
BIC: -211.5 
RMSE: 0.209 
Efron's R2: 0.5458 
Mean Absolute Error: 0.1644 

Convergence status: Successful 
Iterations: 37 

> 
> # Interpretation:
> # - Lambda varies by level: Different initial concentrations may have
> #   different rates of extreme decay (very fast or very slow residual gas)
> # - Important for predicting complete absorption time
> 
> # Example 4: McDonald distribution for asymmetric decay
> # Alternative parameterization for skewed decay patterns
> fit_mc <- gkwreg(
+   Gas ~ LogT + LogT2 + Level | # gamma
+     LogT + Level | # delta
+     Level, # lambda
+   data = retinal,
+   family = "mc",
+   control = gkw_control(
+     method = "BFGS",
+     maxit = 1500,
+     reltol = 1e-8
+   )
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_mc)

Generalized Kumaraswamy Regression Model Summary

Family: mc 

Call:
gkwreg(formula = Gas ~ LogT + LogT2 + Level | LogT + Level | 
    Level, data = retinal, family = "mc", control = gkw_control(method = "BFGS", 
    maxit = 1500, reltol = 1e-08))

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.5652 -0.1159  0.0034 -0.0098  0.1214  0.5185 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
gamma:(Intercept)   0.99232    1.85227   0.536    0.592    
gamma:LogT          1.11127    0.23830   4.663 3.11e-06 ***
gamma:LogT2        -0.44693    0.05657  -7.900 2.79e-15 ***
gamma:Level         0.28447    1.38833   0.205    0.838    
delta:(Intercept)  -6.27067    0.70158  -8.938  < 2e-16 ***
delta:LogT          0.17905        NaN     NaN      NaN    
delta:Level        -0.38972        NaN     NaN      NaN    
lambda:(Intercept)  0.29057    1.83059   0.159    0.874    
lambda:Level       -0.07583    1.42998  -0.053    0.958    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                        3%     98%
gamma:(Intercept)  -2.6381  4.6227
gamma:LogT          0.6442  1.5783
gamma:LogT2        -0.5578 -0.3360
gamma:Level        -2.4366  3.0055
delta:(Intercept)  -7.6458 -4.8956
delta:LogT             NaN     NaN
delta:Level            NaN     NaN
lambda:(Intercept) -3.2973  3.8785
lambda:Level       -2.8785  2.7269

Link functions:
gamma: log
delta: logit
lambda: log

Fitted parameter means:
alpha: 1
beta: 1
gamma: 2.848
delta: 0.0269
lambda: 1.317

Model fit statistics:
Number of observations: 181 
Number of parameters: 9 
Residual degrees of freedom: 172 
Log-likelihood: 66.48 
AIC: -115 
BIC: -86.18 
RMSE: 0.2145 
Efron's R2: 0.5216 
Mean Absolute Error: 0.1631 

Convergence status: Successful 
Iterations: 26 

> 
> # Model comparison
> AIC(fit_kw, fit_kw_hetero, fit_ekw, fit_mc)
              df       AIC
fit_kw         6 -195.3603
fit_kw_hetero  7 -236.7587
fit_ekw        9 -240.3186
fit_mc         9 -114.9668
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("retinal", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("sdac")
> ### * sdac
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: sdac
> ### Title: Autologous Peripheral Blood Stem Cell Transplants Data
> ### Aliases: sdac
> ### Keywords: datasets
> 
> ### ** Examples
> 
> ## No test: 
> require(gkwreg)
> require(gkwdist)
Loading required package: gkwdist
> 
> data(sdac)
> 
> # Example 1: Basic Kumaraswamy regression
> # Mean recovery depends on age and chemotherapy protocol
> # Precision varies with age (older patients more variable)
> fit_kw <- gkwreg(
+   rcd ~ ageadj + chemo |
+     age,
+   data = sdac,
+   family = "kw"
+ )
> summary(fit_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = rcd ~ ageadj + chemo | age, data = sdac, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3947 -0.0679  0.0046 -0.0053  0.0733  0.2092 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept) 1.571402   0.134370  11.695  < 2e-16 ***
alpha:ageadj      0.019100   0.006771   2.821  0.00479 ** 
alpha:chemo       0.207250   0.101033   2.051  0.04024 *  
beta:(Intercept)  0.636173   0.362393   1.755  0.07918 .  
beta:age          0.005695   0.006862   0.830  0.40656    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%    98%
alpha:(Intercept)  1.3080 1.8348
alpha:ageadj       0.0058 0.0324
alpha:chemo        0.0092 0.4053
beta:(Intercept)  -0.0741 1.3464
beta:age          -0.0078 0.0191

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 6.967
beta: 2.412
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 239 
Number of parameters: 5 
Residual degrees of freedom: 234 
Log-likelihood: 195.7 
AIC: -381.5 
BIC: -364.1 
RMSE: 0.1113 
Efron's R2: 0.04391 
Mean Absolute Error: 0.08571 

Convergence status: Successful 
Iterations: 19 

> 
> # Interpretation:
> # - Alpha (mean recovery): Depends on age-adjusted covariate and chemo protocol
> #   Different protocols show different baseline recovery rates
> #   G-CSF-only may differ from multi-day chemotherapy protocols
> # - Beta (precision): Raw age affects recovery variability
> #   Hypothesis: Older patients show more heterogeneous responses
> 
> # Example 2: Include gender effects
> # Gender may influence stem cell recovery rates
> fit_kw_gender <- gkwreg(
+   rcd ~ ageadj + chemo + gender |
+     age + gender,
+   data = sdac,
+   family = "kw"
+ )
> summary(fit_kw_gender)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = rcd ~ ageadj + chemo + gender | age + gender, 
    data = sdac, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3938 -0.0616  0.0086 -0.0007  0.0773  0.2216 

Coefficients:
                   Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  1.517624   0.167580   9.056  < 2e-16 ***
alpha:ageadj       0.019192   0.006794   2.825  0.00473 ** 
alpha:chemo        0.204847   0.100938   2.029  0.04241 *  
alpha:genderM      0.079423   0.147338   0.539  0.58985    
beta:(Intercept)   0.632507   0.377828   1.674  0.09412 .  
beta:age           0.005895   0.006950   0.848  0.39629    
beta:genderM      -0.005010   0.220384  -0.023  0.98186    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%    98%
alpha:(Intercept)  1.1892 1.8461
alpha:ageadj       0.0059 0.0325
alpha:chemo        0.0070 0.4027
alpha:genderM     -0.2094 0.3682
beta:(Intercept)  -0.1080 1.3730
beta:age          -0.0077 0.0195
beta:genderM      -0.4370 0.4269

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 6.989
beta: 2.549
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 239 
Number of parameters: 7 
Residual degrees of freedom: 232 
Log-likelihood: 196.1 
AIC: -378.2 
BIC: -353.9 
RMSE: 0.111 
Efron's R2: 0.04818 
Mean Absolute Error: 0.08604 

Convergence status: Successful 
Iterations: 22 

> 
> # Interpretation:
> # - Gender effects in both mean and precision
> # - Precision may differ between males and females
> 
> # Test gender significance
> anova(fit_kw, fit_kw_gender)
Analysis of Deviance Table

Model 1: rcd ~ ageadj + chemo | age
Model 2: rcd ~ ageadj + chemo + gender | age + gender

              Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
fit_kw        234.00000 -391.48936                       
fit_kw_gender 232.00000 -392.23401  2  0.74464  0.68913  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 3: Exponentiated Kumaraswamy for extreme recovery patterns
> # Some patients show unusually high or low recovery (outliers)
> # Lambda parameter captures tail heaviness
> fit_ekw <- gkwreg(
+   rcd ~ ageadj + chemo + gender | # alpha: mean model
+     age + chemo | # beta: precision varies with age and protocol
+     chemo, # lambda: protocol affects extremity
+   data = sdac,
+   family = "ekw"
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> summary(fit_ekw)

Generalized Kumaraswamy Regression Model Summary

Family: ekw 

Call:
gkwreg(formula = rcd ~ ageadj + chemo + gender | age + chemo | 
    chemo, data = sdac, family = "ekw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3884 -0.0622  0.0138  0.0051  0.0819  0.2320 

Coefficients:
                     Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)   1.127e+00  9.395e-01   1.200 0.230287    
alpha:ageadj        1.483e-02  3.970e-03   3.737 0.000186 ***
alpha:chemo        -1.654e+01  1.577e+00 -10.487  < 2e-16 ***
alpha:genderM       9.479e-02  8.577e-02   1.105 0.269110    
beta:(Intercept)    8.297e-01  2.653e-01   3.128 0.001762 ** 
beta:age           -1.034e-04        NaN     NaN      NaN    
beta:chemo         -2.595e-01  2.797e-01  -0.928 0.353508    
lambda:(Intercept)  5.704e-01  1.201e+00   0.475 0.634758    
lambda:chemo        2.859e+01        NaN     NaN      NaN    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                         3%      98%
alpha:(Intercept)   -0.7144   2.9685
alpha:ageadj         0.0071   0.0226
alpha:chemo        -19.6345 -13.4509
alpha:genderM       -0.0733   0.2629
beta:(Intercept)     0.3098   1.3496
beta:age                NaN      NaN
beta:chemo          -0.8078   0.2887
lambda:(Intercept)  -1.7830   2.9239
lambda:chemo            NaN      NaN

Link functions:
alpha: log
beta: log
lambda: log

Fitted parameter means:
alpha: 2.369
beta: 2.042
gamma: 1
delta: 0
lambda: 2.112e+12

Model fit statistics:
Number of observations: 239 
Number of parameters: 9 
Residual degrees of freedom: 230 
Log-likelihood: 201.3 
AIC: -384.5 
BIC: -353.2 
RMSE: 0.1114 
Efron's R2: 0.04241 
Mean Absolute Error: 0.08708 

Convergence status: Failed 
Iterations: 74 

> 
> # Clinical interpretation:
> # - Lambda varies by chemotherapy protocol: Some protocols produce more
> #   extreme recovery patterns (very high or very low CD34+ counts)
> # - G-CSF-only vs multi-day protocols may differ in tail behavior
> # - Important for risk stratification and clinical decision-making
> 
> # Test if extreme patterns differ by protocol
> anova(fit_kw_gender, fit_ekw)
Analysis of Deviance Table

Model 1: rcd ~ ageadj + chemo + gender | age + gender
Model 2: rcd ~ ageadj + chemo + gender | age + chemo | chemo

              Resid. Df Resid. Dev Df Deviance Pr(>Chi)   
fit_kw_gender 232.00000 -392.23401                        
fit_ekw       230.00000 -402.51458  2 10.28058 0.005856 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # Example 4: Interaction between age and protocol
> # Protocol effectiveness may vary with patient age
> fit_kw_interact <- gkwreg(
+   rcd ~ ageadj * chemo |
+     age * chemo,
+   data = sdac,
+   family = "kw"
+ )
> summary(fit_kw_interact)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = rcd ~ ageadj * chemo | age * chemo, data = sdac, 
    family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.3898 -0.0624  0.0073 -0.0021  0.0729  0.2113 

Coefficients:
                    Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)   1.659107   0.220086   7.538 4.76e-14 ***
alpha:ageadj        0.013918   0.011255   1.237    0.216    
alpha:chemo         0.138996   0.256543   0.542    0.588    
alpha:ageadj:chemo  0.004748   0.015016   0.316    0.752    
beta:(Intercept)    1.686154   1.036463   1.627    0.104    
beta:age           -0.012553   0.017666  -0.711    0.477    
beta:chemo         -1.234435   1.122370  -1.100    0.271    
beta:age:chemo      0.023055   0.020005   1.152    0.249    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                        3%    98%
alpha:(Intercept)   1.2277 2.0905
alpha:ageadj       -0.0081 0.0360
alpha:chemo        -0.3638 0.6418
alpha:ageadj:chemo -0.0247 0.0342
beta:(Intercept)   -0.3453 3.7176
beta:age           -0.0472 0.0221
beta:chemo         -3.4342 0.9654
beta:age:chemo     -0.0162 0.0623

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 6.971
beta: 2.524
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 239 
Number of parameters: 8 
Residual degrees of freedom: 231 
Log-likelihood: 196.7 
AIC: -377.4 
BIC: -349.6 
RMSE: 0.111 
Efron's R2: 0.04886 
Mean Absolute Error: 0.08551 

Convergence status: Successful 
Iterations: 46 

> 
> # Interpretation:
> # - Interaction: Does protocol effectiveness decline with age?
> # - Critical for personalized treatment selection
> ## End(No test)
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("sdac", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()

detaching ‘package:gkwdist’

> nameEx("summary.gkwreg")
> ### * summary.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: summary.gkwreg
> ### Title: Summary Method for Generalized Kumaraswamy Regression Models
> ### Aliases: summary.gkwreg
> ### Keywords: models regression summary
> 
> ### ** Examples
> 
> ## No test: 
> set.seed(123)
> n <- 100
> x1 <- runif(n, -2, 2)
> x2 <- rnorm(n)
> alpha_coef <- c(0.8, 0.3, -0.2)
> beta_coef <- c(1.2, -0.4, 0.1)
> eta_alpha <- alpha_coef[1] + alpha_coef[2] * x1 + alpha_coef[3] * x2
> eta_beta <- beta_coef[1] + beta_coef[2] * x1 + beta_coef[3] * x2
> alpha_true <- exp(eta_alpha)
> beta_true <- exp(eta_beta)
> # Use stats::rbeta as a placeholder if rkw is unavailable
> y <- stats::rbeta(n, shape1 = alpha_true, shape2 = beta_true)
> y <- pmax(pmin(y, 1 - 1e-7), 1e-7)
> df <- data.frame(y = y, x1 = x1, x2 = x2)
> 
> # Fit a Kumaraswamy regression model
> kw_reg <- gkwreg(y ~ x1 + x2 | x1 + x2, data = df, family = "kw")
> 
> # Generate detailed summary using the summary method
> summary_kw <- summary(kw_reg)
> 
> # Print the summary object (uses print.summary.gkwreg)
> print(summary_kw)

Generalized Kumaraswamy Regression Model Summary

Family: kw 

Call:
gkwreg(formula = y ~ x1 + x2 | x1 + x2, data = df, family = "kw")

Residuals:
    Min  Q1.25%  Median    Mean  Q3.75%     Max 
-0.4910 -0.0942  0.0028  0.0042  0.1329  0.5094 

Coefficients:
                  Estimate Std. Error z value Pr(>|z|)    
alpha:(Intercept)  0.73589    0.10135   7.261 3.85e-13 ***
alpha:x1           0.25878    0.08860   2.921  0.00349 ** 
alpha:x2          -0.12441    0.08825  -1.410  0.15863    
beta:(Intercept)   1.45325    0.17992   8.077 6.64e-16 ***
beta:x1           -0.52161    0.17460  -2.987  0.00281 ** 
beta:x2            0.03766    0.18694   0.201  0.84034    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Confidence intervals (95%):
                       3%     98%
alpha:(Intercept)  0.5372  0.9345
alpha:x1           0.0851  0.4324
alpha:x2          -0.2974  0.0486
beta:(Intercept)   1.1006  1.8059
beta:x1           -0.8638 -0.1794
beta:x2           -0.3287  0.4041

Link functions:
alpha: log
beta: log

Fitted parameter means:
alpha: 2.207
beta: 5.072
gamma: 1
delta: 0
lambda: 1

Model fit statistics:
Number of observations: 100 
Number of parameters: 6 
Residual degrees of freedom: 94 
Log-likelihood: 46.13 
AIC: -80.27 
BIC: -64.63 
RMSE: 0.1728 
Efron's R2: 0.5496 
Mean Absolute Error: 0.1365 

Convergence status: Successful 
Iterations: 27 

> 
> # Extract coefficient table directly from the summary object
> coef_table <- coef(summary_kw) # Equivalent to summary_kw$coefficients
> print(coef_table)
                     Estimate Std. Error    z value     Pr(>|z|)
alpha:(Intercept)  0.73589120 0.10135318  7.2606619 3.852007e-13
alpha:x1           0.25877630 0.08860253  2.9206422 3.493107e-03
alpha:x2          -0.12440703 0.08825176 -1.4096833 1.586332e-01
beta:(Intercept)   1.45324717 0.17992343  8.0770311 6.636262e-16
beta:x1           -0.52161306 0.17460352 -2.9874143 2.813482e-03
beta:x2            0.03766118 0.18693698  0.2014646 8.403353e-01
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("summary.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("terms.gkwreg")
> ### * terms.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: terms.gkwreg
> ### Title: Extract Terms from GKw Regression Model
> ### Aliases: terms.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> data(GasolineYield)
> fit <- gkwreg(yield ~ batch + temp, data = GasolineYield, family = "kw")
Warning in sqrt(diag(cov)) : NaNs produced
> terms(fit)
yield ~ batch + temp
attr(,"variables")
list(yield, batch, temp)
attr(,"factors")
      batch temp
yield     0    0
batch     1    0
temp      0    1
attr(,"term.labels")
[1] "batch" "temp" 
attr(,"order")
[1] 1 1
attr(,"intercept")
[1] 1
attr(,"response")
[1] 1
attr(,".Environment")
<environment: 0x64a4f7646420>
attr(,"predvars")
list(yield, batch, temp)
attr(,"dataClasses")
    yield     batch      temp 
"numeric"  "factor" "numeric" 
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("terms.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> cleanEx()
> nameEx("update.gkwreg")
> ### * update.gkwreg
> 
> flush(stderr()); flush(stdout())
> 
> base::assign(".ptime", proc.time(), pos = "CheckExEnv")
> ### Name: update.gkwreg
> ### Title: Update and Re-fit a GKw Regression Model
> ### Aliases: update.gkwreg
> 
> ### ** Examples
> 
> ## No test: 
> # Load example data
> require(gkwreg)
> 
> data(GasolineYield)
> 
> # EXAMPLE 1: Simple formulas (1 part - alpha only)
> 
> m1_0 <- gkwreg(yield ~ 1, data = GasolineYield, family = "kw")
> m1_1 <- update(m1_0, . ~ . + temp)
> m1_2 <- update(m1_1, . ~ . + batch)
Warning in sqrt(diag(cov)) : NaNs produced
> m1_3 <- update(m1_2, . ~ . - temp)
> 
> anova(m1_0, m1_1, m1_2)
Analysis of Deviance Table

Model 1: yield ~ 1
Model 2: yield ~ temp
Model 3: yield ~ temp + batch

     Resid. Df Resid. Dev Df  Deviance Pr(>Chi)    
m1_0  30.00000  -57.02258                          
m1_1  29.00000  -80.90259  1  23.88001  < 1e-04 ***
m1_2  20.00000 -193.93698  9 113.03439  < 1e-04 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> AIC(m1_0, m1_1, m1_2, m1_3)
     df        AIC
m1_0  2  -53.02258
m1_1  3  -74.90259
m1_2 12 -169.93698
m1_3 11  -42.93436
> BIC(m1_0, m1_1, m1_2, m1_3)
     df        BIC
m1_0  2  -50.09111
m1_1  3  -70.50538
m1_2 12 -152.34815
m1_3 11  -26.81126
> 
> # EXAMPLE 2: Two-part formulas (alpha | beta)
> 
> # Start with intercept-only for both
> m2_0 <- gkwreg(yield ~ 1 | 1, data = GasolineYield, family = "kw")
> 
> # Add temp to alpha
> m2_1 <- update(m2_0, . ~ . + temp | .)
> 
> # Add batch to beta
> m2_2 <- update(m2_1, . ~ . | . + batch)
> 
> # Add batch to alpha too
> m2_3 <- update(m2_2, . ~ . + batch | .)
> 
> anova(m2_0, m2_1, m2_2, m2_3)
Warning: negative deviance change detected; models may not be nested
Analysis of Deviance Table

Model 1: yield ~ 1 | 1
Model 2: yield ~ temp
Model 3: yield ~ temp | batch
Model 4: yield ~ temp + batch | batch

     Resid. Df Resid. Dev Df  Deviance Pr(>Chi)    
m2_0  30.00000  -57.02258                          
m2_1  29.00000  -80.90259  1  23.88001  < 1e-04 ***
m2_2  20.00000 -214.71632  9 133.81373  < 1e-04 ***
m2_3  11.00000 -196.72830  9 -17.98802             
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> AIC(m2_0, m2_1, m2_2, m2_3)
     df        AIC
m2_0  2  -53.02258
m2_1  3  -74.90259
m2_2 12 -190.71632
m2_3 21 -154.72830
> 
> # EXAMPLE 3: Three-part formulas (alpha | beta | gamma)
> 
> m3_0 <- gkwreg(yield ~ 1,
+   data = GasolineYield,
+   family = "gkw",
+   control = gkw_control(method = "BFGS", maxit = 2000)
+ )
Warning in sqrt(diag(cov)) : NaNs produced
> 
> m3_1 <- update(m3_0, . ~ . + temp | . | .)
Warning in sqrt(diag(cov)) : NaNs produced
> m3_2 <- update(m3_1, . ~ . | . + batch | .)
Warning in sqrt(diag(cov)) : NaNs produced
> m3_3 <- update(m3_2, . ~ . | . | . + temp)
Warning in sqrt(diag(cov)) : NaNs produced
> 
> anova(m3_0, m3_1, m3_2, m3_3)
Warning: negative deviance change detected; models may not be nested
Warning: negative deviance change detected; models may not be nested
Analysis of Deviance Table

Model 1: yield ~ 1
Model 2: yield ~ temp
Model 3: yield ~ temp | batch
Model 4: yield ~ temp | batch | temp

     Resid. Df Resid. Dev Df Deviance Pr(>Chi)  
m3_0  27.00000  -48.83211                       
m3_1  26.00000  -52.22113  1  3.38901 0.065632 .
m3_2  17.00000  -52.22112  9  0.00000           
m3_3  16.00000  -42.82798  1 -9.39315           
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> 
> # EXAMPLE 4: Practical nested model comparison
> 
> # Null model
> fit0 <- gkwreg(yield ~ 1,
+   data = GasolineYield,
+   family = "kw",
+   control = gkw_control(method = "BFGS", maxit = 2000)
+ )
> 
> # Add main effects to alpha
> fit1 <- update(fit0, . ~ . + temp)
> fit2 <- update(fit1, . ~ . + batch)
> 
> # Model beta parameter
> fit3 <- update(fit2, . ~ . | temp)
> fit4 <- update(fit3, . ~ . | . + batch)
> 
> # Full comparison
> anova(fit0, fit1, fit2, fit3, fit4)
Warning: negative deviance change detected; models may not be nested
Analysis of Deviance Table

Model 1: yield ~ 1
Model 2: yield ~ temp
Model 3: yield ~ temp + batch
Model 4: yield ~ temp + batch | temp
Model 5: yield ~ temp + batch | temp + batch

     Resid. Df Resid. Dev Df Deviance  Pr(>Chi)   
fit0  30.00000  -16.60035                         
fit1  29.00000   -8.36052  1 -8.23983             
fit2  20.00000   -8.36052  9    1e-05         1   
fit3  19.00000  -18.17449  1  9.81397 0.0017319 **
fit4  10.00000  -18.17450  9    1e-05         1   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
> AIC(fit0, fit1, fit2, fit3, fit4)
     df        AIC
fit0  2 -12.600346
fit1  3  -2.360515
fit2 12  15.639476
fit3 13   7.825509
fit4 22  25.825501
> BIC(fit0, fit1, fit2, fit3, fit4)
     df       BIC
fit0  2 -9.668874
fit1  3  2.036692
fit2 12 33.228307
fit3 13 26.880076
fit4 22 58.071691
> 
> # EXAMPLE 5: Changing other parameters
> 
> # Change family
> fit_gkw <- update(fit2, family = "gkw")
Warning in sqrt(diag(cov)) : NaNs produced
> 
> # Change link function
> fit_logit <- update(fit2, link = list(alpha = "logit"))
> 
> # View call without fitting
> update(fit2, . ~ . | . + temp, evaluate = FALSE)
gkwreg(formula = yield ~ temp + batch | temp, data = GasolineYield, 
    family = "kw", control = gkw_control(method = "BFGS", maxit = 2000))
> ## End(No test)
> 
> 
> 
> 
> base::assign(".dptime", (proc.time() - get(".ptime", pos = "CheckExEnv")), pos = "CheckExEnv")
> base::cat("update.gkwreg", base::get(".format_ptime", pos = 'CheckExEnv')(get(".dptime", pos = "CheckExEnv")), "\n", file=base::get(".ExTimings", pos = 'CheckExEnv'), append=TRUE, sep="\t")
> ### * <FOOTER>
> ###
> cleanEx()
> options(digits = 7L)
> base::cat("Time elapsed: ", proc.time() - base::get("ptime", pos = 'CheckExEnv'),"\n")
Time elapsed:  24.879 2.455 211.009 173.935 19.27 
> grDevices::dev.off()
null device 
          1 
> ###
> ### Local variables: ***
> ### mode: outline-minor ***
> ### outline-regexp: "\\(> \\)?### [*]+" ***
> ### End: ***
> quit('no')
