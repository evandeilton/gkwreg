% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gkwfit.R, R/gkwreg.R
\name{confint.gkwfit}
\alias{confint.gkwfit}
\title{Compute Confidence Intervals for gkwfit Parameters}
\usage{
\method{confint}{gkwfit}(
  object,
  parm,
  level = 0.95,
  method = c("wald", "profile"),
  max_steps = 100,
  stepsize = 0.01,
  trace = FALSE,
  ...
)

\method{confint}{gkwfit}(
  object,
  parm,
  level = 0.95,
  method = c("wald", "profile"),
  max_steps = 100,
  stepsize = 0.01,
  trace = FALSE,
  ...
)
}
\arguments{
\item{object}{An object of class \code{"gkwfit"}, typically the result of a
call to \code{\link{gkwfit}}.}

\item{parm}{A specification of which parameters to compute confidence intervals
for. Can be:
\itemize{
\item A character vector containing the names of the parameters (e.g.,
\code{"alpha"}, \code{"beta"}, \code{"gamma"}).
\item A numeric vector containing the indices of the parameters in the
\code{coef(object)} vector.
\item Missing (default), in which case confidence intervals for all
estimated (non-fixed) parameters are computed.
}}

\item{level}{Numeric. The desired confidence level, e.g., 0.95 for a 95\%
confidence interval. Must be between 0 and 1. Default is 0.95.}

\item{method}{Character string specifying the method used to compute the
confidence intervals. Options are:
\itemize{
\item \code{"wald"}: (Default) Computes Wald-type intervals based on the
estimated parameters, their standard errors, and the normal approximation.
Requires standard errors to be available (i.e., model fitted with
\code{hessian = TRUE}).
\item \code{"profile"}: Computes intervals based on the profile likelihood.
This requires the model to have been fitted using TMB and the \code{TMB}
package to be installed. May not be supported by all fitting methods within
\code{gkwfit}.
}}

\item{max_steps}{Integer. Maximum number of steps allowed during the profile
likelihood calculation for each parameter. Only applicable when
\code{method = "profile"}. Default is 100.}

\item{stepsize}{Numeric. Initial step size factor used in the profile likelihood search,
relative to the parameter's standard error. Only applicable when
\code{method = "profile"}. Default is 0.01.}

\item{trace}{Logical. If \code{TRUE}, prints progress information during the
profile likelihood calculation. Only applicable when \code{method = "profile"}.
Default is \code{FALSE}.}

\item{...}{Additional arguments, currently ignored by this method.}
}
\value{
A matrix with columns giving lower and upper confidence limits for each
parameter specified in \code{parm}. The columns are labeled with quantile percentages
(e.g., \code{"2.5 \%"} and \code{"97.5 \%"} for \code{level = 0.95}). Row names
are taken from the parameter names. Returns \code{NULL} or stops with an error
if coefficients or a valid variance-covariance matrix cannot be extracted.

A matrix with two columns, giving the lower and upper confidence limits
for each requested parameter. Rows are named after the parameters. Columns are
labeled with the corresponding confidence percentage (e.g., "2.5 \%" and "97.5 \%"
for \code{level = 0.95}). If intervals cannot be computed, the corresponding
rows will contain \code{NA}.
}
\description{
Computes confidence intervals for one or more parameters in a model fitted by
\code{\link{gkwfit}}. It uses the Wald method based on the estimated coefficients
and their standard errors derived from the variance-covariance matrix.

Computes confidence intervals for one or more parameters estimated by fitting a
Generalized Kumaraswamy (GKw) distribution or its subfamilies using
\code{\link{gkwfit}}. Supports Wald-type and potentially profile likelihood intervals.
}
\details{
This function calculates confidence intervals using the Wald method:
\eqn{Estimate \pm z \times SE}, where \eqn{z} is the appropriate quantile
from the standard normal distribution for the given confidence \code{level}.

It relies on the results from \code{\link{coef.gkwfit}} and \code{\link{vcov.gkwfit}}
(or directly accesses \code{object$coefficients} and \code{object$vcov} if those
methods aren't defined). It checks for the validity of the variance-covariance
matrix before proceeding.

Since all parameters of the GKw family distributions are constrained to be positive,
the lower bound of the confidence interval is truncated at a small positive value
(\code{.Machine$double.eps^0.5}) if the calculated lower bound is non-positive.

If \code{parm} is specified, it selects the parameters for which to compute intervals.
Numeric indices in \code{parm} refer to the parameters that have calculable standard
errors, not necessarily all parameters in the model (if some were fixed or had
estimation issues).

This function computes confidence intervals for the parameters
(\eqn{\theta}) of a GKw distribution fit.

\strong{Wald intervals} (\code{method = "wald"}) are calculated using the
standard formula based on the asymptotic normality of MLEs:
\deqn{\hat{\theta}_j \pm z_{1-\alpha/2} \cdot \mathrm{SE}(\hat{\theta}_j)}
where \eqn{\hat{\theta}_j} is the estimated parameter, \eqn{\mathrm{SE}(\hat{\theta}_j)}
is its estimated standard error (obtained from the Hessian matrix), \eqn{\alpha = 1 - \mathrm{level}},
and \eqn{z_{1-\alpha/2}} is the \eqn{1-\alpha/2} quantile of the standard normal
distribution (obtained via \code{stats::qnorm}). These intervals rely on
the availability of standard errors in the \code{object}.

\strong{Profile likelihood intervals} (\code{method = "profile"}) are derived
by finding the parameter values for which the profile log-likelihood function
drops by \eqn{\chi^2_{1, 1-\alpha}/2} from its maximum. This method can provide
more accurate coverage but is computationally more intensive and requires that
the model was fitted using an engine that supports profiling (like TMB). If
profiling is not supported or fails, the function may fall back to Wald intervals
with a warning.
}
\note{
Reliable Wald confidence intervals require that the model was fitted using
\code{hessian = TRUE} in the original \code{\link{gkwfit}} call. Profile likelihood
intervals depend on the fitting method used within \code{gkwfit} (e.g., requires TMB).
}
\examples{
\dontrun{
# Assume 'rkw' and 'gkwfit' functions exist

set.seed(123)
kw_data_sample <- rkw(100, alpha = 2.5, beta = 1.5)

# Fit the model, ensuring hessian is computed (default TRUE)
fit_obj <- gkwfit(data = kw_data_sample, family = "kw", silent = TRUE)

# Calculate default 95\% confidence intervals for all parameters
ci_default <- confint(fit_obj)
print(ci_default)

# Calculate 90\% confidence intervals
ci_90 <- confint(fit_obj, level = 0.90)
print(ci_90)

# Calculate interval for a specific parameter by name
ci_alpha <- confint(fit_obj, parm = "alpha")
print(ci_alpha)

# Calculate interval for specific parameters by index
# (Indices refer to parameters with SEs, here alpha=1, beta=2)
ci_indexed <- confint(fit_obj, parm = 1:2) # Should be same as default for Kw
print(ci_indexed)

# Fit a model with a fixed parameter (example for KKw)
kkw_data_sample <- rkkw(100, alpha = 2, beta = 3, delta = 1.5, lambda = 0.8) # Assume rkkw
fit_kkw_fixed <- gkwfit(kkw_data_sample, family = "kkw", fixed = list(lambda = 0.8))
ci_kkw_fixed <- confint(fit_kkw_fixed) # Should only show CIs for alpha, beta, delta
print(ci_kkw_fixed)
}

\dontrun{
# Assume 'y_data' is a vector of observations between 0 and 1.
set.seed(123)
y_data <- rkw(200, alpha = 2, beta = 3) # Example using Kumaraswamy
y_data <- pmax(pmin(y_data, 1 - 1e-7), 1e-7)

# Fit the distribution (ensure hessian=TRUE for Wald CIs)
fit_kw <- gkwfit(y_data, family = "kw", hessian = TRUE)

# --- Wald Confidence Intervals ---

# Calculate 95\% Wald confidence intervals for alpha and beta
ci_wald_kw <- confint(fit_kw)
print(ci_wald_kw)

# Calculate 90\% Wald confidence interval for alpha only
ci_wald_alpha <- confint(fit_kw, parm = "alpha", level = 0.90)
print(ci_wald_alpha)

# --- Profile Likelihood Confidence Intervals (if supported by gkwfit method) ---

# Calculate 95\% profile likelihood CIs (may take longer, requires TMB fit)
ci_profile_kw <- try(confint(fit_kw, method = "profile"))
if (!inherits(ci_profile_kw, "try-error")) {
  print(ci_profile_kw)
} else {
  print("Profile likelihood CI calculation failed or not supported.")
}
}

}
\seealso{
\code{\link{gkwfit}}, \code{\link[stats]{confint}}, \code{\link{coef.gkwfit}}, \code{\link{vcov.gkwfit}}

\code{\link{gkwfit}}, \code{\link{summary.gkwfit}},
\code{\link{coef.gkwfit}}, \code{\link[stats]{confint}}
}
\author{
Lopes, J. E.
}
\keyword{confidence}
\keyword{htest}
\keyword{intervals}
\keyword{methods}
\keyword{models}
