% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{llgkw}
\alias{llgkw}
\title{Log-Likelihood Function for Generalized Kumaraswamy Distribution}
\usage{
llgkw(par, data)
}
\arguments{
\item{par}{NumericVector of length 5 containing parameters (α, β, γ, δ, λ) in that order.
All parameters must be positive.}

\item{data}{NumericVector of observations, where all values must be in the open interval (0,1).}
}
\value{
The negative log-likelihood value as a double, or -Inf if any parameters or data values
are invalid (parameters ≤ 0 or data outside (0,1)).
}
\description{
Calculates the negative log-likelihood for the Generalized Kumaraswamy distribution
GKw(α, β, γ, δ, λ) given a vector of observations. This function is primarily used
in maximum likelihood estimation and model fitting procedures.
}
\details{
The probability density function of the GKw distribution is:

\deqn{
f(x; \alpha, \beta, \gamma, \delta, \lambda) =
  \frac{\lambda \alpha \beta x^{\alpha-1}(1-x^{\alpha})^{\beta-1}}
       {B(\gamma, \delta+1)}
  [1-(1-x^{\alpha})^{\beta}]^{\gamma\lambda-1}
  [1-[1-(1-x^{\alpha})^{\beta}]^{\lambda}]^{\delta}
}

The corresponding log-likelihood function is:

\deqn{
\ell(\theta) = n\ln(\lambda\alpha\beta) - n\ln B(\gamma,\delta+1) +
  \sum_{i=1}^{n} [(\alpha-1)\ln(x_i) + (\beta-1)\ln(v_i) + (\gamma\lambda-1)\ln(w_i) + \delta\ln(z_i)]
}

where:
\itemize{
\item \deqn{v_i = 1 - x_i^{\alpha}}
\item \deqn{w_i = 1 - v_i^{\beta} = 1 - (1-x_i^{\alpha})^{\beta}}
\item \deqn{z_i = 1 - w_i^{\lambda} = 1 - (1-(1-x_i^{\alpha})^{\beta})^{\lambda}}
}

The implementation uses several techniques for numerical stability:
\itemize{
\item R's lbeta function for calculating log(B(γ, δ+1))
\item log1p for calculating log(1-x) when x is close to zero
\item Careful handling of intermediate values to avoid underflow/overflow
}

Note that this function returns the negative log-likelihood (rather than the log-likelihood),
making it suitable for minimization in optimization procedures.
}
\examples{
\dontrun{
# Generate sample data from a GKw distribution
set.seed(123)
x <- rgkw(100, 2, 3, 1.0, 0.5, 0.5)
hist(x, breaks = 20, main = "GKw(2, 3, 1.0, 0.5, 0.5) Sample")

# Use in optimization with Hessian-based methods
result <- optim(c(0.5, 0.5, 0.5, 0.5, 0.5), llgkw, method = "BFGS",
                hessian = TRUE, data = x)

# Compare numerical and analytical derivatives
num_grad <- numDeriv::grad(llgkw, x = result$par, data = x)
num_hess <- numDeriv::hessian(llgkw, x = result$par, data = x)

ana_grad <- grgkw(result$par, data = x)
ana_hess <- hsgkw(result$par, data = x)

# Check differences (should be very small)
round(num_grad - ana_grad, 4)
round(num_hess - ana_hess, 4)

}

}
\references{
Kumaraswamy, P. (1980). A generalized probability density function for double-bounded random processes.
Journal of Hydrology, 46(1-2), 79-88.

Cordeiro, G. M., & de Castro, M. (2011). A new family of generalized distributions.
Journal of Statistical Computation and Simulation, 81(7), 883-898.
}
\seealso{
\code{\link[gkwreg]{dgkw}} for the GKw density function,
\code{\link[gkwreg]{pgkw}} for the GKw cumulative distribution function,
\code{\link[gkwreg]{hsgkw}} for the analytic Hessian of the GKw log-likelihood,
}
