% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/gkwreg.R
\name{gkwreg}
\alias{gkwreg}
\title{Fit Generalized Kumaraswamy Regression Model}
\usage{
gkwreg(
  formula,
  data,
  link = c(1, 1, 1, 1, 1),
  scale = c(10, 10, 10, 10, 10),
  start = NULL,
  control = list(),
  weights = NULL,
  subset = NULL,
  na.action = getOption("na.action", na.omit),
  offset = NULL,
  model = TRUE,
  x = TRUE,
  y = TRUE,
  silent = TRUE
)
}
\arguments{
\item{formula}{A Formula object of the form
\code{y ~ alpha_terms | beta_terms | gamma_terms | delta_terms | lambda_terms},
where each part on the right specifies the covariates for the corresponding parameter.
Missing parts are automatically replaced with intercept-only models.}

\item{data}{A data frame containing the variables referenced in the formula.}

\item{link}{Numeric vector of length 5 specifying the link function
for each parameter (in order: \eqn{\alpha}, \eqn{\beta}, \eqn{\gamma},
\eqn{\delta}, \eqn{\lambda}). Valid values:
1 (log), 2 (logit), 3 (probit), 4 (cauchy), 5 (cloglog), 6 (identity),
7 (sqrt), 8 (inverse), and 9 (inverse-square).
Default is \code{c(1, 1, 1, 1, 1)} (log for all).}

\item{scale}{Numeric vector of length 5 with scale factors for each
link function that maps to (0,1). Default is \code{c(10, 10, 10, 10, 10)}.}

\item{start}{Optional list with initial values for the regression coefficients,
whose components are \code{beta1}, \code{beta2}, \code{beta3}, \code{beta4}, and
\code{beta5}. If \code{NULL} (default), attempts to estimate plausible initial values
from the data.}

\item{control}{List of control parameters for optimization. Available components
(defaults in parentheses):
\itemize{
\item \code{optimizer}: (\code{"nlminb"}) Optimization method: \code{"nlminb"} or \code{"optim"}.
\item \code{optim.method}: (\code{"BFGS"}) Method for \code{optim} if \code{optimizer="optim"}.
\item \code{eval.max}: (5000) Maximum function evaluations.
\item \code{iter.max}: (5000) Maximum iterations.
\item \code{abs.tol}: (1e-20) Absolute tolerance.
\item \code{rel.tol}: (1e-10) Relative tolerance.
\item \code{trace}: (1 if \code{silent=FALSE}, else 0) Level of progress messages.
\item \code{inner.method}: (\code{"newton"}) TMB internal method.
\item \code{inner.maxit}: (4000) Maximum internal iterations in TMB.
\item \code{smartsearch}: (TRUE) Smart search in TMB internal optimizer.
\item \code{tmb.silent}: (value of \code{silent}) Suppresses TMB internal messages.
\item \code{hessian}: (TRUE) Calculate Hessian matrix?
\item \code{openmp}: (TRUE) Use OpenMP if available?
}}

\item{weights}{\strong{(NOT USED BY THE C++ CODE)} Numeric vector of weights (not used).}

\item{subset}{Optional expression indicating which rows of \code{data} to use.}

\item{na.action}{Function for handling missing values in the data frame. Default is \code{na.omit}.}

\item{offset}{Optional vector of offsets to be included in the linear predictor for
parameter \eqn{\alpha}. If not \code{NULL}, this column is added as an offset.}

\item{model}{Logical indicating whether to return the model frame. Default: TRUE.}

\item{x}{Logical indicating whether to return the model matrices. Default: TRUE.}

\item{y}{Logical indicating whether to return the response vector. Default: TRUE.}

\item{silent}{Logical; if TRUE, suppresses progress messages. Default: FALSE.}
}
\value{
An object of class \code{"gkwreg"} containing (among others):
\itemize{
\item \code{call} and \code{formula}: Original calls.
\item \code{coefficients}: List with regression coefficient estimates.
\item \code{fitted.values}: Fitted values (predicted means).
\item \code{residuals}: Residuals (in this case, y - fitted).
\item \code{fitted_parameters}: Estimated mean values of \eqn{\alpha,\beta,\gamma,\delta,\lambda}.
\item \code{link_functions}, \code{link_codes}, \code{scale_factors}: Information about link types.
\item \code{opt}, \code{sdreport}: TMB outputs.
\item \code{loglik}, \code{aic}, \code{bic}, \code{deviance}, \code{df.residual}: Fit statistics.
\item \code{rmse}, \code{efron_r2}, \code{mean_absolute_error}: Performance metrics.
\item \code{cache_performance}: Size and hit rate of internal cache, if available.
\item \code{vcov}: Variance-covariance matrix of parameters.
\item \code{nobs}, \code{npar}: Number of observations and parameters.
\item \code{converged}, \code{iterations}: Convergence and number of iterations.
\item \code{data}, \code{model_matrices}, \code{y}: If requested, returns data, model matrices, and response.
\item \code{weights}, \code{offset}: If passed, returned here for reference (but weights don't enter the fit).
\item \code{model}: The TMB object created (compiled model).
}
}
\description{
Fits a regression model for data bounded between 0 and 1 using the
Generalized Kumaraswamy (GKw) distribution. In this model, all five
parameters (\eqn{\alpha}, \eqn{\beta}, \eqn{\gamma}, \eqn{\delta}, \eqn{\lambda})
can be linked to covariates through distinct linear predictors and user-specified
inverse link functions. The flexible structure of the model allows for a wide range
of applications, including situations where the response variable exhibits
complex bounded behavior.
}
\details{
The GKw distribution is defined for \eqn{y \in (0,1)} by the probability density
function:

\deqn{
f(y; \alpha, \beta, \gamma, \delta, \lambda) =
   \frac{\lambda \alpha \beta\, y^{\alpha-1}\,(1-y^\alpha)^{\beta-1}}{B(\gamma, \delta+1)}
   \Bigl[1-(1-y^\alpha)^\beta\Bigr]^{\gamma\lambda-1}
   \Bigl\{1-\Bigl[1-(1-y^\alpha)^\beta\Bigr]^\lambda\Bigr\}^{\delta},
}

where \eqn{\alpha, \beta, \gamma, \delta, \lambda > 0} and \eqn{B(\gamma, \delta+1)}
denotes the complete Beta function. The associated cumulative distribution function
is:

\deqn{
F(y; \alpha, \beta, \gamma, \delta, \lambda) =
   I_{[1-(1-y^\alpha)^\beta]^\lambda}(\gamma, \delta+1),
}

where \eqn{I_z(a,b)} is the regularized incomplete Beta function.

In the regression framework, each parameter is modeled as a function of covariates
through a linear predictor and an inverse link function:

\deqn{
\theta_i = g_\theta^{-1}\bigl(\mathbf{x}_{\theta i}^T \boldsymbol{\beta}_\theta\bigr),
   \quad \theta \in \{\alpha, \beta, \gamma, \delta, \lambda\},
}

where \eqn{\mathbf{x}_{\theta i}} represents the covariate vector for the \eqn{i}th
observation corresponding to parameter \eqn{\theta} and \eqn{\boldsymbol{\beta}_\theta}
is the associated regression coefficient vector.

The GKw model is a flexible generalization that can model a variety of shapes and is
particularly useful for data with skewness, bimodality, or complex behaviors within
the (0,1) interval.

Available link functions for each parameter include:
\itemize{
\item Log (1): \eqn{g^{-1}(x) = \exp(x)}
\item Logit (2): \eqn{g^{-1}(x) = \text{scale} \cdot \frac{\exp(x)}{1+\exp(x)}}
\item Probit (3): \eqn{g^{-1}(x) = \text{scale} \cdot \Phi(x)}
\item Cauchy (4): \eqn{g^{-1}(x) = \text{scale} \cdot \Bigl(\frac{1}{\pi}\arctan(x) + \frac{1}{2}\Bigr)}
\item Cloglog (5): \eqn{g^{-1}(x) = \text{scale} \cdot \bigl(1 - \exp(-\exp(x))\bigr)}
\item Identity (6): \eqn{g^{-1}(x) = x}
\item Square Root (7): \eqn{g^{-1}(x) = x^2}
\item Inverse (8): \eqn{g^{-1}(x) = 1/x}
\item Inverse-Square (9): \eqn{g^{-1}(x) = 1/\sqrt{x}}
}

For link functions 2-5, which map to (0,1), the \code{scale} parameter is used
to scale the result to the desired domain.

The implementation uses the TMB (Template Model Builder) package for efficient
parameter estimation through automatic differentiation, allowing for fitting
complex models even with large datasets.
}
\examples{
\dontrun{
# Load required packages
library(Formula)

# Simulate data from a beta distribution (for illustration)
set.seed(123)
n <- 1000
x1 <- rnorm(n)
x2 <- rbinom(n, 1, 0.5)

# True parameters
alpha <- exp(0.5 + 0.3 * x1)
beta <- exp(0.8 - 0.4 * x2)

# Generate y from Beta(alpha, beta) as a proxy for GKw data
y <- rbeta(n, shape1 = alpha, shape2 = beta)

# Create data frame
dat <- data.frame(y = y, x1 = x1, x2 = x2)

# Fit GKw model with alpha and beta parameters linked to covariates
# gamma, delta, and lambda as intercept-only
fit <- gkwreg(
  formula = y ~ x1 | x2 | 1 | 1 | 1,
  data = dat,
  link = c(1, 1, 1, 1, 1), # log for all
  scale = c(10, 10, 10, 10, 10)
)

# Model summary
summary(fit)

# Estimated coefficients
coef(fit)

# Fitted values and residuals
head(fitted(fit))
head(residuals(fit))

# Diagnostics
plot(fit)
}

}
\references{
Kumaraswamy, P. (1980). A generalized probability density function for double-bounded random processes.
Journal of Hydrology, 46(1-2), 79-88.

Cordeiro, G. M., & de Castro, M. (2011). A new family of generalized distributions.
Journal of Statistical Computation and Simulation, 81(7), 883-898.

Jones, M. C. (2009). Kumaraswamy's distribution: A beta-type distribution with some tractability advantages.
Statistical Methodology, 6(1), 70-81.
}
\seealso{
\code{\link[gamlss]{gamlss}} for generalized additive models for location, scale, and shape.

\code{\link[betareg]{betareg}} for beta regression, another approach for modeling bounded data.

\code{\link[zoib]{zoib}} for zero-one inflated beta regression models.
}
\author{
Lopes, J. E.
}
