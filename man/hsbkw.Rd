% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{hsbkw}
\alias{hsbkw}
\title{Analytic Hessian Matrix for Beta-Kumaraswamy Distribution}
\usage{
hsbkw(par, data)
}
\arguments{
\item{par}{Numeric vector of length 4 containing the parameters
(α, β, γ, δ) in that order. All parameters must be positive.}

\item{data}{Numeric vector of observations, where all values must be
in the open interval (0,1).}
}
\value{
A 4×4 numeric matrix representing the Hessian of the negative
log-likelihood function. If parameters or data are invalid
(parameters ≤ 0 or data outside (0,1)), returns a matrix of
NaN values.
}
\description{
Computes the analytic Hessian matrix of the log-likelihood function for
the Beta-Kumaraswamy (BKw) distribution. This function provides
exact second derivatives needed for optimization and inference.
}
\details{
The log-likelihood for the Beta-Kumaraswamy distribution is:

\deqn{
\ell(\theta) = n \ln(\alpha) + n \ln(\beta) - n \ln B(\gamma, \delta+1)
+ (\alpha-1) \sum \ln(x_i)
+ (\beta(\delta+1)-1) \sum \ln(1 - x_i^\alpha)
+ (\gamma-1) \sum \ln\{1 - (1 - x_i^\alpha)^\beta\}
}

where λ is fixed at 1 for this distribution.

The implementation computes all second derivatives analytically for each term.
For computational efficiency, the following transformations are used:
\itemize{
\item \deqn{A = x^α} and derivatives
\item \deqn{v = 1 - A}
\item \deqn{w = 1 - v^β}
}

The returned Hessian matrix has the following structure:
\itemize{
\item Rows/columns 1-4 correspond to α, β, γ, δ respectively
\item The matrix is symmetric (as expected for a Hessian)
\item The matrix represents second derivatives of the negative log-likelihood
}

This function is implemented in C++ for computational efficiency.
}
\examples{
\dontrun{
# Generate sample data from a BKw distribution
set.seed(123)
x <- rbkw(100, 2, 3, 1, 0.5)
hist(x, breaks = 20, main = "BKw(2, 3, 1, 0.5) Sample")

# Use in optimization with Hessian-based methods
result <- optim(c(0.5, 0.5, 0.5, 0.5), llbkw, method = "BFGS",
                hessian = TRUE, data = x)

# Compare numerical and analytical derivatives
num_grad <- numDeriv::grad(llbkw, x = result$par, data = x)
num_hess <- numDeriv::hessian(llbkw, x = result$par, data = x)

ana_grad <- grbkw(result$par, data = x)
ana_hess <- hsbkw(result$par, data = x)

# Check differences (should be very small)
round(num_grad - ana_grad, 4)
round(num_hess - ana_hess, 4)

}

}
\references{
Kumaraswamy, P. (1980). A generalized probability density function for double-bounded random processes.
Journal of Hydrology, 46(1-2), 79-88.

Cordeiro, G. M., & de Castro, M. (2011). A new family of generalized distributions.
Journal of Statistical Computation and Simulation, 81(7), 883-898.
}
\seealso{
\code{\link[gkwreg]{dbkw}} for the BKw density function,
\code{\link[gkwreg]{bkwreg}} for fitting BKw regression models,
\code{\link[gkwreg]{pbkw}} for the BKw cumulative distribution function
}
