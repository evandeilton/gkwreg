% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/RcppExports.R
\name{hskkw}
\alias{hskkw}
\title{Analytic Hessian Matrix for Kumaraswamy-Kumaraswamy Distribution}
\usage{
hskkw(par, data)
}
\arguments{
\item{par}{Numeric vector of length 4 containing the parameters
(α, β, δ, λ) in that order. All parameters must be positive.}

\item{data}{Numeric vector of observations, where all values must be
in the open interval (0,1).}
}
\value{
A 4×4 numeric matrix representing the Hessian of the negative
log-likelihood function. If parameters or data are invalid
(parameters ≤ 0 or data outside (0,1)), returns a matrix of
NaN values.
}
\description{
Computes the analytic Hessian matrix of the log-likelihood function for
the Kumaraswamy-Kumaraswamy (KKw) distribution. This function provides
exact second derivatives needed for optimization and inference.
}
\details{
The log-likelihood for the Kumaraswamy-Kumaraswamy distribution is:

\deqn{
\ell(\theta) = n \ln(\lambda) + n \ln(\alpha) + n \ln(\beta) + n \ln(\delta+1)
+ (\alpha-1) \sum \ln(x_i)
+ (\beta-1) \sum \ln(1 - x_i^\alpha)
+ (\lambda-1) \sum \ln\{1 - (1 - x_i^\alpha)^\beta\}
+ \delta \sum \ln\{1 - \{1 - (1 - x_i^\alpha)^\beta\}^\lambda\}
}

where γ is fixed at 1 for this distribution.

The implementation computes all second derivatives analytically for each term.
For computational efficiency, the following transformations are used:
\itemize{
\item \deqn{A = x^α} and derivatives
\item \deqn{v = 1 - A}
\item \deqn{w = 1 - v^β}
  \item \deqn{z = 1 - w^λ}
}

The returned Hessian matrix has the following structure:
\itemize{
\item Rows/columns 1-4 correspond to α, β, δ, λ respectively
\item The matrix is symmetric (as expected for a Hessian)
\item The matrix represents second derivatives of the negative log-likelihood
}

This function is implemented in C++ for computational efficiency.
}
\examples{
\dontrun{
# Generate sample data from a KKw distribution
set.seed(123)
x <- rkkw(100, 2, 3, 1.5, 0.5)
hist(x, breaks = 20, main = "KKw(2, 3, 1.5, 0.5) Sample")

# Use in optimization with Hessian-based methods
result <- optim(c(0.5, 0.5, 0.5, 0.5), llkkw, method = "BFGS",
                hessian = TRUE, data = x)

# Compare numerical and analytical derivatives
num_grad <- numDeriv::grad(llkkw, x = result$par, data = x)
num_hess <- numDeriv::hessian(llkkw, x = result$par, data = x)

ana_grad <- grkkw(result$par, data = x)
ana_hess <- hskkw(result$par, data = x)

# Check differences (should be very small)
round(num_grad - ana_grad, 4)
round(num_hess - ana_hess, 4)
}


}
\references{
Kumaraswamy, P. (1980). A generalized probability density function for double-bounded random processes.
Journal of Hydrology, 46(1-2), 79-88.

Cordeiro, G. M., & de Castro, M. (2011). A new family of generalized distributions.
Journal of Statistical Computation and Simulation, 81(7), 883-898.
}
