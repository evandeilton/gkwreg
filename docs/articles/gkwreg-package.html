<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Generalized Kumaraswamy Regression Models • gkwreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Generalized Kumaraswamy Regression Models">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gkwreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/gkwreg-package.html">Generalized Kumaraswamy Regression Models</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Generalized Kumaraswamy Regression Models</h1>
                        <h4 data-toc-skip class="author">Lopes, J.
E.</h4>
            
            <h4 data-toc-skip class="date">2025-03-24</h4>
      

      <div class="hidden name"><code>gkwreg-package.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>gkwreg</code> package implements statistical models based
on the Generalized Kumaraswamy (GKw) distribution for continuous data
bounded in the open unit interval (0,1). This package provides two main
components:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Distribution fitting</strong> (<code>gkwfit</code>): Maximum
likelihood estimation for all seven models in the GKw family</li>
<li>
<strong>Regression modeling</strong> (<code>gkwreg</code>): A
framework that models all five distribution parameters as functions of
covariates</li>
</ol>
<p>The implementations use C++ with RcppArmadillo and Template Model
Builder (TMB) for efficient parameter estimation via automatic
differentiation.</p>
<div class="section level3">
<h3 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h3>
<p>Data bounded in the (0,1) interval are common in various fields:</p>
<ul>
<li>Rates and proportions (e.g., infection rates, voting
proportions)</li>
<li>Normalized indices (e.g., economic indices, environmental
measures)</li>
<li>Probabilities (e.g., chance of an event)</li>
<li>Fractional measures (e.g., chemical concentrations)</li>
</ul>
<p>While beta-regression models are popular for this type of data, the
Generalized Kumaraswamy distribution offers greater flexibility to
capture various shapes and asymmetries, with the ability to model
unimodal, bimodal, J-shaped, inverted J-shaped, U-shaped distributions,
with different levels of kurtosis and skewness.</p>
</div>
</div>
<div class="section level2">
<h2 id="mathematical-foundation">Mathematical Foundation<a class="anchor" aria-label="anchor" href="#mathematical-foundation"></a>
</h2>
<div class="section level3">
<h3 id="special-functions">Special Functions<a class="anchor" aria-label="anchor" href="#special-functions"></a>
</h3>
<p>Before introducing the distributions, we briefly review the special
functions used:</p>
<div class="section level4">
<h4 id="gamma-function">Gamma Function<a class="anchor" aria-label="anchor" href="#gamma-function"></a>
</h4>
<p>The Gamma function is an extension of the factorial for real and
complex numbers:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mi>∞</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mi>e</mi><mrow><mi>−</mi><mi>t</mi></mrow></msup><mi>d</mi><mi>t</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>a</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\Gamma(a) = \int_0^{\infty} t^{a-1}e^{-t}dt, \quad a &gt; 0</annotation></semantics></math></p>
<p>Important properties: -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>a</mi><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Gamma(a+1) = a\Gamma(a)</annotation></semantics></math>
-
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>n</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mi>!</mi></mrow><annotation encoding="application/x-tex">\Gamma(n) = (n-1)!</annotation></semantics></math>
for positive integer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
-
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msqrt><mi>π</mi></msqrt></mrow><annotation encoding="application/x-tex">\Gamma(1/2) = \sqrt{\pi}</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="beta-function">Beta Function<a class="anchor" aria-label="anchor" href="#beta-function"></a>
</h4>
<p>The Beta function is defined in terms of the Gamma function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>+</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><mo>=</mo><msubsup><mo>∫</mo><mn>0</mn><mn>1</mn></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi><mo>,</mo><mspace width="1.0em"></mspace><mi>a</mi><mo>,</mo><mi>b</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">B(a,b) = \frac{\Gamma(a)\Gamma(b)}{\Gamma(a+b)} = \int_0^1 t^{a-1}(1-t)^{b-1}dt, \quad a,b &gt; 0</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="regularized-incomplete-beta-function">Regularized Incomplete Beta Function<a class="anchor" aria-label="anchor" href="#regularized-incomplete-beta-function"></a>
</h4>
<p>The regularized incomplete Beta function is defined as:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>x</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msubsup><mo>∫</mo><mn>0</mn><mi>x</mi></msubsup><msup><mi>t</mi><mrow><mi>a</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>t</mi><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>b</mi><mo>−</mo><mn>1</mn></mrow></msup><mi>d</mi><mi>t</mi><mo>,</mo><mspace width="1.0em"></mspace><mn>0</mn><mo>≤</mo><mi>x</mi><mo>≤</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">I_x(a,b) = \frac{1}{B(a,b)}\int_0^x t^{a-1}(1-t)^{b-1}dt, \quad 0 \leq x \leq 1</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="digamma-function">Digamma Function<a class="anchor" aria-label="anchor" href="#digamma-function"></a>
</h4>
<p>The Digamma function (ψ) is the logarithmic derivative of the Gamma
function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>d</mi><mrow><mi>d</mi><mi>a</mi></mrow></mfrac><mo>ln</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>Γ</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">\psi(a) = \frac{d}{da}\ln\Gamma(a) = \frac{\Gamma'(a)}{\Gamma(a)}</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="trigamma-function">Trigamma Function<a class="anchor" aria-label="anchor" href="#trigamma-function"></a>
</h4>
<p>The Trigamma function (ψ’) is the derivative of the Digamma
function:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ψ</mi><mi>′</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><msup><mi>d</mi><mn>2</mn></msup><mrow><mi>d</mi><msup><mi>a</mi><mn>2</mn></msup></mrow></mfrac><mo>ln</mo><mi>Γ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mi>d</mi><mrow><mi>d</mi><mi>a</mi></mrow></mfrac><mi>ψ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\psi'(a) = \frac{d^2}{da^2}\ln\Gamma(a) = \frac{d}{da}\psi(a)</annotation></semantics></math></p>
</div>
</div>
<div class="section level3">
<h3 id="the-generalized-kumaraswamy-distribution-gkw">The Generalized Kumaraswamy Distribution (GKw)<a class="anchor" aria-label="anchor" href="#the-generalized-kumaraswamy-distribution-gkw"></a>
</h3>
<p>The GKw distribution, introduced by Cordeiro and de Castro (2011), is
a flexible five-parameter family for bounded continuous random
variables. For a random variable
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Y</mi><mo>∈</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo>,</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">Y \in (0,1)</annotation></semantics></math>,
the probability density function (PDF) of the GKw distribution is:</p>
<p><span class="math display">$$f(y; \alpha, \beta, \gamma, \delta,
\lambda) = \frac{\lambda \alpha \beta y^{\alpha-1}
(1-y^\alpha)^{\beta-1}}{B(\gamma, \delta+1)}
\Bigl[1-(1-y^\alpha)^\beta\Bigr]^{\gamma\lambda-1}
\Bigl\{1-\Bigl[1-(1-y^\alpha)^\beta\Bigr]^\lambda\Bigr\}^{\delta}$$</span></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha, \beta, \gamma, \delta, \lambda &gt; 0</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">B(\gamma, \delta+1)</annotation></semantics></math>
is the complete Beta function.</p>
<p>The cumulative distribution function (CDF) is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>;</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>I</mi><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>λ</mi></msup></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">F(y; \alpha, \beta, \gamma, \delta, \lambda) = I_{[1-(1-y^\alpha)^\beta]^\lambda}(\gamma, \delta+1)</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>I</mi><mi>z</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>a</mi><mo>,</mo><mi>b</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">I_z(a,b)</annotation></semantics></math>
is the regularized incomplete Beta function.</p>
<div class="section level4">
<h4 id="auxiliary-transformations">Auxiliary Transformations<a class="anchor" aria-label="anchor" href="#auxiliary-transformations"></a>
</h4>
<p>To simplify derivations, we define the following transformations:</p>
<ul>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi><mo>=</mo><msup><mi>y</mi><mi>α</mi></msup></mrow><annotation encoding="application/x-tex">A = y^{\alpha}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>v</mi><mo>=</mo><mn>1</mn><mo>−</mo><mi>A</mi><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup></mrow><annotation encoding="application/x-tex">v = 1 - A = 1 - y^{\alpha}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>w</mi><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>v</mi><mi>β</mi></msup><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup></mrow><annotation encoding="application/x-tex">w = 1 - v^{\beta} = 1 - (1 - y^{\alpha})^{\beta}</annotation></semantics></math></li>
<li><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi><mo>=</mo><mn>1</mn><mo>−</mo><msup><mi>w</mi><mi>λ</mi></msup><mo>=</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>λ</mi></msup></mrow><annotation encoding="application/x-tex">z = 1 - w^{\lambda} = 1 - [1 - (1 - y^{\alpha})^{\beta}]^{\lambda}</annotation></semantics></math></li>
</ul>
</div>
<div class="section level4">
<h4 id="gkw-log-likelihood">GKw Log-Likelihood<a class="anchor" aria-label="anchor" href="#gkw-log-likelihood"></a>
</h4>
<p>The log-likelihood function for a sample of size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>n</mi><annotation encoding="application/x-tex">n</annotation></semantics></math>
is:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>ℓ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>n</mi><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>n</mi><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mi>n</mi><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>n</mi><mo>ln</mo><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>ln</mo><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>y</mi><mi>i</mi><mi>α</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mi>λ</mi><mo>−</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>ln</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>y</mi><mi>i</mi><mi>α</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="false" form="postfix">}</mo><mo>+</mo><mi>δ</mi><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mo>ln</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msubsup><mi>y</mi><mi>i</mi><mi>α</mi></msubsup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><msup><mo stretchy="false" form="postfix">}</mo><mi>λ</mi></msup><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\ell(\theta) = n\ln(\lambda) + n\ln(\alpha) + n\ln(\beta) - n\ln B(\gamma, \delta+1) + (\alpha-1) \sum_{i=1}^n \ln(y_i) + (\beta-1) \sum_{i=1}^n \ln(1 - y_i^\alpha) + (\gamma\lambda - 1) \sum_{i=1}^n \ln\{1 - (1 - y_i^\alpha)^\beta\} + \delta \sum_{i=1}^n \ln\{1 - \{1 - (1 - y_i^\alpha)^\beta\}^\lambda\}</annotation></semantics></math></p>
<p>where
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>θ</mi><mo>=</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\theta = (\alpha, \beta, \gamma, \delta, \lambda)</annotation></semantics></math>
is the parameter vector.</p>
</div>
</div>
<div class="section level3">
<h3 id="distribution-hierarchy">Distribution Hierarchy<a class="anchor" aria-label="anchor" href="#distribution-hierarchy"></a>
</h3>
<p>The GKw distribution encompasses a hierarchy of nested distributions
through parameter constraints:</p>
<div class="section level4">
<h4 id="generalized-kumaraswamy-distribution-gkw">1. Generalized Kumaraswamy Distribution (GKw)<a class="anchor" aria-label="anchor" href="#generalized-kumaraswamy-distribution-gkw"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha, \beta, \gamma, \delta, \lambda &gt; 0</annotation></semantics></math></p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo>;</mo><mi>θ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi><mi>α</mi><mi>β</mi></mrow><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>y</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>γ</mi><mi>λ</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>λ</mi></msup><msup><mo stretchy="false" form="postfix">}</mo><mi>δ</mi></msup></mrow><annotation encoding="application/x-tex">f(y;\theta) = \frac{\lambda\alpha\beta}{B(\gamma,\delta+1)}y^{\alpha-1}(1 - y^\alpha)^{\beta-1}[1 - (1 - y^\alpha)^\beta]^{\gamma\lambda-1}\{1 - [1 - (1 - y^\alpha)^\beta]^\lambda\}^\delta</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="beta-kumaraswamy-distribution-bkw">2. Beta-Kumaraswamy Distribution (BKw)<a class="anchor" aria-label="anchor" href="#beta-kumaraswamy-distribution-bkw"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha, \beta, \gamma, \delta &gt; 0</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>λ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\lambda = 1</annotation></semantics></math>
fixed</p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>α</mi><mi>β</mi></mrow><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>y</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>γ</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">f(y) = \frac{\alpha\beta}{B(\gamma,\delta+1)}y^{\alpha-1}(1 - y^\alpha)^{\beta(\delta+1)-1}[1 - (1 - y^\alpha)^\beta]^{\gamma-1}</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="kumaraswamy-kumaraswamy-distribution-kkw">3. Kumaraswamy-Kumaraswamy Distribution (KKw)<a class="anchor" aria-label="anchor" href="#kumaraswamy-kumaraswamy-distribution-kkw"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha, \beta, \delta, \lambda &gt; 0</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma = 1</annotation></semantics></math>
fixed</p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>λ</mi><mi>α</mi><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow><msup><mi>y</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>λ</mi><mo>−</mo><mn>1</mn></mrow></msup><mo stretchy="false" form="prefix">{</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mi>λ</mi></msup><msup><mo stretchy="false" form="postfix">}</mo><mi>δ</mi></msup></mrow><annotation encoding="application/x-tex">f(y) = \lambda\alpha\beta(\delta+1)y^{\alpha-1}(1 - y^\alpha)^{\beta-1}[1 - (1 - y^\alpha)^\beta]^{\lambda-1}\{1 - [1 - (1 - y^\alpha)^\beta]^\lambda\}^\delta</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="exponentiated-kumaraswamy-distribution-ekw">4. Exponentiated Kumaraswamy Distribution (EKw)<a class="anchor" aria-label="anchor" href="#exponentiated-kumaraswamy-distribution-ekw"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha, \beta, \lambda &gt; 0</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma = 1, \delta = 0</annotation></semantics></math>
fixed</p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>λ</mi><mi>α</mi><mi>β</mi><msup><mi>y</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">[</mo><mn>1</mn><mo>−</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>β</mi></msup><mo stretchy="true" form="postfix">]</mo></mrow><mrow><mi>λ</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">f(y) = \lambda\alpha\beta y^{\alpha-1}(1 - y^\alpha)^{\beta-1}[1 - (1 - y^\alpha)^\beta]^{\lambda-1}</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="mcdonald-distribution-mc-or-beta-power">5. McDonald Distribution (Mc) or Beta Power<a class="anchor" aria-label="anchor" href="#mcdonald-distribution-mc-or-beta-power"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma, \delta, \lambda &gt; 0</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 1, \beta = 1</annotation></semantics></math>
fixed</p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mrow><mi>λ</mi><mi>γ</mi></mrow><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>y</mi><mrow><mi>λ</mi><mi>γ</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>λ</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mi>δ</mi></msup></mrow><annotation encoding="application/x-tex">f(y) = \frac{\lambda\gamma}{B(\gamma,\delta+1)}y^{\lambda\gamma-1}(1 - y^\lambda)^\delta</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="kumaraswamy-distribution-kw">6. Kumaraswamy Distribution (Kw)<a class="anchor" aria-label="anchor" href="#kumaraswamy-distribution-kw"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>,</mo><mi>β</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha, \beta &gt; 0</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>δ</mi><mo>=</mo><mn>0</mn><mo>,</mo><mi>λ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\gamma = 1, \delta = 0, \lambda = 1</annotation></semantics></math>
fixed</p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi><mi>β</mi><msup><mi>y</mi><mrow><mi>α</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><msup><mi>y</mi><mi>α</mi></msup><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mi>β</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">f(y) = \alpha\beta y^{\alpha-1}(1 - y^\alpha)^{\beta-1}</annotation></semantics></math></p>
</div>
<div class="section level4">
<h4 id="beta-distribution">7. Beta Distribution<a class="anchor" aria-label="anchor" href="#beta-distribution"></a>
</h4>
<p><strong>Parameters</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\gamma, \delta &gt; 0</annotation></semantics></math>,
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>β</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>λ</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\alpha = 1, \beta = 1, \lambda = 1</annotation></semantics></math>
fixed</p>
<p><strong>Density</strong>:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mrow><mi>B</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>+</mo><mn>1</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac><msup><mi>y</mi><mrow><mi>γ</mi><mo>−</mo><mn>1</mn></mrow></msup><msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>y</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>δ</mi></msup></mrow><annotation encoding="application/x-tex">f(y) = \frac{1}{B(\gamma,\delta+1)}y^{\gamma-1}(1 - y)^\delta</annotation></semantics></math></p>
<p>This nested structure enables model selection through likelihood
ratio tests, starting with the most complex model (GKw) and potentially
simplifying to more parsimonious forms when appropriate.</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="regression-framework">Regression Framework<a class="anchor" aria-label="anchor" href="#regression-framework"></a>
</h2>
<div class="section level3">
<h3 id="gkw-regression-model">GKw Regression Model<a class="anchor" aria-label="anchor" href="#gkw-regression-model"></a>
</h3>
<p>The GKw regression model extends the GKw distribution by modeling
each parameter as a function of covariates:</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mi>i</mi></msub><mo>=</mo><msubsup><mi>g</mi><mi>θ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><msubsup><mi>𝐱</mi><mrow><mi>θ</mi><mi>i</mi></mrow><mi>T</mi></msubsup><msub><mi>𝛃</mi><mi>θ</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mspace width="1.0em"></mspace><mi>θ</mi><mo>∈</mo><mo stretchy="false" form="prefix">{</mo><mi>α</mi><mo>,</mo><mi>β</mi><mo>,</mo><mi>γ</mi><mo>,</mo><mi>δ</mi><mo>,</mo><mi>λ</mi><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\theta_i = g_\theta^{-1}(\mathbf{x}_{\theta i}^T \boldsymbol{\beta}_\theta), \quad \theta \in \{\alpha, \beta, \gamma, \delta, \lambda\}</annotation></semantics></math></p>
<p>where: -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝐱</mi><mrow><mi>θ</mi><mi>i</mi></mrow></msub><annotation encoding="application/x-tex">\mathbf{x}_{\theta i}</annotation></semantics></math>
is the covariate vector for observation
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
and parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math>
-
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>𝛃</mi><mi>θ</mi></msub><annotation encoding="application/x-tex">\boldsymbol{\beta}_\theta</annotation></semantics></math>
is the corresponding coefficient vector -
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>g</mi><mi>θ</mi><mrow><mi>−</mi><mn>1</mn></mrow></msubsup><annotation encoding="application/x-tex">g_\theta^{-1}</annotation></semantics></math>
is the inverse link function for parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>θ</mi><annotation encoding="application/x-tex">\theta</annotation></semantics></math></p>
</div>
<div class="section level3">
<h3 id="link-functions">Link Functions<a class="anchor" aria-label="anchor" href="#link-functions"></a>
</h3>
<p>The package supports nine inverse link functions:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Log</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \exp(\eta)</annotation></semantics></math>
</li>
<li>
<strong>Logit</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">scale</mtext><mo>⋅</mo><mfrac><mrow><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \text{scale} \cdot \frac{\exp(\eta)}{1+\exp(\eta)}</annotation></semantics></math>
</li>
<li>
<strong>Probit</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">scale</mtext><mo>⋅</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \text{scale} \cdot \Phi(\eta)</annotation></semantics></math>
</li>
<li>
<strong>Cauchy</strong>: <span class="math inline">$g^{-1}(\eta) =
\text{scale} \cdot \Bigl(\frac{1}{\pi}\arctan(\eta) +
\frac{1}{2}\Bigr)$</span>
</li>
<li>
<strong>Cloglog</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mtext mathvariant="normal">scale</mtext><mo>⋅</mo><mo minsize="1.2" maxsize="1.2" stretchy="false" form="prefix">(</mo><mn>1</mn><mo>−</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>−</mi><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mo minsize="1.2" maxsize="1.2" stretchy="false" form="postfix">)</mo></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \text{scale} \cdot \bigl(1 - \exp(-\exp(\eta))\bigr)</annotation></semantics></math>
</li>
<li>
<strong>Identity</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>η</mi></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \eta</annotation></semantics></math>
</li>
<li>
<strong>Square Root</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msup><mi>η</mi><mn>2</mn></msup></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \eta^2</annotation></semantics></math>
</li>
<li>
<strong>Inverse</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><mi>η</mi></mfrac></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \frac{1}{\eta}</annotation></semantics></math>
</li>
<li>
<strong>Inverse-Square</strong>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>g</mi><mrow><mi>−</mi><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>η</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mfrac><mn>1</mn><msqrt><mi>η</mi></msqrt></mfrac></mrow><annotation encoding="application/x-tex">g^{-1}(\eta) = \frac{1}{\sqrt{\eta}}</annotation></semantics></math>
</li>
</ol>
<p>The <code>scale</code> parameter allows rescaling bounded link
functions (logit, probit, cauchy, cloglog) to appropriate parameter
ranges.</p>
</div>
<div class="section level3">
<h3 id="model-specification-via-formula">Model Specification via Formula<a class="anchor" aria-label="anchor" href="#model-specification-via-formula"></a>
</h3>
<p>The model is specified through a multi-part formula:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">~</span> <span class="va">alpha_terms</span> <span class="op">|</span> <span class="va">beta_terms</span> <span class="op">|</span> <span class="va">gamma_terms</span> <span class="op">|</span> <span class="va">delta_terms</span> <span class="op">|</span> <span class="va">lambda_terms</span></span></code></pre></div>
<p>Each right-hand side part corresponds to the linear predictor for the
respective parameter. If fewer than five parts are provided, the missing
parts are treated as intercept-only models.</p>
</div>
</div>
<div class="section level2">
<h2 id="distribution-fitting-with-gkwfit">Distribution Fitting with gkwfit()<a class="anchor" aria-label="anchor" href="#distribution-fitting-with-gkwfit"></a>
</h2>
<p>The <code><a href="../reference/gkwfit.html">gkwfit()</a></code> function implements maximum likelihood
estimation for the GKw distribution family. It supports two estimation
methods: Template Model Builder (TMB) and Newton-Raphson (NR).</p>
<div class="section level3">
<h3 id="basic-usage">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage"></a>
</h3>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate sample data (from a Beta distribution for simplicity)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">200</span>, shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit full GKw model</span></span>
<span><span class="va">fit_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">x</span>, family <span class="op">=</span> <span class="st">"gkw"</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit a simpler Kumaraswamy model</span></span>
<span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">x</span>, family <span class="op">=</span> <span class="st">"kw"</span>, , profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_gkw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_kw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare models with AIC/BIC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_gkw</span>, <span class="va">fit_kw</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fit_gkw</span>, <span class="va">fit_kw</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Visualize fit</span></span>
<span><span class="va">fit_kw</span><span class="op">$</span><span class="va">plots</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="key-parameters">Key Parameters<a class="anchor" aria-label="anchor" href="#key-parameters"></a>
</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gkw"</span>, <span class="st">"bkw"</span>, <span class="st">"kkw"</span>, <span class="st">"ekw"</span>, <span class="st">"mc"</span>, <span class="st">"kw"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span>
<span>       start <span class="op">=</span> <span class="cn">NULL</span>, fixed <span class="op">=</span> <span class="cn">NULL</span>, fit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nr"</span>, <span class="st">"tmb"</span><span class="op">)</span>,</span>
<span>       method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nlminb"</span>, <span class="st">"optim"</span><span class="op">)</span>, use_moments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>       hessian <span class="op">=</span> <span class="cn">TRUE</span>, profile <span class="op">=</span> <span class="cn">FALSE</span>, npoints <span class="op">=</span> <span class="fl">20</span>,</span>
<span>       plot <span class="op">=</span> <span class="cn">TRUE</span>, conf.level <span class="op">=</span> <span class="fl">0.95</span>, optimizer.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>       submodels <span class="op">=</span> <span class="cn">FALSE</span>, silent <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>data</code>: Numeric vector with values in the (0, 1)
interval</li>
<li>
<code>family</code>: Distribution family (one of “gkw”, “bkw”,
“kkw”, “ekw”, “mc”, “kw”, “beta”)</li>
<li>
<code>start</code>: Optional list with initial parameter values</li>
<li>
<code>fixed</code>: Optional list of parameters to be held fixed
(not estimated)</li>
<li>
<code>fit</code>: Estimation method (“tmb” or “nr”)</li>
<li>
<code>method</code>: Optimization method when using TMB (“nlminb” or
“optim”)</li>
<li>
<code>use_moments</code>: Logical; if TRUE, uses method of moments
for initial values</li>
<li>
<code>hessian</code>: Logical; if TRUE, computes standard errors and
covariance matrix</li>
<li>
<code>profile</code>: Logical; if TRUE, computes likelihood profiles
for parameters</li>
<li>
<code>submodels</code>: Logical; if TRUE, fits nested submodels for
comparison</li>
<li>
<code>plot</code>: Logical; if TRUE, generates diagnostic plots</li>
</ul>
</div>
<div class="section level3">
<h3 id="example-comparing-distribution-families">Example: Comparing Distribution Families<a class="anchor" aria-label="anchor" href="#example-comparing-distribution-families"></a>
</h3>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Generate data from a mixture of two beta distributions</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">4567</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1000</span>, <span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">5</span>, <span class="fl">1.5</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit multiple distribution families</span></span>
<span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">family</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gkw"</span>, <span class="st">"bkw"</span>, <span class="st">"kkw"</span>, <span class="st">"ekw"</span>, <span class="st">"mc"</span>, <span class="st">"kw"</span>, <span class="st">"beta"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">models</span><span class="op">[[</span><span class="va">family</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">x</span>, family <span class="op">=</span> <span class="va">family</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, fit <span class="op">=</span> <span class="st">"tmb"</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Compare models</span></span>
<span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  Family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span>
<span>  LogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">logLik</span><span class="op">)</span>,</span>
<span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">AIC</span><span class="op">)</span>,</span>
<span>  BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">BIC</span><span class="op">)</span>,</span>
<span>  Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">m</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine best model</span></span>
<span><span class="va">best_family</span> <span class="op">&lt;-</span> <span class="va">model_comparison</span><span class="op">$</span><span class="va">Family</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">models</span><span class="op">[[</span><span class="va">best_family</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">models</span><span class="op">[[</span><span class="va">best_family</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">plots</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="practical-example">Practical Example<a class="anchor" aria-label="anchor" href="#practical-example"></a>
</h3>
<p>Let’s fit some distributions to a simulated dataset:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create artificial data sample in the (0,1) interval</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">2000</span>, shape1 <span class="op">=</span> <span class="fl">2</span>, shape2 <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit models</span></span>
<span><span class="va">fit_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"beta"</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">fit_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwfit.html">gkwfit</a></span><span class="op">(</span><span class="va">data</span>, family <span class="op">=</span> <span class="st">"gkw"</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Summary of the best model (GKw)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_gkw</span><span class="op">)</span></span>
<span><span class="co">#&gt; Generalized Kumaraswamy Distribution Fit</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; gkwfit(data = data, family = "gkw", profile = TRUE, plot = TRUE, </span></span>
<span><span class="co">#&gt;     silent = TRUE)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt;        Estimate Std. Error z value Pr(&gt;|z|)    </span></span>
<span><span class="co">#&gt; alpha    1.3213     0.2832   4.666 3.07e-06 ***</span></span>
<span><span class="co">#&gt; beta     1.1899         NA      NA       NA    </span></span>
<span><span class="co">#&gt; gamma    1.1231     0.1827   6.147 7.87e-10 ***</span></span>
<span><span class="co">#&gt; delta    1.5497         NA      NA       NA    </span></span>
<span><span class="co">#&gt; lambda   1.2208     0.2837   4.304 1.68e-05 ***</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Log-likelihood: 445.4305</span></span>
<span><span class="co">#&gt; AIC: -880.8610</span></span>
<span><span class="co">#&gt; BIC: -852.8565</span></span>
<span><span class="co">#&gt; AICc: -880.8309</span></span>
<span><span class="co">#&gt; Number of observations: 2000</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Goodness-of-fit test:</span></span>
<span><span class="co">#&gt;   Kolmogorov-Smirnov test: D = 0.01163 , p-value = 0.9496</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Confidence intervals (95%):</span></span>
<span><span class="co">#&gt;        Estimate  Lower Upper</span></span>
<span><span class="co">#&gt; alpha     1.321 0.7663 1.876</span></span>
<span><span class="co">#&gt; gamma     1.123 0.7650 1.481</span></span>
<span><span class="co">#&gt; lambda    1.221 0.6648 1.777</span></span>
<span></span>
<span><span class="co"># Comparison via AIC</span></span>
<span><span class="va">aic_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  beta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_beta</span><span class="op">)</span>,</span>
<span>  kw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_kw</span><span class="op">)</span>,</span>
<span>  gkw <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_gkw</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">aic_values</span><span class="op">)</span></span>
<span><span class="co">#&gt;      beta        kw       gkw </span></span>
<span><span class="co">#&gt; -887.2814 -885.8459 -880.8610</span></span>
<span></span>
<span><span class="va">fit_beta</span><span class="op">$</span><span class="va">plots</span></span>
<span><span class="co">#&gt; $histogram</span></span></code></pre></div>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-1.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pp_plot</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-2.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qq_plot</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-3.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_gamma</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-4.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_delta</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-5.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_kw</span><span class="op">$</span><span class="va">plots</span></span>
<span><span class="co">#&gt; $histogram</span></span></code></pre></div>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-6.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pp_plot</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-7.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qq_plot</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-8.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_alpha</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-9.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_beta</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-10.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">fit_gkw</span><span class="op">$</span><span class="va">plots</span></span>
<span><span class="co">#&gt; $histogram</span></span></code></pre></div>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-11.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $pp_plot</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-12.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $qq_plot</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-13.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_alpha</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-14.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_beta</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-15.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_gamma</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-16.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_delta</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-17.png" width="672" style="display: block; margin: auto;"></p>
<pre><code><span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $profile_lambda</span></span></code></pre>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-3-18.png" width="672" style="display: block; margin: auto;"></p>
</div>
</div>
<div class="section level2">
<h2 id="regression-modeling-with-gkwreg">Regression Modeling with gkwreg()<a class="anchor" aria-label="anchor" href="#regression-modeling-with-gkwreg"></a>
</h2>
<p>The <code><a href="../reference/gkwreg.html">gkwreg()</a></code> function implements the GKw regression
framework, allowing all five distribution parameters to be modeled as
functions of covariates.</p>
<div class="section level3">
<h3 id="basic-usage-1">Basic Usage<a class="anchor" aria-label="anchor" href="#basic-usage-1"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">5000</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate parameters as functions of covariates</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x1</span><span class="op">)</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.0</span> <span class="op">-</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x2</span><span class="op">)</span></span>
<span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span> <span class="co"># Fixed at 1</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="va">n</span><span class="op">)</span> <span class="co"># Fixed at 0</span></span>
<span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span>, <span class="va">n</span><span class="op">)</span> <span class="co"># Fixed at 1</span></span>
<span></span>
<span><span class="co"># Generate response (simplified for this example - actually Kumaraswamy)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">beta</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">alpha</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit model (Kumaraswamy with covariates for alpha and beta)</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># All log links</span></span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine model</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Diagnostic plots</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Predictions</span></span>
<span><span class="co"># new_data &lt;- data.frame(x1 = c(-1, 2, 1), x2 = c(-0.5, 1, 0.5))</span></span>
<span><span class="co"># predict(model, newdata = new_data, type = "response")</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="key-parameters-1">Key Parameters<a class="anchor" aria-label="anchor" href="#key-parameters-1"></a>
</h3>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">formula</span>, <span class="va">data</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>, scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>       start <span class="op">=</span> <span class="cn">NULL</span>, control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>, weights <span class="op">=</span> <span class="cn">NULL</span>, subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"na.action"</span>, <span class="va">na.omit</span><span class="op">)</span>, offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>       model <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="cn">TRUE</span>, y <span class="op">=</span> <span class="cn">TRUE</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>
<code>formula</code>: Formula object in the form
<code>y ~ alpha_terms | beta_terms | gamma_terms | delta_terms | lambda_terms</code>
</li>
<li>
<code>data</code>: Data frame containing the variables in the
formula</li>
<li>
<code>link</code>: Numeric vector of length 5 specifying the link
function for each parameter</li>
<li>
<code>scale</code>: Numeric vector of length 5 with scale factors
for link functions 2-5</li>
<li>
<code>start</code>: Optional list with initial values for regression
coefficients</li>
<li>
<code>control</code>: List of control parameters for
optimization</li>
<li>
<code>offset</code>: Optional vector of offsets for the alpha
parameter</li>
</ul>
</div>
<div class="section level3">
<h3 id="complete-example-modeling-with-group-effects">Complete Example: Modeling with Group Effects<a class="anchor" aria-label="anchor" href="#complete-example-modeling-with-group-effects"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate data with varying shapes</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create four groups with different distributions</span></span>
<span><span class="va">group</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group 1: Right-skewed</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span>, <span class="fl">1.5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group 2: Left-skewed</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span>, <span class="fl">5</span>, <span class="fl">1.5</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group 3: Symmetric</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Group 4: Bimodal</span></span>
<span><span class="va">idx</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">y</span><span class="op">[</span><span class="va">idx</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">8</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">idx</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span>, <span class="fl">8</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Add continuous effect</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0.8</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame with one-hot encoding for group</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  x <span class="op">=</span> <span class="va">x</span>,</span>
<span>  g2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  g3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  g4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">group</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit model with group effects on all shape parameters</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">g2</span> <span class="op">+</span> <span class="va">g3</span> <span class="op">+</span> <span class="va">g4</span> <span class="op">|</span> <span class="va">g2</span> <span class="op">+</span> <span class="va">g3</span> <span class="op">+</span> <span class="va">g4</span> <span class="op">|</span> <span class="va">g2</span> <span class="op">+</span> <span class="va">g3</span> <span class="op">+</span> <span class="va">g4</span> <span class="op">|</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Examine results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="simulated-example-income-distribution-by-education-level">Simulated Example: Income Distribution by Education Level<a class="anchor" aria-label="anchor" href="#simulated-example-income-distribution-by-education-level"></a>
</h3>
<p>Let’s simulate income proportions (income divided by maximum income
in the sample) by education level:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate income proportion data (income/max_income)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span>
<span></span>
<span><span class="co"># Create education level factor (1-4)</span></span>
<span><span class="va">education</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="va">n</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Simulate income proportion based on education level</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># Higher education levels have higher mean income proportion</span></span>
<span>  <span class="co"># and different shapes of distribution</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">education</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.2</span>, <span class="fl">4</span><span class="op">)</span> <span class="co"># Lower education: right skewed, low mean</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">education</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1.8</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># Some higher education: less skewed</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="va">education</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2.5</span>, <span class="fl">2.5</span><span class="op">)</span> <span class="co"># Bachelor's: symmetric</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">y</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">4</span>, <span class="fl">2</span><span class="op">)</span> <span class="co"># Graduate degree: left skewed, high mean</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Create additional covariates</span></span>
<span><span class="va">age</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">25</span>, <span class="fl">65</span><span class="op">)</span></span>
<span><span class="va">experience</span> <span class="op">&lt;-</span> <span class="va">age</span> <span class="op">-</span> <span class="fl">20</span> <span class="op">-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">education</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="co"># Rough proxy for work experience</span></span>
<span></span>
<span><span class="co"># Add age and experience effects</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0.7</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">(</span><span class="va">age</span> <span class="op">-</span> <span class="fl">40</span><span class="op">)</span> <span class="op">/</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span> <span class="co"># Age effect</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="fl">0.8</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="op">(</span><span class="va">experience</span> <span class="op">-</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="co"># Experience effect</span></span>
<span></span>
<span><span class="co"># Add random noise and ensure within (0,1)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">0.8</span>, <span class="fl">1.2</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">0.001</span><span class="op">)</span>, <span class="fl">0.999</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create data frame with dummy variables for education</span></span>
<span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  y <span class="op">=</span> <span class="va">y</span>,</span>
<span>  age <span class="op">=</span> <span class="va">age</span>,</span>
<span>  experience <span class="op">=</span> <span class="va">experience</span>,</span>
<span>  ed2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  ed3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="fl">3</span><span class="op">)</span>,</span>
<span>  ed4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="va">education</span> <span class="op">==</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Fit GKw model</span></span>
<span><span class="va">income_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">age</span> <span class="op">+</span> <span class="va">experience</span> <span class="op">+</span> <span class="va">ed2</span> <span class="op">+</span> <span class="va">ed3</span> <span class="op">+</span> <span class="va">ed4</span> <span class="op">|</span> <span class="va">ed2</span> <span class="op">+</span> <span class="va">ed3</span> <span class="op">+</span> <span class="va">ed4</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Checking TMB model status for  gkwreg ...</span></span>
<span><span class="co">#&gt; Found TMB source file:  /home/jlopes/R/x86_64-pc-linux-gnu-library/4.4/gkwreg/tmb/gkwreg.cpp </span></span>
<span><span class="co">#&gt; Found cached TMB model:  /home/jlopes/.cache/gkwreg/tmb_cache/R4.4/1.0.1.9000/gkwreg.so </span></span>
<span><span class="co">#&gt; Successfully loaded cached TMB model.</span></span>
<span><span class="co">#&gt; Symbols registered:</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">income_model</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Generalized Kumaraswamy Regression Model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; gkwreg(formula = y ~ age + experience + ed2 + ed3 + ed4 | ed2 + </span></span>
<span><span class="co">#&gt;     ed3 + ed4 | 1 | 1 | 1, data = data, link = c(1, 1, 1, 1, </span></span>
<span><span class="co">#&gt;     1))</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Deviance Residuals:</span></span>
<span><span class="co">#&gt;      Min       1Q   Median       3Q      Max </span></span>
<span><span class="co">#&gt; -0.33978 -0.09125  0.02528  0.14690  0.55243 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; alpha (Link function: log, Scale factor: 10)</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)  0.01337        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; age         -0.08499        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; experience   0.09847        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; ed2          0.40115        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; ed3          0.99484        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; ed4          1.43842        NaN     NaN      NaN</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; beta (Link function: log, Scale factor: 10)</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; (Intercept)   0.8287     0.3797   2.183   0.0291 *</span></span>
<span><span class="co">#&gt; ed2          -0.1118     0.1316  -0.849   0.3957  </span></span>
<span><span class="co">#&gt; ed3          -0.1611     0.1480  -1.089   0.2762  </span></span>
<span><span class="co">#&gt; ed4          -0.1818     0.1530  -1.188   0.2348  </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; gamma (Link function: log, Scale factor: 10)</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)  -0.8024     0.9419  -0.852    0.394</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; delta (Link function: log, Scale factor: 10)</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)</span></span>
<span><span class="co">#&gt; (Intercept)   -1.123      1.373  -0.818    0.413</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; lambda (Link function: log, Scale factor: 10)</span></span>
<span><span class="co">#&gt;             Estimate Std. Error z value Pr(&gt;|z|)  </span></span>
<span><span class="co">#&gt; (Intercept)    2.827      1.431   1.975   0.0482 *</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; (Parameter optimization via TMB)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Residual deviance: -419.7  on 487 degrees of freedom</span></span>
<span><span class="co">#&gt; AIC: -393.7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Additional Statistics:</span></span>
<span><span class="co">#&gt;   Log-likelihood: 209.9 </span></span>
<span><span class="co">#&gt;   BIC: -338.9 </span></span>
<span><span class="co">#&gt;   RMSE: 0.1682 </span></span>
<span><span class="co">#&gt;   Efron's R2: 0.3903 </span></span>
<span><span class="co">#&gt;   Mean Absolute Error: 0.1342 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Cache Performance:</span></span>
<span><span class="co">#&gt;   Cache metrics not available</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Number of optimization iterations: 63 (converged)</span></span>
<span></span>
<span><span class="co"># Examine model diagnostics</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">income_model</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="gkwreg-package_files/figure-html/unnamed-chunk-6-1.png" width="672" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Create prediction grid for education levels</span></span>
<span><span class="va">pred_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">4</span><span class="op">)</span>, <span class="co"># Set age to 40</span></span>
<span>  experience <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">4</span><span class="op">)</span>, <span class="co"># Set experience to 20 years</span></span>
<span>  ed2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  ed3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  ed4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Get predicted parameters</span></span>
<span><span class="va">pred_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">income_model</span>, type <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span></span>
<span><span class="co"># print(pred_params)</span></span>
<span></span>
<span><span class="co"># Predicted means</span></span>
<span><span class="va">pred_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">income_model</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span>
<span><span class="co"># print(pred_means)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="advanced-topics">Advanced Topics<a class="anchor" aria-label="anchor" href="#advanced-topics"></a>
</h2>
<div class="section level3">
<h3 id="computational-considerations">Computational Considerations<a class="anchor" aria-label="anchor" href="#computational-considerations"></a>
</h3>
<ol style="list-style-type: decimal">
<li>
<strong>Starting Values</strong>: For complex models, providing good
starting values can significantly improve convergence:</li>
</ol>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with custom starting values</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">age</span> <span class="op">|</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">ed2</span> <span class="op">|</span> <span class="va">ed3</span> <span class="op">|</span> <span class="va">ed4</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  start <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    beta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>, <span class="co"># For alpha: intercept and x1 coefficient</span></span>
<span>    beta2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="op">-</span><span class="fl">0.4</span><span class="op">)</span>, <span class="co"># For beta: intercept and x2 coefficient</span></span>
<span>    beta3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="op">-</span><span class="fl">2.0</span><span class="op">)</span>, <span class="co"># For gamma: intercept only</span></span>
<span>    beta4 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span>, <span class="co"># For delta: intercept and x3 coefficient</span></span>
<span>    beta5 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="op">-</span><span class="fl">1</span><span class="op">)</span> <span class="co"># For lambda: intercept only</span></span>
<span>  <span class="op">)</span>, silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>
<strong>Optimization Control</strong>: Tuning the optimization
parameters can help with difficult convergence cases:</li>
</ol>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with custom control parameters</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">age</span> <span class="op">|</span> <span class="va">experience</span> <span class="op">|</span> <span class="va">ed2</span> <span class="op">|</span> <span class="va">ed3</span> <span class="op">|</span> <span class="va">ed4</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    optimizer <span class="op">=</span> <span class="st">"nlminb"</span>, <span class="co"># Use nlminb optimizer</span></span>
<span>    eval.max <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># Maximum function evaluations</span></span>
<span>    iter.max <span class="op">=</span> <span class="fl">10000</span>, <span class="co"># Maximum iterations</span></span>
<span>    rel.tol <span class="op">=</span> <span class="fl">1e-10</span>, <span class="co"># Relative tolerance</span></span>
<span>    abs.tol <span class="op">=</span> <span class="fl">1e-15</span>, <span class="co"># Absolute tolerance</span></span>
<span>    inner.method <span class="op">=</span> <span class="st">"newton"</span>, <span class="co"># TMB internal method</span></span>
<span>    inner.maxit <span class="op">=</span> <span class="fl">5000</span>, <span class="co"># Maximum internal iterations</span></span>
<span>    smartsearch <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Smart search in TMB</span></span>
<span>    openmp <span class="op">=</span> <span class="cn">TRUE</span> <span class="co"># Use OpenMP if available</span></span>
<span>  <span class="op">)</span>, silent <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>
<strong>Link Function Selection</strong>: Different link functions
can be more appropriate for different parameters:</li>
</ol>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Example with different link functions for each parameter</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span></span>
<span>  formula <span class="op">=</span> <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="fl">1</span>,</span>
<span>  data <span class="op">=</span> <span class="va">data</span>,</span>
<span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">7</span>, <span class="fl">1</span><span class="op">)</span>, <span class="co"># log, logit, log, sqrt, log</span></span>
<span>  scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span><span class="op">)</span> <span class="co"># Scale factors for bounded links</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="residual-analysis">Residual Analysis<a class="anchor" aria-label="anchor" href="#residual-analysis"></a>
</h3>
<p>The <code><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals()</a></code> function for <code>gkwreg</code> objects
supports multiple types of residuals:</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Types of residuals available</span></span>
<span><span class="va">resid_types</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="st">"response"</span>, <span class="st">"pearson"</span>, <span class="st">"deviance"</span>, <span class="st">"quantile"</span>,</span>
<span>  <span class="st">"modified.deviance"</span>, <span class="st">"cox-snell"</span>, <span class="st">"score"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Generate and plot different residual types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">type</span> <span class="kw">in</span> <span class="va">resid_types</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">resid</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/residuals.html" class="external-link">residuals</a></span><span class="op">(</span><span class="va">model</span>, type <span class="op">=</span> <span class="va">type</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">fitted.values</span>, <span class="va">resid</span>,</span>
<span>    main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">type</span>, <span class="st">"residuals"</span><span class="op">)</span>,</span>
<span>    xlab <span class="op">=</span> <span class="st">"Fitted values"</span>, ylab <span class="op">=</span> <span class="st">"Residuals"</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>h <span class="op">=</span> <span class="fl">0</span>, lty <span class="op">=</span> <span class="fl">2</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p>For diagnostic purposes, quantile residuals are often most
appropriate for bounded data models as they approximate a standard
normal distribution when the model is correctly specified.</p>
</div>
<div class="section level3">
<h3 id="model-comparisons">Model Comparisons<a class="anchor" aria-label="anchor" href="#model-comparisons"></a>
</h3>
<p>Nested models can be compared using likelihood ratio tests:</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Full model with covariates for all parameters</span></span>
<span><span class="va">model_full</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Reduced model with covariates only for alpha and beta</span></span>
<span><span class="va">model_reduced</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">data</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Likelihood ratio test</span></span>
<span><span class="va">lr_stat</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">model_full</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></span><span class="op">(</span><span class="va">model_reduced</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">df_diff</span> <span class="op">&lt;-</span> <span class="va">model_full</span><span class="op">$</span><span class="va">npar</span> <span class="op">-</span> <span class="va">model_reduced</span><span class="op">$</span><span class="va">npar</span></span>
<span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">lr_stat</span>, df <span class="op">=</span> <span class="va">df_diff</span>, lower.tail <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"LR statistic:"</span>, <span class="va">lr_stat</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Degrees of freedom:"</span>, <span class="va">df_diff</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"p-value:"</span>, <span class="va">p_value</span>, <span class="st">"\n"</span><span class="op">)</span></span></code></pre></div>
<p>Non-nested models can be compared using information criteria:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare different specifications using AIC/BIC</span></span>
<span><span class="va">model_log</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">data</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">model_logit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">data</span>, link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">model_log</span>, <span class="va">model_logit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">model_log</span>, <span class="va">model_logit</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="implementation-details">Implementation Details<a class="anchor" aria-label="anchor" href="#implementation-details"></a>
</h2>
<div class="section level3">
<h3 id="parameter-estimation">Parameter Estimation<a class="anchor" aria-label="anchor" href="#parameter-estimation"></a>
</h3>
<p>The <code><a href="../reference/gkwfit.html">gkwfit()</a></code> function implements maximum likelihood
estimation (MLE) for the GKw distribution family using either TMB or
Newton-Raphson:</p>
<ol style="list-style-type: decimal">
<li>
<p><strong>TMB Method</strong>: Uses automatic differentiation for
highly efficient gradient and Hessian computation.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># TMB implementation example</span></span>
<span><span class="fu">TMB</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></span><span class="op">(</span></span>
<span>  data <span class="op">=</span> <span class="va">tmb_data</span>,</span>
<span>  parameters <span class="op">=</span> <span class="va">params</span>,</span>
<span>  DLL <span class="op">=</span> <span class="va">dll_name</span>,</span>
<span>  silent <span class="op">=</span> <span class="va">control</span><span class="op">$</span><span class="va">tmb.silent</span>,</span>
<span>  method <span class="op">=</span> <span class="va">control</span><span class="op">$</span><span class="va">inner.method</span>,</span>
<span>  hessian <span class="op">=</span> <span class="va">control</span><span class="op">$</span><span class="va">hessian</span></span>
<span><span class="op">)</span></span></code></pre></div>
</li>
<li>
<p><strong>Newton-Raphson Method</strong>: Direct implementation
using analytical gradients and Hessian.</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gradient calculation for parameter alpha using GKw distribution</span></span>
<span><span class="va">grad_alpha</span> <span class="op">&lt;-</span> <span class="va">n</span><span class="op">/</span><span class="va">alpha</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> </span>
<span>  <span class="op">(</span><span class="va">beta</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="op">(</span><span class="va">gamma</span><span class="op">*</span><span class="va">lambda</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">beta</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">beta</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">)</span><span class="op">^</span><span class="va">beta</span><span class="op">)</span><span class="op">)</span> <span class="op">-</span> </span>
<span>  <span class="va">delta</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">lambda</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">)</span><span class="op">^</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">lambda</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">beta</span><span class="op">*</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="va">beta</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">^</span><span class="va">alpha</span><span class="op">)</span><span class="op">^</span><span class="va">beta</span><span class="op">)</span><span class="op">^</span><span class="va">lambda</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</li>
</ol>
</div>
<div class="section level3">
<h3 id="diagnostic-tools">Diagnostic Tools<a class="anchor" aria-label="anchor" href="#diagnostic-tools"></a>
</h3>
<p>The package provides comprehensive diagnostic tools:</p>
<ol style="list-style-type: decimal">
<li>
<strong>P-P and Q-Q Plots</strong>: For assessing distributional
fit</li>
<li>
<strong>Residual Plots</strong>: Multiple residual types to check
model assumptions</li>
<li>
<strong>Profile Likelihood Plots</strong>: For uncertainty
visualization</li>
<li>
<strong>Leverage and Influence Diagnostics</strong>: To identify
influential observations</li>
</ol>
</div>
<div class="section level3">
<h3 id="numerical-stability">Numerical Stability<a class="anchor" aria-label="anchor" href="#numerical-stability"></a>
</h3>
<p>The implementation includes several features to enhance numerical
stability:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Boundary Handling</strong>: Automatic adjustment of
observations near 0 or 1</li>
<li>
<strong>Parameter Constraints</strong>: Enforcement of positivity
constraints</li>
<li>
<strong>Optimization Safeguards</strong>: Step size control and
parameter scaling</li>
<li>
<strong>Log Transformation</strong>: Working with log-parameters to
ensure positivity</li>
</ol>
</div>
</div>
<div class="section level2">
<h2 id="best-practices-and-recommendations">Best Practices and Recommendations<a class="anchor" aria-label="anchor" href="#best-practices-and-recommendations"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<strong>Model Building Strategy</strong>:
<ul>
<li>Start with simpler models (fewer covariates, fewer parameters) and
gradually increase complexity</li>
<li>Test for the need of the full 5-parameter GKw distribution by
comparing with simpler subfamilies</li>
<li>Consider different link functions for different parameters</li>
</ul>
</li>
<li>
<strong>Numerical Stability</strong>:
<ul>
<li>Ensure data is strictly within (0, 1) - the package handles this
automatically but preprocessing can be helpful</li>
<li>Scale covariates to similar ranges to improve optimization</li>
<li>Start with log links before trying more complex link functions</li>
</ul>
</li>
<li>
<strong>Interpretation</strong>:
<ul>
<li>The parameters have different interpretations in the GKw
distribution:
<ul>
<li>α and β: Primary shape parameters (similar to Kumaraswamy)</li>
<li>γ and δ: Secondary shape parameters (similar to Beta)</li>
<li>λ: Additional shape parameter</li>
</ul>
</li>
<li>The mean of the distribution is a complex function of all
parameters, so direct parameter interpretation can be challenging</li>
<li>Use the <code><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict()</a></code> function with
<code>type = "response"</code> to estimate conditional means</li>
</ul>
</li>
<li>
<strong>Performance Considerations</strong>:
<ul>
<li>For large datasets, ensure sufficient memory is available</li>
<li>Consider using OpenMP parallelization (set
<code>control = list(openmp = TRUE)</code>)</li>
<li>For complex models, set <code>silent = TRUE</code> to reduce output
verbosity</li>
</ul>
</li>
</ol>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of
generalized distributions. <em>Journal of Statistical Computation and
Simulation</em>, 81(7), 883-898.</p>
<p>Kumaraswamy, P. (1980). A generalized probability density function
for double-bounded random processes. <em>Journal of Hydrology</em>,
46(1-2), 79-88.</p>
<p>Jones, M. C. (2009). Kumaraswamy’s distribution: A beta-type
distribution with some tractability advantages. <em>Statistical
Methodology</em>, 6(1), 70-81.</p>
<p>Kristensen, K., Nielsen, A., Berg, C. W., Skaug, H., &amp; Bell, B.
M. (2016). TMB: Automatic differentiation and Laplace approximation.
<em>Journal of Statistical Software</em>, 70(5), 1-21.</p>
<p>Cribari-Neto, F., &amp; Zeileis, A. (2010). Beta regression in R.
<em>Journal of Statistical Software</em>, 34(2), 1-24.</p>
<p>Ferrari, S. L. P., &amp; Cribari-Neto, F. (2004). Beta regression for
modelling rates and proportions. <em>Journal of Applied Statistics</em>,
31(7), 799-815.</p>
<p>Smithson, M., &amp; Verkuilen, J. (2006). A better lemon squeezer?
Maximum-likelihood regression with beta-distributed dependent variables.
<em>Psychological Methods</em>, 11(1), 54-71.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Lopes J. L..</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer>
</div>






  </body>
</html>
