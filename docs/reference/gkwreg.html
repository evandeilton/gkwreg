<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Fit Generalized Kumaraswamy Regression Models — gkwreg • gkwreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Generalized Kumaraswamy Regression Models — gkwreg"><meta property="og:description" content="Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for response variables strictly bounded in the interval (0, 1).
The function allows modeling parameters from all seven submodels of the GKw
family as functions of predictors using appropriate link functions. Estimation
is performed using Maximum Likelihood via the TMB (Template Model Builder) package.
Requires the Formula and TMB packages."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gkwreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Fit Generalized Kumaraswamy Regression Models</h1>

    <div class="hidden name"><code>gkwreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for response variables strictly bounded in the interval (0, 1).
The function allows modeling parameters from all seven submodels of the GKw
family as functions of predictors using appropriate link functions. Estimation
is performed using Maximum Likelihood via the TMB (Template Model Builder) package.
Requires the <code>Formula</code> and <code>TMB</code> packages.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gkwreg</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gkw"</span>, <span class="st">"bkw"</span>, <span class="st">"kkw"</span>, <span class="st">"ekw"</span>, <span class="st">"mc"</span>, <span class="st">"kw"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fit <span class="op">=</span> <span class="st">"tmb"</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nlminb"</span>, <span class="st">"optim"</span><span class="op">)</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  optimizer.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"na.action"</span><span class="op">)</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An object of class <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> (or one that
can be coerced to that class). It should be structured as
<code>y ~ model_alpha | model_beta | model_gamma | model_delta | model_lambda</code>,
where <code>y</code> is the response variable and each <code>model_*</code> part specifies
the linear predictor for the corresponding parameter (\(\alpha\), \(\beta\),
\(\gamma\), \(\delta\), \(\lambda\)). If a part is omitted or specified
as <code>~ 1</code> or <code>.</code>, an intercept-only model is used for that parameter.
See Details for parameter correspondence in subfamilies.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables specified in the <code>formula</code>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the desired distribution family.
Defaults to <code>"gkw"</code>. Supported families are:</p><ul><li><p><code>"gkw"</code>: Generalized Kumaraswamy (5 parameters: \(\alpha, \beta, \gamma, \delta, \lambda\))</p></li>
<li><p><code>"bkw"</code>: Beta-Kumaraswamy (4 parameters: \(\alpha, \beta, \gamma, \delta\); \(\lambda = 1\) fixed)</p></li>
<li><p><code>"kkw"</code>: Kumaraswamy-Kumaraswamy (4 parameters: \(\alpha, \beta, \delta, \lambda\); \(\gamma = 1\) fixed)</p></li>
<li><p><code>"ekw"</code>: Exponentiated Kumaraswamy (3 parameters: \(\alpha, \beta, \lambda\); \(\gamma = 1, \delta = 0\) fixed)</p></li>
<li><p><code>"mc"</code>: McDonald / Beta Power (3 parameters: \(\gamma, \delta, \lambda\); \(\alpha = 1, \beta = 1\) fixed)</p></li>
<li><p><code>"kw"</code>: Kumaraswamy (2 parameters: \(\alpha, \beta\); \(\gamma = 1, \delta = 0, \lambda = 1\) fixed)</p></li>
<li><p><code>"beta"</code>: Beta distribution (2 parameters: \(\gamma, \delta\); \(\alpha = 1, \beta = 1, \lambda = 1\) fixed)</p></li>
</ul></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Either a single character string specifying the same link function
for all relevant parameters, or a named list specifying the link function for each
modeled parameter (e.g., <code>list(alpha = "log", beta = "log", delta = "logit")</code>).
Defaults are <code>"log"</code> for \(\alpha, \beta, \gamma, \lambda\) (parameters &gt; 0)
and <code>"logit"</code> for \(\delta\) (parameter in (0, 1)).
Supported link functions are:</p><ul><li><p><code>"log"</code></p></li>
<li><p><code>"logit"</code></p></li>
<li><p><code>"identity"</code></p></li>
<li><p><code>"inverse"</code> (i.e., 1/mu)</p></li>
<li><p><code>"sqrt"</code></p></li>
<li><p><code>"probit"</code></p></li>
<li><p><code>"cloglog"</code> (complementary log-log)</p></li>
</ul></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>An optional named list providing initial values for the regression
coefficients. Parameter names should match the distribution parameters (alpha,
beta, etc.), and values should be vectors corresponding to the coefficients
in the respective linear predictors (including intercept). If <code>NULL</code>
(default), suitable starting values are automatically determined based on
global parameter estimates.</p></dd>


<dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p>An optional named list specifying parameters or coefficients to be
held fixed at specific values during estimation. Currently not fully implemented.</p></dd>


<dt id="arg-fit">fit<a class="anchor" aria-label="anchor" href="#arg-fit"></a></dt>
<dd><p>Character string specifying the estimation engine. Currently, only
<code>"tmb"</code> (Template Model Builder) is supported and required.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying the optimization algorithm used by TMB.
Options are <code>"nlminb"</code> (default, using <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>) or
<code>"optim"</code> (using <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> with <code>method = "BFGS"</code>).</p></dd>


<dt id="arg-hessian">hessian<a class="anchor" aria-label="anchor" href="#arg-hessian"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the Hessian matrix is computed
via <code><a href="https://rdrr.io/pkg/TMB/man/sdreport.html" class="external-link">sdreport</a></code> to obtain standard errors and the covariance
matrix of the estimated coefficients. Setting to <code>FALSE</code> speeds up fitting
but prevents calculation of standard errors and confidence intervals.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), enables the generation of diagnostic
plots when calling the generic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function on the fitted object.
Actual plotting is handled by the <code>plot.gkwreg</code> method.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Numeric. The confidence level (1 - alpha) for constructing
confidence intervals for the parameters. Default is 0.95. Used only if
<code>hessian = TRUE</code>.</p></dd>


<dt id="arg-optimizer-control">optimizer.control<a class="anchor" aria-label="anchor" href="#arg-optimizer-control"></a></dt>
<dd><p>A list of control parameters passed directly to the
chosen optimizer (<code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> or <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).
See their respective documentation for details.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>An optional vector specifying a subset of observations from <code>data</code>
to be used in the fitting process.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>An optional vector of prior weights (e.g., frequency weights)
to be used in the fitting process. Should be <code>NULL</code> or a numeric vector
of non-negative values.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>An optional numeric vector or matrix specifying an a priori known
component to be included <em>on the scale of the linear predictor</em> for each parameter.
If a vector, it's applied to the predictor of the first parameter in the standard
order (\(\alpha\)). If a matrix, columns must correspond to parameters in the
order \(\alpha, \beta, \gamma, \delta, \lambda\).</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>A function which indicates what should happen when the data
contain <code>NA</code>s. The default (<code>na.fail</code>) stops if <code>NA</code>s are
present. Other options include <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> or
<code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code>.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>An optional list specifying the contrasts to be used for factor
variables in the model. See the <code>contrasts.arg</code> of
<code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix.default</a></code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the list of model matrices (one for each modeled
parameter) is returned as component <code>x</code> of the fitted object. Default <code>FALSE</code>.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the response variable (after processing
by <code>na.action</code>, <code>subset</code>) is returned as component <code>y</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the model frame (containing all
variables used from <code>data</code>) is returned as component <code>model</code>.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), suppresses progress messages
from TMB compilation and optimization. Set to <code>FALSE</code> for verbose output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments, currently unused or passed down to internal
methods (potentially).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>An object of class <code>gkwreg</code>. This is a list containing the
following components:</p>
<dl><dt>call</dt>
<dd><p>The matched function call.</p></dd>

<dt>family</dt>
<dd><p>The specified distribution family string.</p></dd>

<dt>formula</dt>
<dd><p>The <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> object used.</p></dd>

<dt>coefficients</dt>
<dd><p>A named vector of estimated regression coefficients.</p></dd>

<dt>fitted.values</dt>
<dd><p>Vector of estimated means (expected values) of the response.</p></dd>

<dt>residuals</dt>
<dd><p>Vector of response residuals (observed - fitted mean).</p></dd>

<dt>fitted_parameters</dt>
<dd><p>List containing the estimated mean value for each distribution parameter (\(\alpha, \beta, \gamma, \delta, \lambda\)).</p></dd>

<dt>parameter_vectors</dt>
<dd><p>List containing vectors of the estimated parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) for each observation, evaluated on the link scale.</p></dd>

<dt>link</dt>
<dd><p>List of link functions used for each parameter.</p></dd>

<dt>param_names</dt>
<dd><p>Character vector of names of the parameters modeled by the family.</p></dd>

<dt>fixed_params</dt>
<dd><p>Named list indicating which parameters are fixed by the family definition.</p></dd>

<dt>loglik</dt>
<dd><p>The maximized log-likelihood value.</p></dd>

<dt>aic</dt>
<dd><p>Akaike Information Criterion.</p></dd>

<dt>bic</dt>
<dd><p>Bayesian Information Criterion.</p></dd>

<dt>deviance</dt>
<dd><p>The deviance ( -2 * loglik ).</p></dd>

<dt>df.residual</dt>
<dd><p>Residual degrees of freedom (nobs - npar).</p></dd>

<dt>nobs</dt>
<dd><p>Number of observations used in the fit.</p></dd>

<dt>npar</dt>
<dd><p>Total number of estimated parameters (coefficients).</p></dd>

<dt>vcov</dt>
<dd><p>The variance-covariance matrix of the coefficients (if <code>hessian = TRUE</code>).</p></dd>

<dt>se</dt>
<dd><p>Standard errors of the coefficients (if <code>hessian = TRUE</code>).</p></dd>

<dt>convergence</dt>
<dd><p>Convergence code from the optimizer (0 typically indicates success).</p></dd>

<dt>message</dt>
<dd><p>Convergence message from the optimizer.</p></dd>

<dt>iterations</dt>
<dd><p>Number of iterations used by the optimizer.</p></dd>

<dt>rmse</dt>
<dd><p>Root Mean Squared Error of response residuals.</p></dd>

<dt>efron_r2</dt>
<dd><p>Efron's pseudo R-squared.</p></dd>

<dt>mean_absolute_error</dt>
<dd><p>Mean Absolute Error of response residuals.</p></dd>

<dt>x</dt>
<dd><p>List of model matrices (if <code>x = TRUE</code>).</p></dd>

<dt>y</dt>
<dd><p>The response vector (if <code>y = TRUE</code>).</p></dd>

<dt>model</dt>
<dd><p>The model frame (if <code>model = TRUE</code>).</p></dd>

<dt>tmb_object</dt>
<dd><p>The raw object returned by <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></code>.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>The <code>gkwreg</code> function provides a regression framework for the Generalized
Kumaraswamy (GKw) family and its submodels, extending density estimation
to include covariates. The response variable must be strictly bounded in the
(0, 1) interval.</p>
<p><strong>Model Specification:</strong>
The extended <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> syntax is crucial for specifying
potentially different linear predictors for each relevant distribution parameter.
The parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) correspond sequentially
to the parts of the formula separated by <code>|</code>. For subfamilies where some
parameters are fixed by definition (see <code>family</code> argument), the corresponding
parts of the formula are automatically ignored. For example, in a <code>family = "kw"</code>
model, only the first two parts (for \(\alpha\) and \(\beta\)) are relevant.</p>
<p><strong>Parameter Constraints and Link Functions:</strong>
The parameters \(\alpha, \beta, \gamma, \lambda\) are constrained to be positive,
while \(\delta\) is constrained to the interval (0, 1). The default link functions
(<code>"log"</code> for positive parameters, <code>"logit"</code> for \(\delta\)) ensure these
constraints during estimation. Users can specify alternative link functions suitable
for the parameter's domain via the <code>link</code> argument.</p>
<p><strong>Families and Parameters:</strong>
The function automatically handles parameter fixing based on the chosen <code>family</code>:</p><ul><li><p><strong>GKw</strong>: All 5 parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) modeled.</p></li>
<li><p><strong>BKw</strong>: Models \(\alpha, \beta, \gamma, \delta\); fixes \(\lambda = 1\).</p></li>
<li><p><strong>KKw</strong>: Models \(\alpha, \beta, \delta, \lambda\); fixes \(\gamma = 1\).</p></li>
<li><p><strong>EKw</strong>: Models \(\alpha, \beta, \lambda\); fixes \(\gamma = 1, \delta = 0\).</p></li>
<li><p><strong>Mc</strong> (McDonald): Models \(\gamma, \delta, \lambda\); fixes \(\alpha = 1, \beta = 1\).</p></li>
<li><p><strong>Kw</strong> (Kumaraswamy): Models \(\alpha, \beta\); fixes \(\gamma = 1, \delta = 0, \lambda = 1\).</p></li>
<li><p><strong>Beta</strong>: Models \(\gamma, \delta\); fixes \(\alpha = 1, \beta = 1, \lambda = 1\). This parameterization corresponds to the standard Beta distribution with shape1 = \(\gamma\) and shape2 = \(\delta\).</p></li>
</ul><p><strong>Estimation Engine:</strong>
Maximum Likelihood Estimation (MLE) is performed using C++ templates via the
<code>TMB</code> package, which provides automatic differentiation and efficient
optimization capabilities. The specific TMB template used depends on the chosen <code>family</code>.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Kumaraswamy, P. (1980). A generalized probability density function for double-bounded
random processes. <em>Journal of Hydrology</em>, <strong>46</strong>(1-2), 79-88.
<a href="https://doi.org/10.1016/0022-1694%2880%2990036-0" class="external-link">doi:10.1016/0022-1694(80)90036-0</a></p>
<p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of generalized distributions.
<em>Journal of Statistical Computation and Simulation</em>, <strong>81</strong>(7), 883-898.
<a href="https://doi.org/10.1080/00949650903530745" class="external-link">doi:10.1080/00949650903530745</a></p>
<p>Ferrari, S. L. P., &amp; Cribari-Neto, F. (2004). Beta regression for modelling rates and
proportions. <em>Journal of Applied Statistics</em>, <strong>31</strong>(7), 799-815.
<a href="https://doi.org/10.1080/0266476042000214501" class="external-link">doi:10.1080/0266476042000214501</a></p>
<p>Kristensen, K., Nielsen, A., Berg, C. W., Skaug, H., &amp; Bell, B. M. (2016). TMB:
Automatic Differentiation and Laplace Approximation. <em>Journal of Statistical
Software</em>, <strong>70</strong>(5), 1-21. <a href="https://doi.org/10.18637/jss.v070.i05" class="external-link">doi:10.18637/jss.v070.i05</a>

(Underlying TMB package)</p>
<p>Zeileis, A., Kleiber, C., Jackman, S. (2008). Regression Models for Count Data in R.
<em>Journal of Statistical Software</em>, <strong>27</strong>(8), 1-25.
<a href="https://doi.org/10.18637/jss.v027.i08" class="external-link">doi:10.18637/jss.v027.i08</a>
 (Discusses <code>Formula</code> package)</p>
<p>Smithson, M., &amp; Verkuilen, J. (2006). A Better Lemon Squeezer? Maximum-Likelihood
Regression with Beta-Distributed Dependent Variables. <em>Psychological Methods</em>,
<strong>11</strong>(1), 54–71. <a href="https://doi.org/10.1037/1082-989X.11.1.54" class="external-link">doi:10.1037/1082-989X.11.1.54</a></p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="summary.gkwreg.html">summary.gkwreg</a></code>, <code><a href="predict.gkwreg.html">predict.gkwreg</a></code>,
<code><a href="plot.gkwreg.html">plot.gkwreg</a></code>, <code><a href="coef.gkwreg.html">coef.gkwreg</a></code>, <code><a href="vcov.gkwreg.html">vcov.gkwreg</a></code>,
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code>,
<code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code>, <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></code>,
<code><a href="https://rdrr.io/pkg/TMB/man/sdreport.html" class="external-link">sdreport</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lopes, J. E.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load required packages (assuming they are installed)</span></span></span>
<span class="r-in"><span><span class="co"># require(gkwreg) # Assuming this package provides rgkw, rkw</span></span></span>
<span class="r-in"><span><span class="co"># require(stats)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 1: Simple Kumaraswamy regression model ----</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># Reduced N for faster example execution</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True regression coefficients</span></span></span>
<span class="r-in"><span><span class="va">alpha_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span> <span class="co"># Intercept, x1, x2</span></span></span>
<span class="r-in"><span><span class="va">beta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Intercept, x1, x2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate linear predictors and transform to parameters using inverse link (exp)</span></span></span>
<span class="r-in"><span><span class="va">eta_alpha</span> <span class="op">&lt;-</span> <span class="va">alpha_coef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha_coef</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">alpha_coef</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">eta_beta</span> <span class="op">&lt;-</span> <span class="va">beta_coef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta_coef</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">beta_coef</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">alpha_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta_alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate responses from Kumaraswamy distribution (assuming rkw is available)</span></span></span>
<span class="r-in"><span><span class="co"># Replace rkw with relevant function if needed (e.g., from this package)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"rkw"</span>, mode <span class="op">=</span> <span class="st">"function"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">alpha_true</span>, beta <span class="op">=</span> <span class="va">beta_true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Placeholder if rkw is not available in the environment</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"rkw function not found, generating approximate data."</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n</span>, shape1 <span class="op">=</span> <span class="va">alpha_true</span>, shape2 <span class="op">=</span> <span class="va">beta_true</span><span class="op">)</span> <span class="co"># Approximation</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1e-7</span><span class="op">)</span>, <span class="fl">1e-7</span><span class="op">)</span> <span class="co"># Ensure y is strictly in (0, 1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Kumaraswamy regression model using extended formula syntax</span></span></span>
<span class="r-in"><span><span class="co"># Model alpha ~ x1 + x2 and beta ~ x1 + x2</span></span></span>
<span class="r-in"><span><span class="va">kw_reg</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df1</span>, family <span class="op">=</span> <span class="st">"kw"</span>, silent <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">kw_reg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot diagnostics (requires plot.gkwreg method)</span></span></span>
<span class="r-in"><span><span class="co"># plot(kw_reg)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2: Generalized Kumaraswamy regression ----</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">150</span> <span class="co"># Reduced N</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Factor variable</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True regression coefficients</span></span></span>
<span class="r-in"><span><span class="va">alpha_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="co"># Intercept, x1</span></span></span>
<span class="r-in"><span><span class="va">beta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Intercept, x1, x2</span></span></span>
<span class="r-in"><span><span class="va">gamma_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span> <span class="co"># Intercept, x3B</span></span></span>
<span class="r-in"><span><span class="va">delta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="co"># Intercept, x3B (logit scale)</span></span></span>
<span class="r-in"><span><span class="va">lambda_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Intercept, x2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Design matrices</span></span></span>
<span class="r-in"><span><span class="va">X_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x3</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x3</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x2</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate linear predictors and transform to parameters</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_alpha</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">alpha_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_beta</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_gamma</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gamma_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">X_delta</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">delta_coef</span><span class="op">)</span> <span class="co"># logit link for delta</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_lambda</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">lambda_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response from GKw distribution (assuming rgkw is available)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"rgkw"</span>, mode <span class="op">=</span> <span class="st">"function"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, gamma <span class="op">=</span> <span class="va">gamma</span>, delta <span class="op">=</span> <span class="va">delta</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="st">"rgkw function not found, skipping GKw data generation."</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1e-7</span><span class="op">)</span>, <span class="fl">1e-7</span><span class="op">)</span> <span class="co"># Ensure y is strictly in (0, 1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Create data frame</span></span></span>
<span class="r-in"><span>  <span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Fit GKw regression with parameter-specific formulas</span></span></span>
<span class="r-in"><span>  <span class="co"># alpha ~ x1, beta ~ x1 + x2, gamma ~ x3, delta ~ x3, lambda ~ x2</span></span></span>
<span class="r-in"><span>  <span class="va">gkw_reg</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df2</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare true vs. estimated coefficients</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Estimated Coefficients (GKw):"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">gkw_reg</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"True Coefficients (approx):"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="va">alpha_coef</span>, beta <span class="op">=</span> <span class="va">beta_coef</span>, gamma <span class="op">=</span> <span class="va">gamma_coef</span>,</span></span>
<span class="r-in"><span>    delta <span class="op">=</span> <span class="va">delta_coef</span>, lambda <span class="op">=</span> <span class="va">lambda_coef</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 3: Beta regression for comparison ----</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span> <span class="co"># Reduced N</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True coefficients for Beta parameters (gamma = shape1, delta = shape2)</span></span></span>
<span class="r-in"><span><span class="va">gamma_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="co"># Intercept, x1 (log scale for shape1)</span></span></span>
<span class="r-in"><span><span class="va">delta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">0.7</span><span class="op">)</span> <span class="co"># Intercept, x1 (log scale for shape2)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate linear predictors and transform (default link is log for Beta params here)</span></span></span>
<span class="r-in"><span><span class="va">X_beta_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_beta_eg</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gamma_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_beta_eg</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">delta_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response from Beta distribution</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="va">n</span>, shape1 <span class="op">=</span> <span class="va">gamma_true</span>, shape2 <span class="op">=</span> <span class="va">delta_true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmax</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">pmin</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">1</span> <span class="op">-</span> <span class="fl">1e-7</span><span class="op">)</span>, <span class="fl">1e-7</span><span class="op">)</span> <span class="co"># Ensure y is strictly in (0, 1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">df_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Beta regression model using gkwreg</span></span></span>
<span class="r-in"><span><span class="co"># Formula maps to gamma and delta: y ~ . | . | x1 | x1 | .</span></span></span>
<span class="r-in"><span><span class="co"># The "." parts for alpha, beta, lambda are ignored by family="beta"</span></span></span>
<span class="r-in"><span><span class="va">beta_reg</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">.</span> <span class="op">|</span> <span class="va">.</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_beta</span>, family <span class="op">=</span> <span class="st">"beta"</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gamma <span class="op">=</span> <span class="st">"log"</span>, delta <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># Specify links if non-default</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display confidence intervals for coefficients</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">beta_reg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4: Model comparison using AIC/BIC ----</span></span></span>
<span class="r-in"><span><span class="co"># Fit an alternative model, e.g., Kumaraswamy, to the same beta-generated data</span></span></span>
<span class="r-in"><span><span class="va">kw_reg2</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">df_beta</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">inherits</a></span><span class="op">(</span><span class="va">kw_reg2</span>, <span class="st">"try-error"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"AIC Comparison (Beta vs Kw):"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">beta_reg</span>, <span class="va">kw_reg2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"BIC Comparison (Beta vs Kw):"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">beta_reg</span>, <span class="va">kw_reg2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Could not fit Kw model for comparison on beta-generated data."</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 5: Predicting with a fitted model ----</span></span></span>
<span class="r-in"><span><span class="co"># Use the Beta regression model from Example 3</span></span></span>
<span class="r-in"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict expected response (mean of the Beta distribution)</span></span></span>
<span class="r-in"><span><span class="va">pred_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_reg</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict parameters (gamma and delta) on the scale of the link function</span></span></span>
<span class="r-in"><span><span class="va">pred_link</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_reg</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict parameters on the original scale (shape1, shape2)</span></span></span>
<span class="r-in"><span><span class="va">pred_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_reg</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type <span class="op">=</span> <span class="st">"parameters"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot original data and predicted mean response curve</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_beta</span><span class="op">$</span><span class="va">x1</span>, <span class="va">df_beta</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"grey"</span>, xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Beta Regression Fit (using gkwreg)"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">$</span><span class="va">x1</span>, <span class="va">pred_response</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="st">"Predicted Mean"</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lopes J. L..</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

