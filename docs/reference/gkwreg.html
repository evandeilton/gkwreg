<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Generalized Kumaraswamy Regression Models — gkwreg • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Generalized Kumaraswamy Regression Models — gkwreg"><meta name="description" content="Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for modeling response variables strictly bounded in the interval
(0, 1). The function provides a unified interface for fitting seven nested
submodels of the GKw family, allowing flexible modeling of proportions, rates,
and other bounded continuous outcomes through regression on distributional
parameters.
Maximum Likelihood Estimation is performed via automatic differentiation using
the TMB (Template Model Builder) package, ensuring computational efficiency and
numerical accuracy. The interface follows standard R regression modeling
conventions similar to lm, glm, and
betareg, making it immediately familiar to R users."><meta property="og:description" content="Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for modeling response variables strictly bounded in the interval
(0, 1). The function provides a unified interface for fitting seven nested
submodels of the GKw family, allowing flexible modeling of proportions, rates,
and other bounded continuous outcomes through regression on distributional
parameters.
Maximum Likelihood Estimation is performed via automatic differentiation using
the TMB (Template Model Builder) package, ensuring computational efficiency and
numerical accuracy. The interface follows standard R regression modeling
conventions similar to lm, glm, and
betareg, making it immediately familiar to R users."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/evandeilton/gkwreg" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Generalized Kumaraswamy Regression Models</h1>
      <small class="dont-index">Source: <a href="https://github.com/evandeilton/gkwreg/blob/HEAD/R/gkwreg-core.R" class="external-link"><code>R/gkwreg-core.R</code></a></small>
      <div class="d-none name"><code>gkwreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for modeling response variables strictly bounded in the interval
(0, 1). The function provides a unified interface for fitting seven nested
submodels of the GKw family, allowing flexible modeling of proportions, rates,
and other bounded continuous outcomes through regression on distributional
parameters.</p>
<p>Maximum Likelihood Estimation is performed via automatic differentiation using
the TMB (Template Model Builder) package, ensuring computational efficiency and
numerical accuracy. The interface follows standard R regression modeling
conventions similar to <code><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></code>, <code><a href="https://rdrr.io/r/stats/glm.html" class="external-link">glm</a></code>, and
<code><a href="https://rdrr.io/pkg/betareg/man/betareg.html" class="external-link">betareg</a></code>, making it immediately familiar to R users.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gkwreg</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gkw"</span>, <span class="st">"bkw"</span>, <span class="st">"kkw"</span>, <span class="st">"ekw"</span>, <span class="st">"mc"</span>, <span class="st">"kw"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"na.action"</span><span class="op">)</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An object of class <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> (or one that
can be coerced to that class). The formula uses extended syntax to specify
potentially different linear predictors for each distribution parameter:</p>
<p><code>y ~ model_alpha | model_beta | model_gamma | model_delta | model_lambda</code></p>
<p>where:</p><ul><li><p><code>y</code> is the response variable (must be in the open interval (0, 1))</p></li>
<li><p><code>model_alpha</code> specifies predictors for the \(\alpha\) parameter</p></li>
<li><p><code>model_beta</code> specifies predictors for the \(\beta\) parameter</p></li>
<li><p><code>model_gamma</code> specifies predictors for the \(\gamma\) parameter</p></li>
<li><p><code>model_delta</code> specifies predictors for the \(\delta\) parameter</p></li>
<li><p><code>model_lambda</code> specifies predictors for the \(\lambda\) parameter</p></li>
</ul><p>If a part is omitted or specified as <code>~ 1</code>, an intercept-only model is
used for that parameter. Parts corresponding to fixed parameters (determined
by <code>family</code>) are automatically ignored. See Details and Examples for
proper usage.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables specified in <code>formula</code>.
Standard R subsetting and missing value handling apply.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the distribution family from the
Generalized Kumaraswamy hierarchy. Must be one of:</p><dl><dt><code>"gkw"</code></dt>
<dd><p>Generalized Kumaraswamy (default). Five parameters:
\(\alpha, \beta, \gamma, \delta, \lambda\). Most flexible, suitable
when data show complex behavior not captured by simpler families.</p></dd>

<dt><code>"bkw"</code></dt>
<dd><p>Beta-Kumaraswamy. Four parameters:
\(\alpha, \beta, \gamma, \delta\) (fixes \(\lambda = 1\)).
Combines Beta and Kumaraswamy flexibility.</p></dd>

<dt><code>"kkw"</code></dt>
<dd><p>Kumaraswamy-Kumaraswamy. Four parameters:
\(\alpha, \beta, \delta, \lambda\) (fixes \(\gamma = 1\)).
Alternative four-parameter generalization.</p></dd>

<dt><code>"ekw"</code></dt>
<dd><p>Exponentiated Kumaraswamy. Three parameters:
\(\alpha, \beta, \lambda\) (fixes \(\gamma = 1, \delta = 0\)).
Adds flexibility to standard Kumaraswamy.</p></dd>

<dt><code>"mc"</code></dt>
<dd><p>McDonald (Beta Power). Three parameters:
\(\gamma, \delta, \lambda\) (fixes \(\alpha = 1, \beta = 1\)).
Generalization of Beta distribution.</p></dd>

<dt><code>"kw"</code></dt>
<dd><p>Kumaraswamy. Two parameters: \(\alpha, \beta\)
(fixes \(\gamma = 1, \delta = 0, \lambda = 1\)). Computationally
efficient alternative to Beta with closed-form CDF.</p></dd>

<dt><code>"beta"</code></dt>
<dd><p>Beta distribution. Two parameters: \(\gamma, \delta\)
(fixes \(\alpha = 1, \beta = 1, \lambda = 1\)). Standard choice for
proportions and rates, corresponds to shape1 = \(\gamma\),
shape2 = \(\delta\).</p></dd>


</dl><p>See Details for guidance on family selection.</p></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Link function(s) for the distributional parameters. Can be specified as:</p><ul><li><p><strong>Single character string</strong>: Same link for all relevant parameters.
Example: <code>link = "log"</code> applies log link to all parameters.</p></li>
<li><p><strong>Named list</strong>: Parameter-specific links for fine control.
Example: <code>link = list(alpha = "log", beta = "log", delta = "logit")</code></p></li>
</ul><p><strong>Default links</strong> (used if <code>link = NULL</code>):</p><ul><li><p><code>"log"</code> for \(\alpha, \beta, \gamma, \lambda\) (positive parameters)</p></li>
<li><p><code>"logit"</code> for \(\delta\) (parameter in (0, 1))</p></li>
</ul><p><strong>Available link functions:</strong></p><dl><dt><code>"log"</code></dt>
<dd><p>Logarithmic link. Maps \((0, \infty) \to (-\infty, \infty)\).
Ensures positivity. Most common for shape parameters.</p></dd>

<dt><code>"logit"</code></dt>
<dd><p>Logistic link. Maps \((0, 1) \to (-\infty, \infty)\).
Standard for probability-type parameters like \(\delta\).</p></dd>

<dt><code>"probit"</code></dt>
<dd><p>Probit link using normal CDF. Maps \((0, 1) \to (-\infty, \infty)\).
Alternative to logit, symmetric tails.</p></dd>

<dt><code>"cloglog"</code></dt>
<dd><p>Complementary log-log. Maps \((0, 1) \to (-\infty, \infty)\).
Asymmetric, useful for skewed probabilities.</p></dd>

<dt><code>"cauchy"</code></dt>
<dd><p>Cauchy link using Cauchy CDF. Maps \((0, 1) \to (-\infty, \infty)\).
Heavy-tailed alternative to probit.</p></dd>

<dt><code>"identity"</code></dt>
<dd><p>Identity link (no transformation). Use with caution;
does not guarantee parameter constraints.</p></dd>

<dt><code>"sqrt"</code></dt>
<dd><p>Square root link. Maps \(x \to \sqrt{x}\).
Variance-stabilizing for some contexts.</p></dd>

<dt><code>"inverse"</code></dt>
<dd><p>Inverse link. Maps \(x \to 1/x\).
Useful for rate-type parameters.</p></dd>

<dt><code>"inverse-square"</code></dt>
<dd><p>Inverse squared link. Maps \(x \to 1/x^2\).</p></dd>


</dl></dd>


<dt id="arg-link-scale">link_scale<a class="anchor" aria-label="anchor" href="#arg-link-scale"></a></dt>
<dd><p>Numeric scale factor(s) controlling the transformation intensity
of link functions. Can be:</p><ul><li><p><strong>Single numeric</strong>: Same scale for all parameters.</p></li>
<li><p><strong>Named list</strong>: Parameter-specific scales for fine-tuning.
Example: <code>link_scale = list(alpha = 10, beta = 10, delta = 1)</code></p></li>
</ul><p><strong>Default scales</strong> (used if <code>link_scale = NULL</code>):</p><ul><li><p>10 for \(\alpha, \beta, \gamma, \lambda\)</p></li>
<li><p>1 for \(\delta\)</p></li>
</ul><p>Larger values produce more gradual transformations; smaller values produce
more extreme transformations. For probability-type links (logit, probit),
smaller scales (e.g., 0.5-2) create steeper response curves, while larger
scales (e.g., 5-20) create gentler curves. Adjust if convergence issues arise
or if you need different response sensitivities.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>Optional vector specifying a subset of observations to be used
in fitting. Can be a logical vector, integer indices, or expression evaluating
to one of these. Standard R subsetting rules apply.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>Optional numeric vector of prior weights (e.g., frequency weights)
for observations. Should be non-negative. Currently experimental; use with
caution and validate results.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>Optional numeric vector or matrix specifying an <em>a priori</em> known
component to be included in the linear predictor(s). If a vector, it is applied
to the first parameter's predictor. If a matrix, columns correspond to parameters
in order (\(\alpha, \beta, \gamma, \delta, \lambda\)). Offsets are added to
the linear predictor <em>before</em> applying the link function.</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>A function specifying how to handle missing values (<code>NA</code>s).
Options include:</p><dl><dt><code>na.fail</code></dt>
<dd><p>Stop with error if <code>NA</code>s present (default via
<code>getOption("na.action")</code>)</p></dd>

<dt><code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code></dt>
<dd><p>Remove observations with <code>NA</code>s</p></dd>

<dt><code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code></dt>
<dd><p>Like <code>na.omit</code> but preserves
original length in residuals/fitted values</p></dd>


</dl><p>See <code><a href="https://rdrr.io/r/stats/na.action.html" class="external-link">na.action</a></code> for details.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>Optional list specifying contrasts for factor variables in the
model. Format: named list where names are factor variable names and values are
contrast specifications. See <code><a href="https://rdrr.io/r/stats/contrasts.html" class="external-link">contrasts</a></code> and the
<code>contrasts.arg</code> argument of <code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></code>.</p></dd>


<dt id="arg-control">control<a class="anchor" aria-label="anchor" href="#arg-control"></a></dt>
<dd><p>A list of control parameters from <code><a href="gkw_control.html">gkw_control</a></code>
specifying technical details of the fitting process. This includes:</p><ul><li><p>Optimization algorithm (<code>method</code>)</p></li>
<li><p>Starting values (<code>start</code>)</p></li>
<li><p>Fixed parameters (<code>fixed</code>)</p></li>
<li><p>Convergence tolerances (<code>maxit</code>, <code>reltol</code>, <code>abstol</code>)</p></li>
<li><p>Hessian computation (<code>hessian</code>)</p></li>
<li><p>Verbosity (<code>silent</code>, <code>trace</code>)</p></li>
</ul><p>Default is <code><a href="gkw_control.html">gkw_control()</a></code> which uses sensible defaults for most problems.
See <code><a href="gkw_control.html">gkw_control</a></code> for complete documentation of all options.
<strong>Most users never need to modify control parameters.</strong></p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the model frame (data frame
containing all variables used in fitting) is returned as component <code>model</code>
of the result. Useful for prediction and diagnostics. Set to <code>FALSE</code> to
reduce object size.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the list of model matrices (one for each
modeled parameter) is returned as component <code>x</code>. Default <code>FALSE</code>.
Set to <code>TRUE</code> if you need direct access to design matrices for custom
calculations.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the response vector (after processing
by <code>na.action</code> and <code>subset</code>) is returned as component <code>y</code>.
Useful for residual calculations and diagnostics.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments. Currently used only for backward compatibility
with deprecated arguments from earlier versions. Using deprecated arguments
triggers informative warnings with migration guidance. Examples of deprecated
arguments: <code>plot</code>, <code>conf.level</code>, <code>method</code>, <code>start</code>,
<code>fixed</code>, <code>hessian</code>, <code>silent</code>, <code>optimizer.control</code>.
These should now be passed via the <code>control</code> argument.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"gkwreg"</code>, which is a list containing the following
components. Standard S3 methods are available for this class (see Methods section).</p>
<p><strong>Model Specification:</strong></p><dl><dt><code>call</code></dt>
<dd><p>The matched function call</p></dd>

<dt><code>formula</code></dt>
<dd><p>The <code>Formula</code> object used</p></dd>

<dt><code>family</code></dt>
<dd><p>Character string: distribution family used</p></dd>

<dt><code>link</code></dt>
<dd><p>Named list: link functions for each parameter</p></dd>

<dt><code>link_scale</code></dt>
<dd><p>Named list: link scale values for each parameter</p></dd>

<dt><code>param_names</code></dt>
<dd><p>Character vector: names of parameters for this family</p></dd>

<dt><code>fixed_params</code></dt>
<dd><p>Named list: parameters fixed by family definition</p></dd>

<dt><code>control</code></dt>
<dd><p>The <code>gkw_control</code> object used for fitting</p></dd>


</dl><p><strong>Parameter Estimates:</strong></p><dl><dt><code>coefficients</code></dt>
<dd><p>Named numeric vector: estimated regression coefficients
(on link scale). Names follow the pattern "parameter:predictor", e.g.,
"alpha:(Intercept)", "alpha:x1", "beta:(Intercept)", "beta:x2".</p></dd>

<dt><code>fitted_parameters</code></dt>
<dd><p>Named list: mean values for each distribution
parameter (\(\alpha, \beta, \gamma, \delta, \lambda\)) averaged across
all observations</p></dd>

<dt><code>parameter_vectors</code></dt>
<dd><p>Named list: observation-specific parameter
values. Contains vectors <code>alphaVec</code>, <code>betaVec</code>, <code>gammaVec</code>,
<code>deltaVec</code>, <code>lambdaVec</code>, each of length <code>nobs</code></p></dd>


</dl><p><strong>Fitted Values and Residuals:</strong></p><dl><dt><code>fitted.values</code></dt>
<dd><p>Numeric vector: fitted mean values
\(E[Y|X]\) for each observation</p></dd>

<dt><code>residuals</code></dt>
<dd><p>Numeric vector: response residuals
(observed - fitted) for each observation</p></dd>


</dl><p><strong>Inference:</strong></p><dl><dt><code>vcov</code></dt>
<dd><p>Variance-covariance matrix of coefficient estimates.
Only present if <code>control$hessian = TRUE</code>. <code>NULL</code> otherwise.</p></dd>

<dt><code>se</code></dt>
<dd><p>Numeric vector: standard errors of coefficients.
Only present if <code>control$hessian = TRUE</code>. <code>NULL</code> otherwise.</p></dd>


</dl><p><strong>Model Fit Statistics:</strong></p><dl><dt><code>loglik</code></dt>
<dd><p>Numeric: maximized log-likelihood value</p></dd>

<dt><code>aic</code></dt>
<dd><p>Numeric: Akaike Information Criterion
(AIC = -2<em>loglik + 2</em>npar)</p></dd>

<dt><code>bic</code></dt>
<dd><p>Numeric: Bayesian Information Criterion
(BIC = -2*loglik + log(nobs)*npar)</p></dd>

<dt><code>deviance</code></dt>
<dd><p>Numeric: deviance (-2 * loglik)</p></dd>

<dt><code>df.residual</code></dt>
<dd><p>Integer: residual degrees of freedom (nobs - npar)</p></dd>

<dt><code>nobs</code></dt>
<dd><p>Integer: number of observations used in fit</p></dd>

<dt><code>npar</code></dt>
<dd><p>Integer: total number of estimated parameters</p></dd>


</dl><p><strong>Diagnostic Statistics:</strong></p><dl><dt><code>rmse</code></dt>
<dd><p>Numeric: Root Mean Squared Error of response residuals</p></dd>

<dt><code>efron_r2</code></dt>
<dd><p>Numeric: Efron's pseudo R-squared
(1 - SSE/SST, where SSE = sum of squared errors,
SST = total sum of squares)</p></dd>

<dt><code>mean_absolute_error</code></dt>
<dd><p>Numeric: Mean Absolute Error of response
residuals</p></dd>


</dl><p><strong>Optimization Details:</strong></p><dl><dt><code>convergence</code></dt>
<dd><p>Logical: <code>TRUE</code> if optimizer converged
successfully, <code>FALSE</code> otherwise</p></dd>

<dt><code>message</code></dt>
<dd><p>Character: convergence message from optimizer</p></dd>

<dt><code>iterations</code></dt>
<dd><p>Integer: number of iterations used by optimizer</p></dd>

<dt><code>method</code></dt>
<dd><p>Character: optimization method used
(e.g., "nlminb", "BFGS")</p></dd>


</dl><p><strong>Optional Components</strong> (returned if requested via <code>model</code>, <code>x</code>, <code>y</code>):</p><dl><dt><code>model</code></dt>
<dd><p>Data frame: the model frame (if <code>model = TRUE</code>)</p></dd>

<dt><code>x</code></dt>
<dd><p>Named list: model matrices for each parameter
(if <code>x = TRUE</code>)</p></dd>

<dt><code>y</code></dt>
<dd><p>Numeric vector: the response variable (if <code>y = TRUE</code>)</p></dd>


</dl><p><strong>Internal:</strong></p><dl><dt><code>tmb_object</code></dt>
<dd><p>The raw object returned by <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></code>.
Contains the TMB automatic differentiation function and environment.
Primarily for internal use and advanced debugging.</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>

<div class="section">
<h3 id="distribution-family-selection">Distribution Family Selection<a class="anchor" aria-label="anchor" href="#distribution-family-selection"></a></h3>


<p>The Generalized Kumaraswamy family provides a flexible hierarchy for modeling
bounded responses. Selection should be guided by:</p>
<p><strong>1. Start Simple:</strong> Begin with two-parameter families (<code>"kw"</code> or
<code>"beta"</code>) unless you have strong reasons to use more complex models.</p>
<p><strong>2. Model Comparison:</strong> Use information criteria (AIC, BIC) and likelihood
ratio tests to compare nested models:</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="co"># Fit sequence of nested models</span></span>
<span>  <span class="va">fit_kw</span>   <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span>
<span>  <span class="va">fit_ekw</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>, family <span class="op">=</span> <span class="st">"ekw"</span><span class="op">)</span></span>
<span>  <span class="va">fit_gkw</span>  <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Compare via AIC</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_ekw</span>, <span class="va">fit_gkw</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Formal test (nested models only)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_ekw</span>, <span class="va">fit_gkw</span><span class="op">)</span></span></code></pre></div>

<p><strong>3. Family Characteristics:</strong></p><ul><li><p><strong>Beta</strong>: Traditional choice, well-understood, good for symmetric
or moderately skewed data</p></li>
<li><p><strong>Kumaraswamy (kw)</strong>: Computationally efficient alternative to Beta,
closed-form CDF, similar flexibility</p></li>
<li><p><strong>Exponentiated Kumaraswamy (ekw)</strong>: Adds flexibility for extreme
values and heavy tails</p></li>
<li><p><strong>Beta-Kumaraswamy (bkw)</strong>, <strong>Kumaraswamy-Kumaraswamy (kkw)</strong>:
Four-parameter alternatives when three parameters insufficient</p></li>
<li><p><strong>McDonald (mc)</strong>: Beta generalization via power parameter, useful
for J-shaped distributions</p></li>
<li><p><strong>Kumaraswamy-Kumaraswamy (kkw)</strong>: Most flexible, use only when
simpler families inadequate. It extends kw</p></li>
<li><p><strong>Generalized Kumaraswamy (gkw)</strong>: Most flexible, use only when
simpler families inadequate</p></li>
</ul><p><strong>4. Avoid Overfitting:</strong> More different parameters better model. Use cross-validation
or hold-out validation to assess predictive performance.</p>
</div>

<div class="section">
<h3 id="formula-specification">Formula Specification<a class="anchor" aria-label="anchor" href="#formula-specification"></a></h3>


<p>The extended formula syntax allows different predictors for each parameter:</p>
<p><strong>Basic Examples:</strong></p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="co"># Same predictors for both parameters (two-parameter family)</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span></span>
<span>  <span class="co"># Equivalent to: y ~ x1 + x2 | x1 + x2</span></span>
<span></span>
<span>  <span class="co"># Different predictors per parameter</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span></span>
<span>  <span class="co"># alpha depends on x1, x2</span></span>
<span>  <span class="co"># beta depends on x3, x4</span></span>
<span></span>
<span>  <span class="co"># Intercept-only for some parameters</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="fl">1</span></span>
<span>  <span class="co"># alpha depends on x1</span></span>
<span>  <span class="co"># beta has only intercept</span></span>
<span></span>
<span>  <span class="co"># Complex specification (five-parameter family)</span></span>
<span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x4</span> <span class="op">|</span> <span class="va">x5</span></span>
<span>  <span class="co"># alpha ~ x1, beta ~ x2, gamma ~ x3, delta ~ x4, lambda ~ x5</span></span></code></pre></div>

<p><strong>Important Notes:</strong></p><ul><li><p>Formula parts correspond to parameters in order:
\(\alpha\), \(\beta\), \(\gamma\), \(\delta\), \(\lambda\)</p></li>
<li><p>Unused parts (due to family constraints) are automatically ignored</p></li>
<li><p>Use <code>.</code> to include all predictors: <code>y ~ . | .</code></p></li>
<li><p>Standard R formula features work: interactions (<code>x1:x2</code>),
polynomials (<code>poly(x, 2)</code>), transformations (<code>log(x)</code>), etc.</p></li>
</ul></div>

<div class="section">
<h3 id="link-functions-and-scales">Link Functions and Scales<a class="anchor" aria-label="anchor" href="#link-functions-and-scales"></a></h3>


<p>Link functions map the range of distributional parameters to the real line,
ensuring parameter constraints are satisfied during optimization.</p>
<p><strong>Choosing Links:</strong></p><ul><li><p><strong>Defaults are usually best</strong>: The automatic choices
(log for shape parameters, logit for delta) work well in most cases</p></li>
<li><p><strong>Alternative links</strong>: Consider if you have theoretical reasons
(e.g., probit for latent variable interpretation) or convergence issues</p></li>
<li><p><strong>Identity link</strong>: Avoid unless you have constraints elsewhere;
can lead to invalid parameter values during optimization</p></li>
</ul><p><strong>Link Scales:</strong>
The <code>link_scale</code> parameter controls transformation intensity. Think of it
as a "sensitivity" parameter:</p><ul><li><p><strong>Larger values</strong> (e.g., 20): Gentler response to predictor changes</p></li>
<li><p><strong>Smaller values</strong> (e.g., 2): Steeper response to predictor changes</p></li>
<li><p><strong>Default (10)</strong>: Balanced, works well for most cases</p></li>
</ul><p>Adjust only if:</p><ul><li><p>Convergence difficulties arise</p></li>
<li><p>You need very steep or very gentle response curves</p></li>
<li><p>Predictors have unusual scales (very large or very small)</p></li>
</ul></div>

<div class="section">
<h3 id="optimization-and-convergence">Optimization and Convergence<a class="anchor" aria-label="anchor" href="#optimization-and-convergence"></a></h3>


<p>The default optimizer (<code>method = "nlminb"</code>) works well for most problems.
If convergence issues occur:</p>
<p><strong>1. Check Data:</strong></p><ul><li><p>Ensure response is strictly in (0, 1)</p></li>
<li><p>Check for extreme outliers or influential points</p></li>
<li><p>Verify predictors aren't perfectly collinear</p></li>
<li><p>Consider rescaling predictors to similar ranges</p></li>
</ul><p><strong>2. Try Alternative Optimizers:</strong></p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="co"># BFGS often more robust for difficult problems</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>,</span>
<span>                control <span class="op">=</span> <span class="fu"><a href="../reference/gkw_control.html">gkw_control</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># Nelder-Mead for non-smooth objectives</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>,</span>
<span>                control <span class="op">=</span> <span class="fu"><a href="../reference/gkw_control.html">gkw_control</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"Nelder-Mead"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

<p><strong>3. Adjust Tolerances:</strong></p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="co"># Increase iterations and loosen tolerance</span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>,</span>
<span>                control <span class="op">=</span> <span class="fu"><a href="../reference/gkw_control.html">gkw_control</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">1000</span>, reltol <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

<p><strong>4. Provide Starting Values:</strong></p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="co"># Fit simpler model first, use as starting values</span></span>
<span>  <span class="va">fit_simple</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span>
<span>  <span class="va">start_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    alpha <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_simple</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X_alpha</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    beta  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_simple</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">X_beta</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span>  <span class="va">fit_complex</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">+</span> <span class="va">x4</span>, <span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span>,</span>
<span>                         control <span class="op">=</span> <span class="fu"><a href="../reference/gkw_control.html">gkw_control</a></span><span class="op">(</span>start <span class="op">=</span> <span class="va">start_vals</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

<p><strong>5. Simplify Model:</strong></p><ul><li><p>Use simpler family (e.g., "kw" instead of "gkw")</p></li>
<li><p>Reduce number of predictors</p></li>
<li><p>Use intercept-only for some parameters</p></li>
</ul></div>

<div class="section">
<h3 id="standard-errors-and-inference">Standard Errors and Inference<a class="anchor" aria-label="anchor" href="#standard-errors-and-inference"></a></h3>


<p>By default, standard errors are computed via the Hessian matrix at the MLE.
This provides valid asymptotic standard errors under standard regularity conditions.</p>
<p><strong>When Standard Errors May Be Unreliable:</strong></p><ul><li><p>Small sample sizes (n &lt; 30-50 per parameter)</p></li>
<li><p>Parameters near boundaries</p></li>
<li><p>Highly collinear predictors</p></li>
<li><p>Mis-specified models</p></li>
</ul><p><strong>Alternatives:</strong></p><ul><li><p>Bootstrap confidence intervals (more robust, computationally expensive)</p></li>
<li><p>Profile likelihood intervals via <code>confint(..., type = "profile")</code>
(not yet implemented)</p></li>
<li><p>Cross-validation for predictive performance assessment</p></li>
</ul><p>To skip Hessian computation (faster, no SEs):</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>,</span>
<span>                control <span class="op">=</span> <span class="fu"><a href="../reference/gkw_control.html">gkw_control</a></span><span class="op">(</span>hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>

</div>

<div class="section">
<h3 id="model-diagnostics">Model Diagnostics<a class="anchor" aria-label="anchor" href="#model-diagnostics"></a></h3>


<p>Always check model adequacy using diagnostic plots:</p><div class="sourceCode"><pre><code><span></span>
<span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x</span>, <span class="va">data</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>  <span class="co"># Six diagnostic plots</span></span></code></pre></div>

<p>Key diagnostics:</p><ul><li><p><strong>Residual plots</strong>: Check for patterns, heteroscedasticity</p></li>
<li><p><strong>Half-normal plot</strong>: Assess distributional adequacy</p></li>
<li><p><strong>Cook's distance</strong>: Identify influential observations</p></li>
<li><p><strong>Predicted vs observed</strong>: Overall fit quality</p></li>
</ul><p>See <code><a href="plot.gkwreg.html">plot.gkwreg</a></code> for detailed interpretation guidance.</p>
</div>

<div class="section">
<h3 id="computational-considerations">Computational Considerations<a class="anchor" aria-label="anchor" href="#computational-considerations"></a></h3>


<p><strong>Performance Tips:</strong></p><ul><li><p>GKw family: Most computationally expensive (~2-5x slower than kw/beta)</p></li>
<li><p>Beta/Kw families: Fastest, use when adequate</p></li>
<li><p>Large datasets (n &gt; 10,000): Consider sampling for exploratory analysis</p></li>
<li><p>TMB uses automatic differentiation: Fast gradient/Hessian computation</p></li>
<li><p>Disable Hessian (<code>hessian = FALSE</code>) for faster fitting without SEs</p></li>
</ul><p><strong>Memory Usage:</strong></p><ul><li><p>Set <code>model = FALSE</code>, <code>x = FALSE</code>, <code>y = FALSE</code> to reduce
object size (but limits some post-fitting capabilities)</p></li>
<li><p>Hessian matrix scales as O(p²) where p = number of parameters</p></li>
</ul></div>

    </div>
    <div class="section level2">
    <h2 id="methods">Methods<a class="anchor" aria-label="anchor" href="#methods"></a></h2>


<p>The following S3 methods are available for objects of class <code>"gkwreg"</code>:</p>
<p><strong>Basic Methods:</strong></p><ul><li><p><code><a href="print.gkwreg.html">print.gkwreg</a></code>: Print basic model information</p></li>
<li><p><code><a href="summary.gkwreg.html">summary.gkwreg</a></code>: Detailed model summary with coefficient
tables, tests, and fit statistics</p></li>
<li><p><code><a href="coef.gkwreg.html">coef.gkwreg</a></code>: Extract coefficients</p></li>
<li><p><code><a href="vcov.gkwreg.html">vcov.gkwreg</a></code>: Extract variance-covariance matrix</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></code>: Extract log-likelihood</p></li>
<li><p><code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></code>: Information criteria</p></li>
</ul><p><strong>Prediction and Fitted Values:</strong></p><ul><li><p><code><a href="fitted.gkwreg.html">fitted.gkwreg</a></code>: Extract fitted values</p></li>
<li><p><code><a href="residuals.gkwreg.html">residuals.gkwreg</a></code>: Extract residuals (multiple types available)</p></li>
<li><p><code><a href="predict.gkwreg.html">predict.gkwreg</a></code>: Predict on new data</p></li>
</ul><p><strong>Inference:</strong></p><ul><li><p><code><a href="confint.gkwreg.html">confint.gkwreg</a></code>: Confidence intervals for parameters</p></li>
<li><p><code><a href="anova.gkwreg.html">anova.gkwreg</a></code>: Compare nested models via likelihood ratio tests</p></li>
</ul><p><strong>Diagnostics:</strong></p><ul><li><p><code><a href="plot.gkwreg.html">plot.gkwreg</a></code>: Comprehensive diagnostic plots (6 types)</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p><strong>Generalized Kumaraswamy Distribution:</strong></p>
<p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of generalized distributions.
<em>Journal of Statistical Computation and Simulation</em>, <strong>81</strong>(7), 883-898.
<a href="https://doi.org/10.1080/00949650903530745" class="external-link">doi:10.1080/00949650903530745</a></p>
<p><strong>Kumaraswamy Distribution:</strong></p>
<p>Kumaraswamy, P. (1980). A generalized probability density function for
double-bounded random processes. <em>Journal of Hydrology</em>, <strong>46</strong>(1-2), 79-88.
<a href="https://doi.org/10.1016/0022-1694%2880%2990036-0" class="external-link">doi:10.1016/0022-1694(80)90036-0</a></p>
<p>Jones, M. C. (2009). Kumaraswamy's distribution: A beta-type distribution with
some tractability advantages. <em>Statistical Methodology</em>, <strong>6</strong>(1), 70-81.
<a href="https://doi.org/10.1016/j.stamet.2008.04.001" class="external-link">doi:10.1016/j.stamet.2008.04.001</a></p>
<p><strong>Beta Regression:</strong></p>
<p>Ferrari, S. L. P., &amp; Cribari-Neto, F. (2004). Beta regression for modelling
rates and proportions. <em>Journal of Applied Statistics</em>, <strong>31</strong>(7), 799-815.
<a href="https://doi.org/10.1080/0266476042000214501" class="external-link">doi:10.1080/0266476042000214501</a></p>
<p>Smithson, M., &amp; Verkuilen, J. (2006). A better lemon squeezer? Maximum-likelihood
regression with beta-distributed dependent variables. <em>Psychological Methods</em>,
<strong>11</strong>(1), 54-71.
<a href="https://doi.org/10.1037/1082-989X.11.1.54" class="external-link">doi:10.1037/1082-989X.11.1.54</a></p>
<p><strong>Template Model Builder (TMB):</strong></p>
<p>Kristensen, K., Nielsen, A., Berg, C. W., Skaug, H., &amp; Bell, B. M. (2016).
TMB: Automatic Differentiation and Laplace Approximation. <em>Journal of
Statistical Software</em>, <strong>70</strong>(5), 1-21.
<a href="https://doi.org/10.18637/jss.v070.i05" class="external-link">doi:10.18637/jss.v070.i05</a></p>
<p><strong>Related Software:</strong></p>
<p>Zeileis, A., &amp; Croissant, Y. (2010). Extended Model Formulas in R: Multiple
Parts and Multiple Responses. <em>Journal of Statistical Software</em>,
<strong>34</strong>(1), 1-13.
<a href="https://doi.org/10.18637/jss.v034.i01" class="external-link">doi:10.18637/jss.v034.i01</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><strong>Control and Inference:</strong>
<code><a href="gkw_control.html">gkw_control</a></code> for fitting control parameters,
<code><a href="confint.gkwreg.html">confint.gkwreg</a></code> for confidence intervals,
<code><a href="anova.gkwreg.html">anova.gkwreg</a></code> for model comparison</p>
<p><strong>Methods:</strong>
<code><a href="summary.gkwreg.html">summary.gkwreg</a></code>, <code><a href="plot.gkwreg.html">plot.gkwreg</a></code>,
<code><a href="coef.gkwreg.html">coef.gkwreg</a></code>, <code><a href="vcov.gkwreg.html">vcov.gkwreg</a></code>,
<code><a href="fitted.gkwreg.html">fitted.gkwreg</a></code>, <code><a href="residuals.gkwreg.html">residuals.gkwreg</a></code>,
<code><a href="predict.gkwreg.html">predict.gkwreg</a></code></p>
<p><strong>Distributions:</strong>
<code><a href="https://evandeilton.github.io/gkwdist/reference/dgkw.html" class="external-link">dgkw</a></code>, <code><a href="https://evandeilton.github.io/gkwdist/reference/pgkw.html" class="external-link">pgkw</a></code>,
<code><a href="https://evandeilton.github.io/gkwdist/reference/qgkw.html" class="external-link">qgkw</a></code>, <code><a href="https://evandeilton.github.io/gkwdist/reference/rgkw.html" class="external-link">rgkw</a></code>
for the GKw distribution family functions</p>
<p><strong>Related Packages:</strong>
<code><a href="https://rdrr.io/pkg/betareg/man/betareg.html" class="external-link">betareg</a></code> for traditional beta regression,
<code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> for extended formula interface,
<code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></code> for TMB functionality</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lopes, J. E.</p>
<p>Maintainer: Lopes, J. E.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co"># SECTION 1: Basic Usage - Getting Started</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load packages and data</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwreg" class="external-link">gkwreg</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/evandeilton/gkwdist" class="external-link">gkwdist</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">GasolineYield</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1.1: Simplest possible model (intercept-only, all defaults)</span></span></span>
<span class="r-in"><span><span class="va">fit_basic</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_basic</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = yield ~ 1, data = GasolineYield, family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1688 -0.0803 -0.0188 -0.0002  0.0737  0.2602 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)   0.6342     0.1538   4.124 3.73e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)    2.7951     0.4319   6.472 9.68e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       3%    98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept) 0.3328 0.9356</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  1.9486 3.6416</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 1.886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 16.35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 30 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 28.51 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -53.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -50.09 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.1055 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: -4.747e-06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.09088 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1.2: Model with predictors (uses all defaults)</span></span></span>
<span class="r-in"><span><span class="co"># Default: family = "gkw", method = "nlminb", hessian = TRUE</span></span></span>
<span class="r-in"><span><span class="va">fit_default</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_default</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gkw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = yield ~ batch + temp, data = GasolineYield)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0268 -0.0116 -0.0010 -0.0011  0.0080  0.0304 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                      Estimate Std. Error   z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  -3.449e+00  1.032e+00    -3.341 0.000835 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1        9.201e-01  3.171e-02    29.014  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2        6.786e-01  3.394e-02    19.996  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3        7.826e-01  3.391e-02    23.078  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4        5.596e-01  3.174e-02    17.633  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5        5.630e-01  3.387e-02    16.624  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6        5.417e-01  3.392e-02    15.972  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7        3.111e-01  3.175e-02     9.798  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8        2.547e-01  3.386e-02     7.520 5.49e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9        1.989e-01  3.785e-02     5.255 1.48e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp          5.407e-03  2.647e-07 20431.363  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)    2.608e+00  4.282e-01     6.091 1.12e-09 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:(Intercept)   2.325e+01        NaN       NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:(Intercept)  -1.702e-01  9.250e-01    -0.184 0.854028    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -9.663e+00        NaN       NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  -5.4727 -1.4256</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1        0.8580  0.9823</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2        0.6121  0.7451</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3        0.7161  0.8491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4        0.4974  0.6218</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5        0.4967  0.6294</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6        0.4752  0.6082</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7        0.2489  0.3733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8        0.1883  0.3210</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9        0.1247  0.2731</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp          0.0054  0.0054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)    1.7690  3.4474</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:(Intercept)      NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:(Intercept)  -1.9832  1.6428</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept)     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: logit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 0.3364</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 13.57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1.245e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 4.576</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 6.35e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 15 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 17 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 96.53 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -163.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -141.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.0144 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.9814 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.01156 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Failed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 140 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1.3: Kumaraswamy model (two-parameter family)</span></span></span>
<span class="r-in"><span><span class="co"># Default link functions: log for both alpha and beta</span></span></span>
<span class="r-in"><span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_kw</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = yield ~ batch + temp, data = GasolineYield, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0254 -0.0057  0.0044  0.0013  0.0107  0.0225 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.511044   0.023253  21.978  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.845112   0.027843  30.352  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.598480   0.030073  19.901  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.716337   0.030108  23.792  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.474069   0.028168  16.830  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.521750   0.031057  16.800  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.456833   0.030675  14.893  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.230582   0.028514   8.087 6.14e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.206450   0.031527   6.548 5.82e-11 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.146207   0.035025   4.174 2.99e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp         0.005299        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  24.960692   0.349960  71.324  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.4655  0.5566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.7905  0.8997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.5395  0.6574</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.6573  0.7753</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.4189  0.5293</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.4609  0.5826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.3967  0.5170</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.1747  0.2865</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.1447  0.2682</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.0776  0.2149</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp            NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  24.2748 25.6466</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 15.94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 6.916e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 96.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -169 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -151.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.01268 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.9856 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.01054 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Failed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_kw</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 1.4: Beta model for comparison</span></span></span>
<span class="r-in"><span><span class="co"># Default links: log for gamma and delta</span></span></span>
<span class="r-in"><span><span class="va">fit_beta</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare models using AIC/BIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_beta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          df        AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw   12 -168.95784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_beta 12  -66.52315</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_beta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          df        BIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw   12 -151.36901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_beta 12  -48.93432</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 2: Using gkw_control() for Customization</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2.1: Change optimization method to BFGS</span></span></span>
<span class="r-in"><span><span class="va">fit_bfgs</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_bfgs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = yield ~ batch + temp, data = GasolineYield, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "kw", control = gkw_control(method = "BFGS"))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.4270 -0.3404 -0.2601 -0.2400 -0.1571  0.0346 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept) -2.642e-06  1.244e+00   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1      -1.481e-07  7.956e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2      -2.952e-07  7.610e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3      -2.558e-07  7.878e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4      -3.067e-07  6.980e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5      -1.339e-07  7.555e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6      -1.890e-07  7.388e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7      -5.561e-07  6.586e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8      -2.938e-07  6.854e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9      -1.461e-07  7.854e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp        -7.717e-04  3.133e-03  -0.246    0.805</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   2.530e-06  5.131e-01   0.000    1.000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%    98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept) -2.4382 2.4382</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1      -1.5593 1.5593</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2      -1.4916 1.4916</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3      -1.5441 1.5441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4      -1.3680 1.3680</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5      -1.4808 1.4808</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6      -1.4479 1.4479</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7      -1.2908 1.2908</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8      -1.3433 1.3433</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9      -1.5394 1.5394</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp        -0.0069 0.0054</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  -1.0057 1.0057</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 0.775</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 0.999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 4.18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: 15.64 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: 33.23 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.2662 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: -5.362 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.2422 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2.2: Increase iterations and enable verbose output</span></span></span>
<span class="r-in"><span><span class="va">fit_verbose</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    method <span class="op">=</span> <span class="st">"nlminb"</span>,</span></span>
<span class="r-in"><span>    maxit <span class="op">=</span> <span class="fl">1000</span>,</span></span>
<span class="r-in"><span>    silent <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Show optimization progress</span></span></span>
<span class="r-in"><span>    trace <span class="op">=</span> <span class="fl">1</span> <span class="co"># Print iteration details</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using TMB model: kwreg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking TMB model status for  kwreg ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found TMB source file:  /home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/gkwreg/tmb/kwreg.cpp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found cached TMB model:  /home/jlopes/.cache/gkwreg/tmb_cache/R4.5/2.0.0/kwreg.so </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successfully loaded cached TMB model.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimizing with nlminb...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7535.888 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0:-7.1054274e-14:  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1043.999 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   1:    -5.4751175: -4.63847e-06 -2.59943e-07 -5.18250e-07 -4.49143e-07 -5.38512e-07 -2.35055e-07 -3.31849e-07 -9.76418e-07 -5.15872e-07 -2.56583e-07 -0.00135487 4.44139e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  248.2347 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:    -5.6372510: -0.000220415 4.16287e-05 -6.57121e-05 -4.96481e-05 -2.17994e-05 4.41064e-05 1.14631e-05 -0.000146966 -2.99241e-05 1.37058e-05 -0.00157060 0.00131183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  473.1837 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3:    -17.969328: -0.136724 0.0277276 -0.0411281 -0.0307797 -0.0132258 0.0285480 0.00773975 -0.0933782 -0.0190868 0.00856339 0.000220983 0.807421</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  9403.659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    -26.755529: -1.05462 0.724290 -0.0972976 0.0815258 -0.00801223 0.221600 0.0531230 -0.597665 -0.396572 -0.204538 0.00463826  1.75768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2886.778 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   5:    -37.161577: -1.99422 0.532895 0.375388 0.595205 0.184898 0.118380 0.0752171 0.0400090 -0.446348 -0.559931 0.00739496  2.61648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7.749627 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6:    -37.319116: -1.99422 0.532895 0.375388 0.595205 0.184898 0.118380 0.0752172 0.0400089 -0.446347 -0.559931 0.00728617  2.61648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  550.0578 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   7:    -41.464061: -2.02667 0.914794  1.02259 0.900567 0.498035 0.229685 0.432451 0.250005 0.606057 -0.140198 0.00692665  3.32846</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5344.69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8:    -45.753042: -1.76430  1.27538  1.24545  1.16880 0.977965 0.907505 0.936306 0.774485  1.02539 0.611458 0.00552332  4.00061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1670.43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   9:    -47.955163: -1.64864  1.22488  1.11887  1.24717 0.859116 0.813747 0.957285 0.611050 0.863210 0.747015 0.00532993  4.07981</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  9795.288 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10:    -51.767663: -1.40959  1.20843 0.839361 0.870775 0.757785 0.725397 0.685794 0.396577 0.539655 0.627278 0.00501252  4.22953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2710.496 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  11:    -53.248253: -1.12767  1.06051 0.668602 0.815387 0.477102 0.862767 0.718959 0.248646 0.338869 0.171931 0.00481642  4.46311</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16842.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12:    -53.429246: -1.03560 0.930350 0.552767 0.812949 0.558985 0.739392 0.653578 0.201404 0.199360 0.0828970 0.00510502  4.64797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1617.054 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  13:    -56.920478: -1.04556 0.887457 0.544651 0.761934 0.449875 0.698924 0.597230 0.252503 0.149860 0.124954 0.00497747  4.71163</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2975.096 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14:    -57.122716: -1.05628 0.887144 0.621162 0.746286 0.377752 0.704226 0.517575 0.263577 0.114298 0.184229 0.00515212  4.80920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5629.443 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  15:    -59.508340: -1.16932 0.831867 0.647262 0.740311 0.473678 0.698786 0.442163 0.126740 0.190201 0.212037 0.00583191  5.38867</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  4395.124 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  16:    -63.076455: -1.15522 0.976613 0.645814 0.760813 0.523103 0.518533 0.436436 0.149771 0.199569 0.171118 0.00602373  5.96632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  196.8215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  17:    -63.160743: -1.15522 0.976613 0.645814 0.760813 0.523103 0.518533 0.436436 0.149771 0.199569 0.171118 0.00598723  5.96632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  18.42406 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  18:    -63.161178: -1.15521 0.976604 0.645809 0.760798 0.523100 0.518521 0.436445 0.149773 0.199566 0.171117 0.00598550  5.96635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  461.7689 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  19:    -63.890234: -1.12318 0.928341 0.620142 0.679521 0.504704 0.446154 0.489708 0.158607 0.181216 0.166103 0.00601617  6.12062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  791.2478 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  20:    -66.036596: -0.800206 0.769772 0.518142 0.643273 0.495658 0.295760 0.349990 0.156598 0.120672 0.0735364 0.00553780  6.68285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  8171.629 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  21:    -69.640060: -0.668180 0.830978 0.522586 0.674831 0.529395 0.393655 0.415273 0.236722 0.179303 0.125246 0.00532357  7.36258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1565.565 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22:    -70.355079: -0.626741 0.844078 0.585063 0.678075 0.561437 0.412512 0.448970 0.234407 0.160557 0.127507 0.00518349  7.51316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16132.41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  23:    -70.925305: -0.656731 0.855902 0.591969 0.712135 0.557942 0.437277 0.462929 0.267301 0.186961 0.131086 0.00519836  7.67594</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  992.5871 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  24:    -72.287011: -0.656650 0.866594 0.616989 0.732895 0.565204 0.457702 0.481938 0.284546 0.196027 0.134163 0.00530147  7.84613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  10629.38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  25:    -75.105520: -0.494803 0.937004 0.806321 0.861938 0.579462 0.628636 0.624693 0.384401 0.289508 0.186246 0.00521692  9.70792</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  18969.12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26:    -76.692255: -0.333361 0.887587 0.734577 0.783233 0.508464 0.600339 0.566039 0.306909 0.258688 0.197094 0.00500158  10.0584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  6260.027 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  27:    -79.259103: -0.369687 0.862439 0.670965 0.759088 0.497862 0.596401 0.509338 0.276911 0.163088 0.176222 0.00526577  10.4567</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16287.87 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  28:    -81.053798: -0.376928 0.870388 0.626177 0.705981 0.497203 0.570252 0.452039 0.237364 0.224924 0.150962 0.00537596  10.8617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  12963.16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  29:    -82.151851: -0.364627 0.880116 0.606015 0.722805 0.507469 0.549036 0.458418 0.233001 0.224630 0.156515 0.00551800  11.2830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  8317.292 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  30:    -83.329837: -0.312697 0.874169 0.594294 0.739479 0.490313 0.514716 0.475484 0.229621 0.224870 0.172911 0.00546802  11.6999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16486.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  31:    -84.986835: -0.192865 0.853400 0.595130 0.717311 0.477081 0.490337 0.460508 0.235518 0.216189 0.162595 0.00536386  12.5363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16178.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  32:    -86.555130: -0.103660 0.852072 0.593116 0.723514 0.494456 0.507035 0.475202 0.234153 0.220827 0.171784 0.00526956  13.3773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  29858.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  33:    -88.596572: -0.0142778 0.872344 0.620063 0.744182 0.474163 0.523267 0.479167 0.257521 0.213986 0.146453 0.00535175  15.0663</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  4090.935 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34:    -88.615341: -0.000990104 0.902580 0.704435 0.787394 0.558575 0.568736 0.517017 0.339891 0.253565 0.244840 0.00543371  16.7473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  6186.975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  35:    -90.392363: 0.0985384 0.859188 0.666724 0.747058 0.538160 0.535854 0.494613 0.299087 0.221230 0.165105 0.00537535  17.5781</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  23677.06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  36:    -90.601197: 0.285604 0.888612 0.601393 0.700915 0.510188 0.513569 0.451882 0.236701 0.192324 0.123306 0.00521226  19.2551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5588.919 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  37:    -92.504051: 0.314496 0.858162 0.577322 0.696464 0.473482 0.521344 0.444638 0.208070 0.197319 0.121994 0.00516530  19.3876</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3309.08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  38:    -93.042504: 0.316922 0.850751 0.574503 0.695607 0.469865 0.519612 0.445518 0.208463 0.198603 0.125129 0.00518065  19.5363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3996.63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  39:    -93.550680: 0.320696 0.843080 0.584565 0.705608 0.469072 0.517989 0.444761 0.205085 0.200705 0.126715 0.00520644  19.8338</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  17353.55 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  40:    -93.849315: 0.332285 0.837332 0.584783 0.707135 0.467210 0.521062 0.448394 0.208314 0.202877 0.128243 0.00522856  20.1315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3405.852 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  41:    -94.407056: 0.332579 0.839173 0.587504 0.710933 0.467005 0.525668 0.458377 0.222650 0.205102 0.130059 0.00524213  20.4289</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3404.563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  42:    -94.965756: 0.338920 0.840802 0.596147 0.710362 0.473492 0.511102 0.456749 0.226911 0.203994 0.151338 0.00533730  21.2778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  11748.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  43:    -95.316637: 0.385967 0.835927 0.593772 0.718096 0.472878 0.514802 0.454765 0.233790 0.209386 0.152956 0.00531951  22.1258</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  29130.55 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  44:    -95.424402: 0.420794 0.842713 0.608494 0.718265 0.475041 0.523530 0.473653 0.236527 0.216087 0.158018 0.00532032  22.9741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  26449.94 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  45:    -95.903970: 0.450139 0.857210 0.610558 0.733591 0.486457 0.535133 0.464894 0.241707 0.218042 0.154504 0.00532282  23.8225</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7298.249 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  46:    -96.131311: 0.482761 0.846681 0.602681 0.722993 0.477555 0.529477 0.454398 0.235033 0.210310 0.152480 0.00525426  24.0062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  250.4761 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  47:    -96.389727: 0.518086 0.839935 0.588166 0.712551 0.469730 0.516715 0.450149 0.223988 0.204798 0.138545 0.00526928  24.7573</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5570.218 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  48:    -96.433056: 0.522167 0.839729 0.590534 0.711373 0.470034 0.519762 0.450951 0.224867 0.202519 0.140202 0.00528254  24.9677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  69.23836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  49:    -96.467542: 0.509726 0.844238 0.596187 0.714493 0.473705 0.522420 0.456543 0.228926 0.205282 0.143002 0.00530108  24.9226</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1869.847 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50:    -96.476842: 0.510728 0.845808 0.598652 0.716292 0.473691 0.521282 0.457649 0.230841 0.206275 0.145476 0.00530135  24.9706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  988.5663 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  51:    -96.477862: 0.510342 0.845604 0.598992 0.716570 0.474185 0.521700 0.457671 0.231137 0.206806 0.146619 0.00529885  24.9476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  366.5992 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  52:    -96.478432: 0.510367 0.844864 0.598549 0.716430 0.474189 0.521715 0.456429 0.230335 0.206506 0.146313 0.00529974  24.9515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  263.2514 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  53:    -96.478665: 0.510708 0.845145 0.598212 0.716479 0.474102 0.521763 0.456950 0.230563 0.206075 0.146307 0.00529881  24.9523</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  84.98653 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  54:    -96.478759: 0.510812 0.845169 0.598260 0.716418 0.474102 0.521785 0.456952 0.230616 0.206194 0.146271 0.00529867  24.9535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  23.88984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  55:    -96.478904: 0.511023 0.845110 0.598504 0.716409 0.474139 0.521776 0.456925 0.230574 0.206485 0.146241 0.00529877  24.9600</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  11.85171 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  56:    -96.478905: 0.511030 0.845113 0.598483 0.716339 0.474068 0.521750 0.456834 0.230581 0.206450 0.146206 0.00529887  24.9604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2.05176 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  57:    -96.478913: 0.511041 0.845112 0.598481 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.2997585 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  58:    -96.478915: 0.511043 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09257133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  59:    -96.478920: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09256928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  60:    -96.478921: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.0925664 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  61:    -96.478922: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09256415 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  62:    -96.478922: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  63:    -96.478922: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing standard errors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09256415 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7157.852 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  6484.594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  621.6198 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  635.2601 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  462.0846 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  472.2466 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  540.2503 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  552.1197 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  747.9303 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  764.5021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  696.8724 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  711.8765 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  601.0721 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  614.3962 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  823.469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  841.6159 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  727.6203 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  743.5208 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  430.3323 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  439.7047 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  372831.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  388700281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  260.1394 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  259.8767 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1 </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2.3: Fast fitting without standard errors</span></span></span>
<span class="r-in"><span><span class="co"># Useful for model exploration or large datasets</span></span></span>
<span class="r-in"><span><span class="va">fit_fast</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span>hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Note: Cannot compute confint() without hessian</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_fast</span><span class="op">)</span> <span class="co"># Point estimates still available</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)      alpha:batch1      alpha:batch2      alpha:batch3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0.511043664       0.845112184       0.598480138       0.716336887 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      alpha:batch4      alpha:batch5      alpha:batch6      alpha:batch7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0.474068576       0.521750284       0.456833294       0.230582142 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      alpha:batch8      alpha:batch9        alpha:temp  beta:(Intercept) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       0.206450367       0.146206617       0.005298865      24.960692248 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2.4: Custom convergence tolerances</span></span></span>
<span class="r-in"><span><span class="va">fit_tight</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    reltol <span class="op">=</span> <span class="fl">1e-10</span>, <span class="co"># Tighter convergence</span></span></span>
<span class="r-in"><span>    maxit <span class="op">=</span> <span class="fl">2000</span> <span class="co"># More iterations allowed</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 3: Advanced Formula Specifications</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3.1: Different predictors for different parameters</span></span></span>
<span class="r-in"><span><span class="co"># alpha depends on batch, beta depends on temp</span></span></span>
<span class="r-in"><span><span class="va">fit_diff</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">|</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_diff</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = yield ~ batch | temp, data = GasolineYield, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0931 -0.0192  0.0006 -0.0092  0.0127  0.0229 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.716145   0.067740  25.334  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.859082   0.066090  12.999  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.607943   0.067747   8.974  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.753252   0.066868  11.265  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.513857   0.066458   7.732 1.06e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.524146   0.070690   7.415 1.22e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.499502   0.069489   7.188 6.56e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.251466   0.066681   3.771 0.000162 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.203819   0.070869   2.876 0.004028 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.208587   0.080628   2.587 0.009680 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  43.700691   1.674361  26.100  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:temp         -0.084933   0.004366 -19.452  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.5834  1.8489</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.7295  0.9886</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.4752  0.7407</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.6222  0.8843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.3836  0.6441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.3856  0.6627</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.3633  0.6357</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.1208  0.3822</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.0649  0.3427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.0506  0.3666</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  40.4190 46.9824</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:temp         -0.0935 -0.0764</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 9.094</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 1.36e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 20 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 79.78 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -135.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -118 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.03321 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.9009 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.02256 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Failed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 47 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3.2: Intercept-only for one parameter</span></span></span>
<span class="r-in"><span><span class="co"># alpha varies with predictors, beta is constant</span></span></span>
<span class="r-in"><span><span class="va">fit_partial</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">|</span> <span class="fl">1</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 3.3: Complex model with interactions</span></span></span>
<span class="r-in"><span><span class="va">fit_interact</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">*</span> <span class="va">temp</span> <span class="op">|</span> <span class="va">temp</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/AsIs.html" class="external-link">I</a></span><span class="op">(</span><span class="va">temp</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 4: Working with Different Families</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4.1: Fit multiple families and compare</span></span></span>
<span class="r-in"><span><span class="va">families</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"beta"</span>, <span class="st">"kw"</span>, <span class="st">"ekw"</span>, <span class="st">"bkw"</span>, <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">families</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fam</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, data <span class="op">=</span> <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="va">fam</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fits</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">families</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare via information criteria</span></span></span>
<span class="r-in"><span><span class="va">comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Family <span class="op">=</span> <span class="va">families</span>,</span></span>
<span class="r-in"><span>  LogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fits</span>, <span class="va">logLik</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fits</span>, <span class="va">AIC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fits</span>, <span class="va">BIC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  npar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fits</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">$</span><span class="va">npar</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">comparison</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Family   LogLik        AIC        BIC npar</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   beta 45.26157  -66.52315  -48.93432   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kw       kw 96.47892 -168.95784 -151.36901   12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ekw     ekw 97.28973 -168.57946 -149.52490   13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bkw     bkw 96.44144 -164.88287 -144.36257   14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkw     gkw 96.52548 -163.05096 -141.06492   15</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 4.2: Formal nested model testing</span></span></span>
<span class="r-in"><span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="va">fit_ekw</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"ekw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="va">fit_gkw</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit_kw</span>, <span class="va">fit_ekw</span>, <span class="va">fit_gkw</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>negative deviance change detected; models may not be nested</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 3: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         Resid. Df Resid. Dev Df Deviance Pr(&gt;Chi)  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_kw   20.00000 -192.95784                       </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_ekw  19.00000 -194.57946  1  1.62162  0.20287  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_gkw  17.00000 -193.05096  2 -1.52851           </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 5: Link Functions and Scales</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5.1: Custom link functions</span></span></span>
<span class="r-in"><span><span class="va">fit_links</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="st">"sqrt"</span>, beta <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5.2: Custom link scales</span></span></span>
<span class="r-in"><span><span class="co"># Smaller scale = steeper response curve</span></span></span>
<span class="r-in"><span><span class="va">fit_scale</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  link_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">5</span>, beta <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 5.3: Uniform link for all parameters</span></span></span>
<span class="r-in"><span><span class="va">fit_uniform</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="st">"log"</span> <span class="co"># Single string applied to all</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 6: Prediction and Inference</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model for prediction examples</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 6.1: Confidence intervals at different levels</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, level <span class="op">=</span> <span class="fl">0.95</span><span class="op">)</span> <span class="co"># 95% CI</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>some standard errors are NA or infinite; intervals may be unreliable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         2.5 %     97.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.46546878  0.5566185</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.79054008  0.8996843</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.53953733  0.6574229</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.65732574  0.7753480</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.41885996  0.5292772</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.46088005  0.5826205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.39671081  0.5169558</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.17469502  0.2864693</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.14465787  0.2682429</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.07755916  0.2148541</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp                NaN        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  24.27478345 25.6466010</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, level <span class="op">=</span> <span class="fl">0.90</span><span class="op">)</span> <span class="co"># 90% CI</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>some standard errors are NA or infinite; intervals may be unreliable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                           5 %       95 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.47279602  0.5492913</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.79931383  0.8909105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.54901378  0.6479465</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.66681317  0.7658606</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.42773605  0.5204011</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.47066637  0.5728342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.40637691  0.5072897</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.18368019  0.2774841</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.15459247  0.2583083</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.08859585  0.2038174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp                NaN        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  24.38505944 25.5363251</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/confint.html" class="external-link">confint</a></span><span class="op">(</span><span class="va">fit</span>, level <span class="op">=</span> <span class="fl">0.99</span><span class="op">)</span> <span class="co"># 99% CI</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>some standard errors are NA or infinite; intervals may be unreliable</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         0.5 %     99.5 %</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.45114812  0.5709392</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.77339228  0.9168321</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.52101616  0.6759441</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.63878309  0.7938907</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.40151216  0.5466250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.44175323  0.6017473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.37781896  0.5358476</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.15713401  0.3040303</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.12524127  0.2876595</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.05598857  0.2364247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp                NaN        NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  24.05925529 25.8621292</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 7: Diagnostic Plots and Model Checking</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 7.1: All diagnostic plots (default)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, ask <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 7.2: Select specific plots</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span><span class="op">)</span> <span class="co"># Cook's distance, Residuals, Half-normal</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 7.3: Using ggplot2 for modern graphics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>, arrange_plots <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 7.4: Customized half-normal plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">5</span>,</span></span>
<span class="r-in"><span>  type <span class="op">=</span> <span class="st">"quantile"</span>,</span></span>
<span class="r-in"><span>  nsim <span class="op">=</span> <span class="fl">200</span>, <span class="co"># More simulations for smoother envelope</span></span></span>
<span class="r-in"><span>  level <span class="op">=</span> <span class="fl">0.95</span></span></span>
<span class="r-in"><span><span class="op">)</span> <span class="co"># 95% confidence envelope</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 200 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 7.5: Extract diagnostic data programmatically</span></span></span>
<span class="r-in"><span><span class="va">diagnostics</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, save_diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">diagnostics</span><span class="op">$</span><span class="va">data</span><span class="op">)</span> <span class="co"># Residuals, Cook's distance, etc.</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   index y_obs    fitted      resid abs_resid   cook_dist  leverage  linpred</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1 0.122 0.1092212  1.1932643 1.1932643 0.137685117 0.3755669 2.442423</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     2 0.223 0.2166827  0.2915295 0.2915295 0.008703730 0.3853667 2.813344</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     3 0.347 0.3478678 -0.1958711 0.1958711 0.004293383 0.4005540 3.184264</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     4 0.457 0.4673080 -0.7144760 0.7144760 0.054452114 0.3923400 3.512794</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     5 0.080 0.0710716  1.0395827 1.0395827 0.113486840 0.3896549 2.264676</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     6 0.131 0.1384736 -0.6639264 0.6639264 0.043172353 0.3777472 2.556114</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 8: Real Data Example - Food Expenditure</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load and prepare data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">FoodExpenditure</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">food_data</span> <span class="op">&lt;-</span> <span class="va">FoodExpenditure</span></span></span>
<span class="r-in"><span><span class="va">food_data</span><span class="op">$</span><span class="va">prop</span> <span class="op">&lt;-</span> <span class="va">food_data</span><span class="op">$</span><span class="va">food</span> <span class="op">/</span> <span class="va">food_data</span><span class="op">$</span><span class="va">income</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 8.1: Basic model</span></span></span>
<span class="r-in"><span><span class="va">fit_food</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">prop</span> <span class="op">~</span> <span class="va">persons</span> <span class="op">|</span> <span class="va">income</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">food_data</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_food</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = prop ~ persons | income, data = food_data, family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1668 -0.0417  0.0098 -0.0047  0.0396  0.1527 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.26876    0.14206   8.931  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:persons      0.07210    0.01895   3.805 0.000142 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   3.21312    0.63879   5.030  4.9e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:income        0.03623    0.00922   3.930  8.5e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       3%    98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept) 0.9903 1.5472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:persons     0.0350 0.1092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  1.9611 4.4651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:income       0.0182 0.0543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 4.638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 244.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 46.34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -84.69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -78.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.07442 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.4465 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.05784 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 18 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 8.2: Compare with Beta regression</span></span></span>
<span class="r-in"><span><span class="va">fit_food_beta</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">prop</span> <span class="op">~</span> <span class="va">persons</span> <span class="op">|</span> <span class="va">income</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">food_data</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"beta"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Which fits better?</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">fit_food</span>, <span class="va">fit_food_beta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               df       AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_food       4 -84.68830</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit_food_beta  4 -70.28298</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 8.3: Model diagnostics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit_food</span>, which <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">5</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 8.4: Interpretation via effects</span></span></span>
<span class="r-in"><span><span class="co"># How does proportion spent on food change with income?</span></span></span>
<span class="r-in"><span><span class="va">income_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">food_data</span><span class="op">$</span><span class="va">income</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">food_data</span><span class="op">$</span><span class="va">income</span><span class="op">)</span>, length <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  persons <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/median.html" class="external-link">median</a></span><span class="op">(</span><span class="va">food_data</span><span class="op">$</span><span class="va">persons</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  income <span class="op">=</span> <span class="va">income_seq</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pred_food</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_food</span>, newdata <span class="op">=</span> <span class="va">pred_data</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">food_data</span><span class="op">$</span><span class="va">income</span>, <span class="va">food_data</span><span class="op">$</span><span class="va">prop</span>,</span></span>
<span class="r-in"><span>  xlab <span class="op">=</span> <span class="st">"Income"</span>, ylab <span class="op">=</span> <span class="st">"Proportion Spent on Food"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Food Expenditure Pattern"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">income_seq</span>, <span class="va">pred_food</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwreg-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 9: Simulation Studies</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 9.1: Simple Kumaraswamy simulation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">500</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True model: log(alpha) = 0.8 + 0.3*x1, log(beta) = 1.2 - 0.2*x2</span></span></span>
<span class="r-in"><span><span class="va">eta_alpha</span> <span class="op">&lt;-</span> <span class="fl">0.8</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x1</span></span></span>
<span class="r-in"><span><span class="va">eta_beta</span> <span class="op">&lt;-</span> <span class="fl">1.2</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">alpha_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta_alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://evandeilton.github.io/gkwdist/reference/rkw.html" class="external-link">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">alpha_true</span>, beta <span class="op">=</span> <span class="va">beta_true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit and check parameter recovery</span></span></span>
<span class="r-in"><span><span class="va">fit_sim</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">sim_data</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare estimated vs true coefficients</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  True <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Estimated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_sim</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  SE <span class="op">=</span> <span class="va">fit_sim</span><span class="op">$</span><span class="va">se</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   True  Estimated         SE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.8  0.8013394 0.04562729</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x1           0.3  0.3011747 0.02418262</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   1.2  1.1896310 0.07482055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x2           -0.2 -0.2419618 0.04607844</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 9.2: Complex simulation with all five parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True parameters</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.5</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">1.0</span> <span class="op">-</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="fl">0.7</span> <span class="op">+</span> <span class="fl">0.4</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="fl">0.0</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span> <span class="co"># logit scale</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.3</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate from GKw</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://evandeilton.github.io/gkwdist/reference/rgkw.html" class="external-link">rgkw</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, gamma <span class="op">=</span> <span class="va">gamma</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="va">delta</span>, lambda <span class="op">=</span> <span class="va">lambda</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">sim_data2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit GKw model</span></span></span>
<span class="r-in"><span><span class="va">fit_gkw</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">~</span> <span class="va">x</span> <span class="op">|</span> <span class="va">x</span> <span class="op">|</span> <span class="va">x</span> <span class="op">|</span> <span class="va">x</span> <span class="op">|</span> <span class="va">x</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">sim_data2</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"gkw"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span>maxit <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_gkw</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: gkw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = y ~ x | x | x | x | x, data = sim_data2, family = "gkw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     control = gkw_control(maxit = 1000))</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.3791 -0.1005  0.0274  0.0343  0.1497  0.6128 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)    0.8711     0.3012   2.892 0.003825 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x             -0.8149     0.2937  -2.775 0.005526 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)    -0.7094     0.2486  -2.854 0.004318 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x               0.2722     0.1536   1.772 0.076423 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:(Intercept)    0.1728     0.3166   0.546 0.585283    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:x              0.3077     0.6980   0.441 0.659327    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:(Intercept)    1.0725     1.3415   0.799 0.424022    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:x              1.3580     0.8127   1.671 0.094736 .  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept)  -0.2392     0.2789  -0.858 0.391068    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:x             1.2660     0.3368   3.759 0.000171 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)   0.2808  1.4614</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x            -1.3905 -0.2393</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   -1.1965 -0.2222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x             -0.0289  0.5733</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:(Intercept)  -0.4478  0.7933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma:x            -1.0603  1.6757</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:(Intercept)  -1.5568  3.7018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta:x            -0.2349  2.9509</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -0.7858  0.3074</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:x            0.6059  1.9261</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: logit</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 2.588</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 0.5032</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1.222</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 7.286</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1.062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 990 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 421.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -823.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -774 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.1727 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.3194 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.1404 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 88 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 10: Handling Convergence Issues</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 10.1: Try different optimizers</span></span></span>
<span class="r-in"><span><span class="va">methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nlminb"</span>, <span class="st">"BFGS"</span>, <span class="st">"Nelder-Mead"</span>, <span class="st">"CG"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fits_methods</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html" class="external-link">tryCatch</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>      family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>      control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span>method <span class="op">=</span> <span class="va">m</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">fits_methods</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">methods</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check which converged</span></span></span>
<span class="r-in"><span><span class="va">converged</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fits_methods</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">f</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">f</span><span class="op">$</span><span class="va">convergence</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">converged</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      nlminb        BFGS Nelder-Mead          CG </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       FALSE        TRUE        TRUE       FALSE </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 10.2: Verbose mode for debugging</span></span></span>
<span class="r-in"><span><span class="va">fit_debug</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    silent <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    trace <span class="op">=</span> <span class="fl">2</span>, <span class="co"># Maximum verbosity</span></span></span>
<span class="r-in"><span>    maxit <span class="op">=</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using TMB model: kwreg</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Checking TMB model status for  kwreg ...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found TMB source file:  /home/jlopes/R/x86_64-pc-linux-gnu-library/4.5/gkwreg/tmb/kwreg.cpp </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Found cached TMB model:  /home/jlopes/.cache/gkwreg/tmb_cache/R4.5/2.0.0/kwreg.so </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Successfully loaded cached TMB model.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Optimizing with nlminb...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7535.888 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0:-7.1054274e-14:  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000  0.00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1043.999 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  248.2347 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   2:    -5.6372510: -0.000220415 4.16287e-05 -6.57121e-05 -4.96481e-05 -2.17994e-05 4.41064e-05 1.14631e-05 -0.000146966 -2.99241e-05 1.37058e-05 -0.00157060 0.00131183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  473.1837 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  9403.659 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   4:    -26.755529: -1.05462 0.724290 -0.0972976 0.0815258 -0.00801223 0.221600 0.0531230 -0.597665 -0.396572 -0.204538 0.00463826  1.75768</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2886.778 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7.749627 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   6:    -37.319116: -1.99422 0.532895 0.375388 0.595205 0.184898 0.118380 0.0752172 0.0400089 -0.446347 -0.559931 0.00728617  2.61648</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  550.0578 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5344.69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   8:    -45.753042: -1.76430  1.27538  1.24545  1.16880 0.977965 0.907505 0.936306 0.774485  1.02539 0.611458 0.00552332  4.00061</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1670.43 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  9795.288 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  10:    -51.767663: -1.40959  1.20843 0.839361 0.870775 0.757785 0.725397 0.685794 0.396577 0.539655 0.627278 0.00501252  4.22953</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2710.496 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16842.91 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  12:    -53.429246: -1.03560 0.930350 0.552767 0.812949 0.558985 0.739392 0.653578 0.201404 0.199360 0.0828970 0.00510502  4.64797</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1617.054 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2975.096 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  14:    -57.122716: -1.05628 0.887144 0.621162 0.746286 0.377752 0.704226 0.517575 0.263577 0.114298 0.184229 0.00515212  4.80920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5629.443 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  4395.124 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  16:    -63.076455: -1.15522 0.976613 0.645814 0.760813 0.523103 0.518533 0.436436 0.149771 0.199569 0.171118 0.00602373  5.96632</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  196.8215 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  18.42406 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  18:    -63.161178: -1.15521 0.976604 0.645809 0.760798 0.523100 0.518521 0.436445 0.149773 0.199566 0.171117 0.00598550  5.96635</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  461.7689 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  791.2478 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  20:    -66.036596: -0.800206 0.769772 0.518142 0.643273 0.495658 0.295760 0.349990 0.156598 0.120672 0.0735364 0.00553780  6.68285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  8171.629 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1565.565 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  22:    -70.355079: -0.626741 0.844078 0.585063 0.678075 0.561437 0.412512 0.448970 0.234407 0.160557 0.127507 0.00518349  7.51316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16132.41 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  992.5871 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  24:    -72.287011: -0.656650 0.866594 0.616989 0.732895 0.565204 0.457702 0.481938 0.284546 0.196027 0.134163 0.00530147  7.84613</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  10629.38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  18969.12 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  26:    -76.692255: -0.333361 0.887587 0.734577 0.783233 0.508464 0.600339 0.566039 0.306909 0.258688 0.197094 0.00500158  10.0584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  6260.027 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16287.87 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  28:    -81.053798: -0.376928 0.870388 0.626177 0.705981 0.497203 0.570252 0.452039 0.237364 0.224924 0.150962 0.00537596  10.8617</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  12963.16 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  8317.292 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  30:    -83.329837: -0.312697 0.874169 0.594294 0.739479 0.490313 0.514716 0.475484 0.229621 0.224870 0.172911 0.00546802  11.6999</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16486.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  16178.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  32:    -86.555130: -0.103660 0.852072 0.593116 0.723514 0.494456 0.507035 0.475202 0.234153 0.220827 0.171784 0.00526956  13.3773</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  29858.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  4090.935 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  34:    -88.615341: -0.000990104 0.902580 0.704435 0.787394 0.558575 0.568736 0.517017 0.339891 0.253565 0.244840 0.00543371  16.7473</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  6186.975 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  23677.06 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  36:    -90.601197: 0.285604 0.888612 0.601393 0.700915 0.510188 0.513569 0.451882 0.236701 0.192324 0.123306 0.00521226  19.2551</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5588.919 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3309.08 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  38:    -93.042504: 0.316922 0.850751 0.574503 0.695607 0.469865 0.519612 0.445518 0.208463 0.198603 0.125129 0.00518065  19.5363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3996.63 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  17353.55 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  40:    -93.849315: 0.332285 0.837332 0.584783 0.707135 0.467210 0.521062 0.448394 0.208314 0.202877 0.128243 0.00522856  20.1315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3405.852 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  3404.563 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  42:    -94.965756: 0.338920 0.840802 0.596147 0.710362 0.473492 0.511102 0.456749 0.226911 0.203994 0.151338 0.00533730  21.2778</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  11748.02 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  29130.55 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  44:    -95.424402: 0.420794 0.842713 0.608494 0.718265 0.475041 0.523530 0.473653 0.236527 0.216087 0.158018 0.00532032  22.9741</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  26449.94 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7298.249 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  46:    -96.131311: 0.482761 0.846681 0.602681 0.722993 0.477555 0.529477 0.454398 0.235033 0.210310 0.152480 0.00525426  24.0062</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  250.4761 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  5570.218 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  48:    -96.433056: 0.522167 0.839729 0.590534 0.711373 0.470034 0.519762 0.450951 0.224867 0.202519 0.140202 0.00528254  24.9677</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  69.23836 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1869.847 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  50:    -96.476842: 0.510728 0.845808 0.598652 0.716292 0.473691 0.521282 0.457649 0.230841 0.206275 0.145476 0.00530135  24.9706</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  988.5663 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  366.5992 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  52:    -96.478432: 0.510367 0.844864 0.598549 0.716430 0.474189 0.521715 0.456429 0.230335 0.206506 0.146313 0.00529974  24.9515</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  263.2514 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  84.98653 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  54:    -96.478759: 0.510812 0.845169 0.598260 0.716418 0.474102 0.521785 0.456952 0.230616 0.206194 0.146271 0.00529867  24.9535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  23.88984 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  11.85171 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  56:    -96.478905: 0.511030 0.845113 0.598483 0.716339 0.474068 0.521750 0.456834 0.230581 0.206450 0.146206 0.00529887  24.9604</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  2.05176 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.2997585 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  58:    -96.478915: 0.511043 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09257133 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09256928 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  60:    -96.478921: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.0925664 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09256415 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  62:    -96.478922: 0.511044 0.845112 0.598480 0.716337 0.474069 0.521750 0.456833 0.230582 0.206450 0.146207 0.00529887  24.9607</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Computing standard errors...</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  0.09256415 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  7157.852 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  6484.594 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  621.6198 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  635.2601 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  462.0846 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  472.2466 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  540.2503 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  552.1197 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  747.9303 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  764.5021 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  696.8724 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  711.8765 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  601.0721 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  614.3962 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  823.469 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  841.6159 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  727.6203 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  743.5208 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  430.3323 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  439.7047 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  372831.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  388700281 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  260.1394 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  259.8767 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> outer mgc:  1 </span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 11: Memory and Performance Optimization</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 11.1: Minimal object for large datasets</span></span></span>
<span class="r-in"><span><span class="va">fit_minimal</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  model <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Don't store model frame</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Don't store design matrices</span></span></span>
<span class="r-in"><span>  y <span class="op">=</span> <span class="cn">FALSE</span>, <span class="co"># Don't store response</span></span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span>hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="co"># Skip Hessian</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Much smaller object</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">fit_minimal</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 745256 bytes</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Trade-off: Limited post-fitting capabilities</span></span></span>
<span class="r-in"><span><span class="co"># Can still use: coef(), logLik(), AIC(), BIC()</span></span></span>
<span class="r-in"><span><span class="co"># Cannot use: predict(), some diagnostics</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 11.2: Fast exploratory analysis</span></span></span>
<span class="r-in"><span><span class="co"># Fit many models quickly without standard errors</span></span></span>
<span class="r-in"><span><span class="va">formulas</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span>,</span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>,</span></span>
<span class="r-in"><span>  <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">*</span> <span class="va">temp</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">fast_fits</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">formulas</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">gkwreg</span><span class="op">(</span><span class="va">f</span>, <span class="va">GasolineYield</span>,</span></span>
<span class="r-in"><span>    family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>    control <span class="op">=</span> <span class="fu"><a href="gkw_control.html">gkw_control</a></span><span class="op">(</span>hessian <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    model <span class="op">=</span> <span class="cn">FALSE</span>, x <span class="op">=</span> <span class="cn">FALSE</span>, y <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare models via AIC</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fast_fits</span>, <span class="va">AIC</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  -42.93436  -74.90259 -168.95784 -169.73262</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Refit best model with full inference</span></span></span>
<span class="r-in"><span><span class="va">best_formula</span> <span class="op">&lt;-</span> <span class="va">formulas</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">fast_fits</span>, <span class="va">AIC</span><span class="op">)</span><span class="op">)</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit_final</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">best_formula</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_final</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = best_formula, data = GasolineYield, family = "kw")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0348 -0.0005  0.0050  0.0036  0.0080  0.0152 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.3336413  0.0207832   64.17   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.1985791        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2      -0.0936398        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3      -0.2645930        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4      -0.2347967        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5      -0.8289201        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6      -0.2690259        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7      -0.6041666        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8      -0.8590190        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9      -0.1547805        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp         0.0033288        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1:temp  0.0015734        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2:temp  0.0017075        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3:temp  0.0027438        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4:temp  0.0018139        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5:temp  0.0035480        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6:temp  0.0018728        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7:temp  0.0021980        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8:temp  0.0027717        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9:temp  0.0007384        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  26.6038003  0.3693315   72.03   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.2929  1.3744</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9          NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp            NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9:temp     NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  25.8799 27.3277</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 16.83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 3.576e+11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 21 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 11 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 105.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -169.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -139 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.009555 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.9918 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.007052 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Failed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 264 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># SECTION 12: Model Selection and Comparison</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 12.1: Nested model testing</span></span></span>
<span class="r-in"><span><span class="va">fit1</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="fl">1</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit2</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit3</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">GasolineYield</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Likelihood ratio tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/stats/anova.html" class="external-link">anova</a></span><span class="op">(</span><span class="va">fit1</span>, <span class="va">fit2</span>, <span class="va">fit3</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Analysis of Deviance Table</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 1: yield ~ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 2: yield ~ batch</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model 3: yield ~ batch + temp</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Resid. Df Resid. Dev Df  Deviance Pr(&gt;Chi)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit1  30.00000  -57.02258                          </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit2  21.00000  -64.93436  9   7.91178  0.54306    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> fit3  20.00000 -192.95784  1 128.02349  &lt; 1e-04 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 12.2: Information criteria table</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="st">"Intercept only"</span> <span class="op">=</span> <span class="va">fit1</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Batch effect"</span> <span class="op">=</span> <span class="va">fit2</span>,</span></span>
<span class="r-in"><span>  <span class="st">"Batch + Temp"</span> <span class="op">=</span> <span class="va">fit3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ic_table</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">models</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  df <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="kw">function</span><span class="op">(</span><span class="va">m</span><span class="op">)</span> <span class="va">m</span><span class="op">$</span><span class="va">npar</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  LogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">logLik</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">AIC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">BIC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Delta_AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">AIC</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">models</span>, <span class="va">AIC</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ic_table</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         Model df   LogLik        AIC        BIC Delta_AIC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Intercept only Intercept only  2 28.51129  -53.02258  -50.09111  115.9353</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Batch effect     Batch effect 11 32.46718  -42.93436  -26.81126  126.0235</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Batch + Temp     Batch + Temp 12 96.47892 -168.95784 -151.36901    0.0000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 12.3: Cross-validation for predictive performance</span></span></span>
<span class="r-in"><span><span class="co"># 5-fold cross-validation</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">GasolineYield</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, length.out <span class="op">=</span> <span class="va">n</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">cv_rmse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="kw">function</span><span class="op">(</span><span class="va">fold</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">train</span> <span class="op">&lt;-</span> <span class="va">GasolineYield</span><span class="op">[</span><span class="va">folds</span> <span class="op">!=</span> <span class="va">fold</span>, <span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">test</span> <span class="op">&lt;-</span> <span class="va">GasolineYield</span><span class="op">[</span><span class="va">folds</span> <span class="op">==</span> <span class="va">fold</span>, <span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">fit_train</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span>, <span class="va">train</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">pred_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">fit_train</span>, newdata <span class="op">=</span> <span class="va">test</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="op">(</span><span class="va">test</span><span class="op">$</span><span class="va">yield</span> <span class="op">-</span> <span class="va">pred_test</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Cross-validated RMSE:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">cv_rmse</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Cross-validated RMSE: 0.02065961 </span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

