<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Generalized Kumaraswamy Regression Models — gkwreg • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Generalized Kumaraswamy Regression Models — gkwreg"><meta name="description" content="Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for response variables strictly bounded in the interval (0, 1).
The function allows modeling parameters from all seven submodels of the GKw
family as functions of predictors using appropriate link functions. Estimation
is performed using Maximum Likelihood via the TMB (Template Model Builder) package.
Requires the Formula and TMB packages."><meta property="og:description" content="Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for response variables strictly bounded in the interval (0, 1).
The function allows modeling parameters from all seven submodels of the GKw
family as functions of predictors using appropriate link functions. Estimation
is performed using Maximum Likelihood via the TMB (Template Model Builder) package.
Requires the Formula and TMB packages."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Generalized Kumaraswamy Regression Models</h1>

      <div class="d-none name"><code>gkwreg.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits regression models using the Generalized Kumaraswamy (GKw) family of
distributions for response variables strictly bounded in the interval (0, 1).
The function allows modeling parameters from all seven submodels of the GKw
family as functions of predictors using appropriate link functions. Estimation
is performed using Maximum Likelihood via the TMB (Template Model Builder) package.
Requires the <code>Formula</code> and <code>TMB</code> packages.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gkwreg</span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gkw"</span>, <span class="st">"bkw"</span>, <span class="st">"kkw"</span>, <span class="st">"ekw"</span>, <span class="st">"mc"</span>, <span class="st">"kw"</span>, <span class="st">"beta"</span><span class="op">)</span>,</span>
<span>  link <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  link_scale <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"nlminb"</span>, <span class="st">"BFGS"</span>, <span class="st">"Nelder-Mead"</span>, <span class="st">"CG"</span>, <span class="st">"SANN"</span>, <span class="st">"L-BFGS-B"</span><span class="op">)</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  optimizer.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  offset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  na.action <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">getOption</a></span><span class="op">(</span><span class="st">"na.action"</span><span class="op">)</span>,</span>
<span>  contrasts <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  x <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  y <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  model <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An object of class <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> (or one that
can be coerced to that class). It should be structured as
<code>y ~ model_alpha | model_beta | model_gamma | model_delta | model_lambda</code>,
where <code>y</code> is the response variable and each <code>model_*</code> part specifies
the linear predictor for the corresponding parameter (\(\alpha\), \(\beta\),
\(\gamma\), \(\delta\), \(\lambda\)). If a part is omitted or specified
as <code>~ 1</code> or <code>.</code>, an intercept-only model is used for that parameter.
See Details for parameter correspondence in subfamilies.</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame containing the variables specified in the <code>formula</code>.</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the desired distribution family.
Defaults to <code>"gkw"</code>. Supported families are:</p><ul><li><p><code>"gkw"</code>: Generalized Kumaraswamy (5 parameters: \(\alpha, \beta, \gamma, \delta, \lambda\))</p></li>
<li><p><code>"bkw"</code>: Beta-Kumaraswamy (4 parameters: \(\alpha, \beta, \gamma, \delta\); \(\lambda = 1\) fixed)</p></li>
<li><p><code>"kkw"</code>: Kumaraswamy-Kumaraswamy (4 parameters: \(\alpha, \beta, \delta, \lambda\); \(\gamma = 1\) fixed)</p></li>
<li><p><code>"ekw"</code>: Exponentiated Kumaraswamy (3 parameters: \(\alpha, \beta, \lambda\); \(\gamma = 1, \delta = 0\) fixed)</p></li>
<li><p><code>"mc"</code>: McDonald / Beta Power (3 parameters: \(\gamma, \delta, \lambda\); \(\alpha = 1, \beta = 1\) fixed)</p></li>
<li><p><code>"kw"</code>: Kumaraswamy (2 parameters: \(\alpha, \beta\); \(\gamma = 1, \delta = 0, \lambda = 1\) fixed)</p></li>
<li><p><code>"beta"</code>: Beta distribution (2 parameters: \(\gamma, \delta\); \(\alpha = 1, \beta = 1, \lambda = 1\) fixed)</p></li>
</ul></dd>


<dt id="arg-link">link<a class="anchor" aria-label="anchor" href="#arg-link"></a></dt>
<dd><p>Either a single character string specifying the same link function
for all relevant parameters, or a named list specifying the link function for each
modeled parameter (e.g., <code>list(alpha = "log", beta = "log", delta = "logit")</code>).
Defaults are <code>"log"</code> for \(\alpha, \beta, \gamma, \lambda\) (parameters &gt; 0)
and <code>"logit"</code> for \(\delta\) (parameter in (0, 1)).
Supported link functions are:</p><ul><li><p><code>"log"</code>: logarithmic link, maps \((0, \infty)\) to \((-\infty, \infty)\)</p></li>
<li><p><code>"identity"</code>: identity link, no transformation</p></li>
<li><p><code>"inverse"</code>: inverse link, maps \(x\) to \(1/x\)</p></li>
<li><p><code>"sqrt"</code>: square root link, maps \(x\) to \(\sqrt{x}\)</p></li>
<li><p><code>"inverse-square"</code>: inverse squared link, maps \(x\) to \(1/x^2\)</p></li>
<li><p><code>"logit"</code>: logistic link, maps \((0, 1)\) to \((-\infty, \infty)\)</p></li>
<li><p><code>"probit"</code>: probit link, using normal CDF</p></li>
<li><p><code>"cloglog"</code>: complementary log-log</p></li>
<li><p><code>"cauchy"</code>: Cauchy link, using Cauchy CDF</p></li>
</ul></dd>


<dt id="arg-link-scale">link_scale<a class="anchor" aria-label="anchor" href="#arg-link-scale"></a></dt>
<dd><p>Either a single numeric value specifying the same scale for all
link functions, or a named list specifying the scale for each parameter's link
function (e.g., <code>list(alpha = 10, beta = 5, delta = 1)</code>). The scale affects
how the link function transforms the linear predictor. Default is 10 for most
parameters and 1 for parameters using probability-type links (such as <code>delta</code>).
For probability-type links (logit, probit, cloglog, cauchy), smaller values
produce more extreme transformations.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>An optional named list providing initial values for the regression
coefficients. Parameter names should match the distribution parameters (alpha,
beta, etc.), and values should be vectors corresponding to the coefficients
in the respective linear predictors (including intercept). If <code>NULL</code>
(default), suitable starting values are automatically determined based on
global parameter estimates.</p></dd>


<dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p>An optional named list specifying parameters or coefficients to be
held fixed at specific values during estimation. Currently not fully implemented.</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Character string specifying the optimization algorithm to use.
Options are <code>"nlminb"</code> (default, using <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code>),
<code>"BFGS"</code>, <code>"Nelder-Mead"</code>, <code>"CG"</code>, <code>"SANN"</code>, or <code>"L-BFGS-B"</code>.
If <code>"nlminb"</code> is selected, R's <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> function is used;
otherwise, R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> function is used with the specified method.</p></dd>


<dt id="arg-hessian">hessian<a class="anchor" aria-label="anchor" href="#arg-hessian"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the Hessian matrix is computed
via <code><a href="https://rdrr.io/pkg/TMB/man/sdreport.html" class="external-link">sdreport</a></code> to obtain standard errors and the covariance
matrix of the estimated coefficients. Setting to <code>FALSE</code> speeds up fitting
but prevents calculation of standard errors and confidence intervals.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), enables the generation of diagnostic
plots when calling the generic <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function on the fitted object.
Actual plotting is handled by the <code>plot.gkwreg</code> method.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Numeric. The confidence level (1 - alpha) for constructing
confidence intervals for the parameters. Default is 0.95. Used only if
<code>hessian = TRUE</code>.</p></dd>


<dt id="arg-optimizer-control">optimizer.control<a class="anchor" aria-label="anchor" href="#arg-optimizer-control"></a></dt>
<dd><p>A list of control parameters passed directly to the
chosen optimizer (<code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> or <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>).
See their respective documentation for details.</p></dd>


<dt id="arg-subset">subset<a class="anchor" aria-label="anchor" href="#arg-subset"></a></dt>
<dd><p>An optional vector specifying a subset of observations from <code>data</code>
to be used in the fitting process.</p></dd>


<dt id="arg-weights">weights<a class="anchor" aria-label="anchor" href="#arg-weights"></a></dt>
<dd><p>An optional vector of prior weights (e.g., frequency weights)
to be used in the fitting process. Should be <code>NULL</code> or a numeric vector
of non-negative values.</p></dd>


<dt id="arg-offset">offset<a class="anchor" aria-label="anchor" href="#arg-offset"></a></dt>
<dd><p>An optional numeric vector or matrix specifying an a priori known
component to be included <em>on the scale of the linear predictor</em> for each parameter.
If a vector, it's applied to the predictor of the first parameter in the standard
order (\(\alpha\)). If a matrix, columns must correspond to parameters in the
order \(\alpha, \beta, \gamma, \delta, \lambda\).</p></dd>


<dt id="arg-na-action">na.action<a class="anchor" aria-label="anchor" href="#arg-na-action"></a></dt>
<dd><p>A function which indicates what should happen when the data
contain <code>NA</code>s. The default (<code>na.fail</code>) stops if <code>NA</code>s are
present. Other options include <code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></code> or
<code><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.exclude</a></code>.</p></dd>


<dt id="arg-contrasts">contrasts<a class="anchor" aria-label="anchor" href="#arg-contrasts"></a></dt>
<dd><p>An optional list specifying the contrasts to be used for factor
variables in the model. See the <code>contrasts.arg</code> of
<code><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix.default</a></code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Logical. If <code>TRUE</code>, the list of model matrices (one for each modeled
parameter) is returned as component <code>x</code> of the fitted object. Default <code>FALSE</code>.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the response variable (after processing
by <code>na.action</code>, <code>subset</code>) is returned as component <code>y</code>.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the model frame (containing all
variables used from <code>data</code>) is returned as component <code>model</code>.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), suppresses progress messages
from TMB compilation and optimization. Set to <code>FALSE</code> for verbose output.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments, currently unused or passed down to internal
methods (potentially).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>gkwreg</code>. This is a list containing the
following components:</p>
<dl><dt>call</dt>
<dd><p>The matched function call.</p></dd>

<dt>family</dt>
<dd><p>The specified distribution family string.</p></dd>

<dt>formula</dt>
<dd><p>The <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> object used.</p></dd>

<dt>coefficients</dt>
<dd><p>A named vector of estimated regression coefficients.</p></dd>

<dt>fitted.values</dt>
<dd><p>Vector of estimated means (expected values) of the response.</p></dd>

<dt>residuals</dt>
<dd><p>Vector of response residuals (observed - fitted mean).</p></dd>

<dt>fitted_parameters</dt>
<dd><p>List containing the estimated mean value for each distribution parameter (\(\alpha, \beta, \gamma, \delta, \lambda\)).</p></dd>

<dt>parameter_vectors</dt>
<dd><p>List containing vectors of the estimated parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) for each observation, evaluated on the link scale.</p></dd>

<dt>link</dt>
<dd><p>List of link functions used for each parameter.</p></dd>

<dt>param_names</dt>
<dd><p>Character vector of names of the parameters modeled by the family.</p></dd>

<dt>fixed_params</dt>
<dd><p>Named list indicating which parameters are fixed by the family definition.</p></dd>

<dt>loglik</dt>
<dd><p>The maximized log-likelihood value.</p></dd>

<dt>aic</dt>
<dd><p>Akaike Information Criterion.</p></dd>

<dt>bic</dt>
<dd><p>Bayesian Information Criterion.</p></dd>

<dt>deviance</dt>
<dd><p>The deviance ( -2 * loglik ).</p></dd>

<dt>df.residual</dt>
<dd><p>Residual degrees of freedom (nobs - npar).</p></dd>

<dt>nobs</dt>
<dd><p>Number of observations used in the fit.</p></dd>

<dt>npar</dt>
<dd><p>Total number of estimated parameters (coefficients).</p></dd>

<dt>vcov</dt>
<dd><p>The variance-covariance matrix of the coefficients (if <code>hessian = TRUE</code>).</p></dd>

<dt>se</dt>
<dd><p>Standard errors of the coefficients (if <code>hessian = TRUE</code>).</p></dd>

<dt>convergence</dt>
<dd><p>Convergence code from the optimizer (0 typically indicates success).</p></dd>

<dt>message</dt>
<dd><p>Convergence message from the optimizer.</p></dd>

<dt>iterations</dt>
<dd><p>Number of iterations used by the optimizer.</p></dd>

<dt>rmse</dt>
<dd><p>Root Mean Squared Error of response residuals.</p></dd>

<dt>efron_r2</dt>
<dd><p>Efron's pseudo R-squared.</p></dd>

<dt>mean_absolute_error</dt>
<dd><p>Mean Absolute Error of response residuals.</p></dd>

<dt>x</dt>
<dd><p>List of model matrices (if <code>x = TRUE</code>).</p></dd>

<dt>y</dt>
<dd><p>The response vector (if <code>y = TRUE</code>).</p></dd>

<dt>model</dt>
<dd><p>The model frame (if <code>model = TRUE</code>).</p></dd>

<dt>tmb_object</dt>
<dd><p>The raw object returned by <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>gkwreg</code> function provides a regression framework for the Generalized
Kumaraswamy (GKw) family and its submodels, extending density estimation
to include covariates. The response variable must be strictly bounded in the
(0, 1) interval.</p>
<p><strong>Model Specification:</strong>
The extended <code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code> syntax is crucial for specifying
potentially different linear predictors for each relevant distribution parameter.
The parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) correspond sequentially
to the parts of the formula separated by <code>|</code>. For subfamilies where some
parameters are fixed by definition (see <code>family</code> argument), the corresponding
parts of the formula are automatically ignored. For example, in a <code>family = "kw"</code>
model, only the first two parts (for \(\alpha\) and \(\beta\)) are relevant.</p>
<p><strong>Parameter Constraints and Link Functions:</strong>
The parameters \(\alpha, \beta, \gamma, \lambda\) are constrained to be positive,
while \(\delta\) is constrained to the interval (0, 1). The default link functions
(<code>"log"</code> for positive parameters, <code>"logit"</code> for \(\delta\)) ensure these
constraints during estimation. Users can specify alternative link functions suitable
for the parameter's domain via the <code>link</code> argument.</p>
<p><strong>Link Scales:</strong>
The <code>link_scale</code> parameter allows users to control how aggressively the link
function transforms the linear predictor. For probability-type links (logit, probit,
cloglog, cauchy), smaller values (e.g., 1) produce more extreme transformations,
while larger values (e.g., 10) produce more gradual transformations. For continuous
parameters, scale values control the sensitivity of the transformation.</p>
<p><strong>Families and Parameters:</strong>
The function automatically handles parameter fixing based on the chosen <code>family</code>:</p><ul><li><p><strong>GKw</strong>: All 5 parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) modeled.</p></li>
<li><p><strong>BKw</strong>: Models \(\alpha, \beta, \gamma, \delta\); fixes \(\lambda = 1\).</p></li>
<li><p><strong>KKw</strong>: Models \(\alpha, \beta, \delta, \lambda\); fixes \(\gamma = 1\).</p></li>
<li><p><strong>EKw</strong>: Models \(\alpha, \beta, \lambda\); fixes \(\gamma = 1, \delta = 0\).</p></li>
<li><p><strong>Mc</strong> (McDonald): Models \(\gamma, \delta, \lambda\); fixes \(\alpha = 1, \beta = 1\).</p></li>
<li><p><strong>Kw</strong> (Kumaraswamy): Models \(\alpha, \beta\); fixes \(\gamma = 1, \delta = 0, \lambda = 1\).</p></li>
<li><p><strong>Beta</strong>: Models \(\gamma, \delta\); fixes \(\alpha = 1, \beta = 1, \lambda = 1\). This parameterization corresponds to the standard Beta distribution with shape1 = \(\gamma\) and shape2 = \(\delta\).</p></li>
</ul><p><strong>Estimation Engine:</strong>
Maximum Likelihood Estimation (MLE) is performed using C++ templates via the
<code>TMB</code> package, which provides automatic differentiation and efficient
optimization capabilities. The specific TMB template used depends on the chosen <code>family</code>.</p>
<p><strong>Optimizer Method (<code>method</code> argument):</strong></p><ul><li><p><code>"nlminb"</code>: Uses R's built-in <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a></code> optimizer. Good for problems with box constraints. Default option.</p></li>
<li><p><code>"Nelder-Mead"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with the Nelder-Mead simplex algorithm, which doesn't require derivatives.</p></li>
<li><p><code>"BFGS"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with the BFGS quasi-Newton method for unconstrained optimization.</p></li>
<li><p><code>"CG"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with conjugate gradients method for unconstrained optimization.</p></li>
<li><p><code>"SANN"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with simulated annealing, a global optimization method useful for problems with multiple local minima.</p></li>
<li><p><code>"L-BFGS-B"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with the limited-memory BFGS method with box constraints.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kumaraswamy, P. (1980). A generalized probability density function for double-bounded
random processes. <em>Journal of Hydrology</em>, <strong>46</strong>(1-2), 79-88.</p>
<p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of generalized distributions.
<em>Journal of Statistical Computation and Simulation</em>, <strong>81</strong>(7), 883-898.</p>
<p>Ferrari, S. L. P., &amp; Cribari-Neto, F. (2004). Beta regression for modelling rates and
proportions. <em>Journal of Applied Statistics</em>, <strong>31</strong>(7), 799-815.</p>
<p>Kristensen, K., Nielsen, A., Berg, C. W., Skaug, H., &amp; Bell, B. M. (2016). TMB:
Automatic Differentiation and Laplace Approximation. <em>Journal of Statistical
Software</em>, <strong>70</strong>(5), 1-21.
(Underlying TMB package)</p>
<p>Zeileis, A., Kleiber, C., Jackman, S. (2008). Regression Models for Count Data in R.
<em>Journal of Statistical Software</em>, <strong>27</strong>(8), 1-25.</p>
<p>Smithson, M., &amp; Verkuilen, J. (2006). A Better Lemon Squeezer? Maximum-Likelihood
Regression with Beta-Distributed Dependent Variables. <em>Psychological Methods</em>,
<strong>11</strong>(1), 54–71.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="summary.gkwreg.html">summary.gkwreg</a></code>, <code><a href="predict.gkwreg.html">predict.gkwreg</a></code>,
<code><a href="plot.gkwreg.html">plot.gkwreg</a></code>, <code><a href="coef.gkwreg.html">coef.gkwreg</a></code>, <code><a href="vcov.gkwreg.html">vcov.gkwreg</a></code>,
<code><a href="https://rdrr.io/r/stats/logLik.html" class="external-link">logLik</a></code>, <code><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></code>,
<code><a href="https://rdrr.io/pkg/Formula/man/Formula.html" class="external-link">Formula</a></code>, <code><a href="https://rdrr.io/pkg/TMB/man/MakeADFun.html" class="external-link">MakeADFun</a></code>,
<code><a href="https://rdrr.io/pkg/TMB/man/sdreport.html" class="external-link">sdreport</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lopes, J. E.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># \donttest{</span></span></span>
<span class="r-in"><span><span class="co">## -------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## 1. Real-world Case Studies</span></span></span>
<span class="r-in"><span><span class="co">## -------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 1: Food Expenditure Data</span></span></span>
<span class="r-in"><span><span class="co"># Load required package</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">require</a></span><span class="op">(</span><span class="va">gkwreg</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get FoodExpenditure data and create response variable 'y' as proportion of income spent on food</span></span></span>
<span class="r-in"><span><span class="va">food_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_bounded_datasets.html">get_bounded_datasets</a></span><span class="op">(</span><span class="st">"FoodExpenditure"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">food_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/with.html" class="external-link">within</a></span><span class="op">(</span><span class="va">food_data</span>, <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="va">food</span> <span class="op">/</span> <span class="va">income</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define formula: y depends on 'persons' with 'income' as predictor for second parameter</span></span></span>
<span class="r-in"><span><span class="va">formu_fe</span> <span class="op">&lt;-</span> <span class="va">y</span> <span class="op">~</span> <span class="va">persons</span> <span class="op">|</span> <span class="va">income</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Kumaraswamy model with log link for both parameters</span></span></span>
<span class="r-in"><span><span class="va">kw_model</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">formu_fe</span>, <span class="va">food_data</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="fl">2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"nlminb"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display model summary and diagnostics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">kw_model</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = formu_fe, data = food_data, family = "kw", link = rep("log", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     2), method = "nlminb")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.1668 -0.0417  0.0098 -0.0047  0.0396  0.1527 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  1.26876    0.14206   8.931  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:persons      0.07210    0.01895   3.805 0.000142 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   3.21312    0.63879   5.030  4.9e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:income        0.03623    0.00922   3.930  8.5e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                       3%    98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept) 0.9903 1.5472</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:persons     0.0350 0.1092</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  1.9611 4.4651</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:income       0.0182 0.0543</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 4.638</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 244.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 46.34 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -84.69 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -78.14 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.07442 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.4465 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.05784 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kw_model</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>, arrange_plots <span class="op">=</span> <span class="cn">TRUE</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2: Gasoline Yield Data</span></span></span>
<span class="r-in"><span><span class="co"># Load GasolineYield dataset</span></span></span>
<span class="r-in"><span><span class="va">gasoline_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_bounded_datasets.html">get_bounded_datasets</a></span><span class="op">(</span><span class="st">"GasolineYield"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Formula: yield depends on batch and temperature</span></span></span>
<span class="r-in"><span><span class="co"># First part (for alpha/gamma) includes batch and temp</span></span></span>
<span class="r-in"><span><span class="co"># Second part (for beta/delta/phi) includes only temp</span></span></span>
<span class="r-in"><span><span class="va">formu_gy</span> <span class="op">&lt;-</span> <span class="va">yield</span> <span class="op">~</span> <span class="va">batch</span> <span class="op">+</span> <span class="va">temp</span> <span class="op">|</span> <span class="va">temp</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Kumaraswamy model with log link and BFGS optimization</span></span></span>
<span class="r-in"><span><span class="va">kw_model_gas</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">formu_gy</span>, <span class="va">gasoline_data</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"log"</span>, <span class="fl">2</span><span class="op">)</span>, method <span class="op">=</span> <span class="st">"BFGS"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">kw_model_gas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = formu_gy, data = gasoline_data, family = "kw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     link = rep("log", 2), method = "BFGS")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.0309 -0.0102  0.0024 -0.0026  0.0074  0.0170 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.533007   0.034347  15.519  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.845384   0.035441  23.853  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.598695   0.037369  16.021  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.716293   0.034919  20.513  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.474241   0.032395  14.639  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.521558   0.033263  15.680  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.456962   0.033757  13.537  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.230536   0.031345   7.355 1.91e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.206234   0.033397   6.175 6.61e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.146342   0.037266   3.927 8.60e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp         0.005231        NaN     NaN      NaN    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  25.517159   1.558379  16.374  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:temp         -0.001718   0.003379  -0.508    0.611    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.4657  0.6003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch1       0.7759  0.9148</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch2       0.5255  0.6719</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch3       0.6479  0.7847</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch4       0.4107  0.5377</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch5       0.4564  0.5868</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch6       0.3908  0.5231</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch7       0.1691  0.2920</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch8       0.1408  0.2717</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:batch9       0.0733  0.2194</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:temp            NaN     NaN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)  22.4628 28.5715</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:temp         -0.0083  0.0049</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 15.91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 4.985e+10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 32 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 13 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 19 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 96.48 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -167 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -147.9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.01287 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.9851 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.01026 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 352 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">kw_model_gas</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>, arrange_plots <span class="op">=</span> <span class="cn">TRUE</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 3: SDAC Cancer Data</span></span></span>
<span class="r-in"><span><span class="co"># Load cancer survival dataset</span></span></span>
<span class="r-in"><span><span class="va">sdac_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_bounded_datasets.html">get_bounded_datasets</a></span><span class="op">(</span><span class="st">"sdac"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Formula: relative cumulative density ~ age adjustment + chemotherapy</span></span></span>
<span class="r-in"><span><span class="va">formu_sd</span> <span class="op">&lt;-</span> <span class="va">rcd</span> <span class="op">~</span> <span class="va">ageadj</span> <span class="op">+</span> <span class="va">chemo</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Extended Kumaraswamy model</span></span></span>
<span class="r-in"><span><span class="va">ekw_model_gas</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">formu_sd</span>, <span class="va">sdac_data</span>, family <span class="op">=</span> <span class="st">"ekw"</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ekw_model_gas</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: ekw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = formu_sd, data = sdac_data, family = "ekw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "BFGS")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.3833 -0.0574  0.0113  0.0038  0.0821  0.2187 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                     Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  -0.320689   1.300797  -0.247 0.805270    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:ageadj        0.015614   0.004675   3.340 0.000838 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:chemo         0.240301   0.091254   2.633 0.008456 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)    0.621233   0.123580   5.027 4.98e-07 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept)  2.642668   1.847364   1.431 0.152571    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         3%    98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  -2.8702 2.2288</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:ageadj        0.0065 0.0248</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:chemo         0.0614 0.4192</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)    0.3790 0.8634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -0.9781 6.2634</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 1.013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 1.861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 14.04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 239 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 5 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 234 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 199 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -388.1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -370.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.111 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.04902 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.08654 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 95 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ekw_model_gas</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>, arrange_plots <span class="op">=</span> <span class="cn">TRUE</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-3.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4: Retinal Data</span></span></span>
<span class="r-in"><span><span class="co"># Load retinal dataset</span></span></span>
<span class="r-in"><span><span class="va">retinal_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_bounded_datasets.html">get_bounded_datasets</a></span><span class="op">(</span><span class="st">"retinal"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Formula for three parameters with different predictors</span></span></span>
<span class="r-in"><span><span class="co"># alpha ~ LogT + LogT2 + Level</span></span></span>
<span class="r-in"><span><span class="co"># beta  ~ LogT + Level</span></span></span>
<span class="r-in"><span><span class="co"># gamma ~ Time</span></span></span>
<span class="r-in"><span><span class="va">formu_rt</span> <span class="op">&lt;-</span> <span class="va">Gas</span> <span class="op">~</span> <span class="va">LogT</span> <span class="op">+</span> <span class="va">LogT2</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span> <span class="va">LogT</span> <span class="op">+</span> <span class="va">Level</span> <span class="op">|</span> <span class="va">Time</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Extended Kumaraswamy model</span></span></span>
<span class="r-in"><span><span class="va">ekw_model_ret</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">formu_rt</span>, <span class="va">retinal_data</span>, family <span class="op">=</span> <span class="st">"ekw"</span>, method <span class="op">=</span> <span class="st">"nlminb"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">ekw_model_ret</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: ekw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = formu_rt, data = retinal_data, family = "ekw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     method = "nlminb")</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.4838 -0.0656  0.0539  0.0539  0.1555  0.5902 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)   2.75257    0.65067   4.230 2.33e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT         -0.16599    0.34148  -0.486  0.62689    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2        -0.35099    0.08206  -4.277 1.89e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level         0.65882    0.16406   4.016 5.93e-05 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   -1.82814    0.32344  -5.652 1.58e-08 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:LogT           0.69381    0.11084   6.260 3.86e-10 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level          0.17602    0.11970   1.471  0.14142    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -1.39856    0.45415  -3.080  0.00207 ** </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:Time         0.14089    0.05574   2.528  0.01148 *  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                         3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)   1.4773  4.0279</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT         -0.8353  0.5033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:LogT2        -0.5118 -0.1902</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:Level         0.3373  0.9804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   -2.4621 -1.1942</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:LogT           0.4766  0.9110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:Level         -0.0586  0.4106</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:(Intercept) -2.2887 -0.5085</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda:Time         0.0317  0.2501</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 6.183</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 1.033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 134.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 181 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 9 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 172 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 132.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -247.4 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -218.6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.2112 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.5363 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.1608 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 51 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">ekw_model_ret</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>, arrange_plots <span class="op">=</span> <span class="cn">TRUE</span>, sub.caption <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Simulating envelope ( 100 iterations): .......... Done!</span>
<span class="r-plt img"><img src="gkwreg-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 5: Weather Task Agreement Data</span></span></span>
<span class="r-in"><span><span class="co"># Load the WeatherTask dataset</span></span></span>
<span class="r-in"><span><span class="va">df_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_bounded_datasets.html">get_bounded_datasets</a></span><span class="op">(</span><span class="st">"WeatherTask"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit all seven distribution families to the 'agreement' variable</span></span></span>
<span class="r-in"><span><span class="va">fitall_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwfitall.html">gkwfitall</a></span><span class="op">(</span><span class="va">df_weather</span><span class="op">$</span><span class="va">agreement</span>, method <span class="op">=</span> <span class="st">"BFGS"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting gkw distribution... (1/7)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting bkw distribution... (2/7)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting kkw distribution... (3/7)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting ekw distribution... (4/7)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting mc distribution... (5/7)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting kw distribution... (6/7)</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>   Fitting beta distribution... (7/7)</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare model performance</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fitall_weather</span><span class="op">)</span> <span class="co"># Displays the comparison table</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Generalized Kumaraswamy Family Distributions Fit Comparison</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of families fitted: 7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Families: gkw, bkw, kkw, ekw, mc, kw, beta </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Comparison table (ordered by AIC):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Family Parameters   LogLik       AIC       BIC   KS_stat    KS_pvalue</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ekw     ekw          3 204.4522 -402.9044 -391.3737 0.1815844 2.631855e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bkw     bkw          4 203.8197 -399.6393 -384.2651 0.1825141 2.083676e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kkw     kkw          4 203.8037 -399.6074 -384.2332 0.1825884 2.045064e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkw     gkw          5 204.3537 -398.7073 -379.4896 0.1791614 4.810648e-10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mc       mc          3 195.9724 -385.9448 -374.4142 0.1943828 9.513841e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   beta          2 191.9791 -379.9581 -372.2710 0.2006893 1.705033e-12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kw       kw          2 187.0341 -370.0681 -362.3810 0.1935038 1.203712e-11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            RMSE</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ekw  0.04382810</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bkw  0.04388997</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kkw  0.04390826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkw  0.04371621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mc   0.04566130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta 0.04695914</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kw   0.04772193</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Best fitting model: ekw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model weights (based on AIC):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Family   AIC_weight</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ekw     ekw 6.619753e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> bkw     bkw 1.293726e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kkw     kkw 1.273252e-01</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkw     gkw 8.118256e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> mc       mc 1.374440e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta   beta 6.888501e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> kw       kw 4.903826e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of best fitting model:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwfit(data = data, family = fam, method = method, use_moments = use_moments, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     profile = profile, npoints = npoints, plot = FALSE, optimizer.control = optimizer.control, </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     silent = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: ekw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fixed Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gamma = 1, delta = 0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha   0.25906    0.01922   13.48   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta    3.07379    0.18154   16.93   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda 20.00000    0.84554   23.65   &lt;2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> --- Fit Statistics ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 204.4522  Parameters (est.): 3 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -402.9044   BIC: -391.3737   AICc: -402.8340 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 345 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fit Method: BFGS</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Optimizer Message: Successful convergence </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Identify the best family based on AIC</span></span></span>
<span class="r-in"><span><span class="va">best_family_code</span> <span class="op">&lt;-</span> <span class="va">fitall_weather</span><span class="op">$</span><span class="va">comparison</span><span class="op">$</span><span class="va">Family</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Refit the best model for detailed analysis</span></span></span>
<span class="r-in"><span><span class="va">fit_best_weather</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwfit.html">gkwfit</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">df_weather</span><span class="op">$</span><span class="va">agreement</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="va">best_family_code</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"BFGS"</span>, profile <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="cn">TRUE</span>, silent <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate Goodness-of-Fit report</span></span></span>
<span class="r-in"><span><span class="va">gof_report</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwgof.html">gkwgof</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">fit_best_weather</span>,</span></span>
<span class="r-in"><span>  theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  plot <span class="op">=</span> <span class="cn">TRUE</span>, print_summary <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwreg-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">gof_report</span><span class="op">)</span> <span class="co"># Display GoF statistics</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Summary of Goodness-of-Fit Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ----------------------------------</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distribution Family: EKW</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size: 345</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   alpha      =   0.259056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   beta       =   3.073787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lambda     =  20.000004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Key Goodness-of-Fit Statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Log-likelihood            = 204.452190</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AIC                       = -402.904381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BIC                       = -391.373747</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kolmogorov-Smirnov        =   0.180129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Anderson-Darling          =  11.188730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P-P Plot Correlation      =   0.965120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pseudo-R^2                =   0.694324</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract fit statistics for all families</span></span></span>
<span class="r-in"><span><span class="va">results_weathertask_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">fitall_weather</span><span class="op">$</span><span class="va">fits</span>, <span class="kw">function</span><span class="op">(</span><span class="va">f</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="extract_gof_stats.html">extract_gof_stats</a></span><span class="op">(</span><span class="fu"><a href="gkwgof.html">gkwgof</a></span><span class="op">(</span><span class="va">f</span>,</span></span>
<span class="r-in"><span>    plot <span class="op">=</span> <span class="cn">FALSE</span>,</span></span>
<span class="r-in"><span>    print_summary <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span></span></span>
<span class="r-in"><span>  <span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">results_weathertask_df</span> <span class="op">&lt;-</span> <span class="va">results_weathertask_df</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">results_weathertask_df</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/row.names.html" class="external-link">row.names</a></span><span class="op">(</span><span class="va">results_weathertask_df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate diagnostic plots for best model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="gkwgof.html">gkwgof</a></span><span class="op">(</span><span class="va">fit_best_weather</span>, theme <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, title <span class="op">=</span> <span class="st">""</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwreg-6.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================ </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Goodness-of-Fit Analysis for EKW Distribution </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -------------------------------------------------------------------------------- </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Sample Size: 345 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   alpha      =   0.259056</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   beta       =   3.073787</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   lambda     =  20.000004</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Distance-Based Tests:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kolmogorov-Smirnov   =   0.180129</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Cramer-von Mises     =   2.031174</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Anderson-Darling     =  11.188730</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Watson               =   1.986894</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Information Criteria:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AIC                  =  -402.9044</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   BIC                  =  -391.3737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   AICc                 =  -402.8340</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CAIC                 =  -388.3737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   HQIC                 =  -398.3124</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Likelihood Statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Log-likelihood       =   204.4522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Log-lik. per obs.    =     0.5926</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pseudo-R^2           =     0.6943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Moment Comparisons:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Moment     Theoretical     Sample Difference</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Mean         0.243550   0.243397   0.000153</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Variance     0.023786   0.026014   0.002228</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Skewness     1.049197   1.141336   0.092139</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Kurtosis     3.938186   3.768647   0.169539</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RMSE Moments         =   0.096486</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Probability Plot Metrics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P-P Correlation      =   0.965120</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   P-P Mean Deviation   =   0.062598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Q-Q Correlation      =   0.962315</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Q-Q Mean Abs. Error  =   0.033852</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Prediction Accuracy Metrics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   MAE                  =   0.062598</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   RMSE                 =   0.076725</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   CRPS                 =   0.005887</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ================================================================================ </span>
<span class="r-plt img"><img src="gkwreg-7.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display formatted comparison table</span></span></span>
<span class="r-in"><span><span class="va">results_weathertask_df</span><span class="op">[</span></span></span>
<span class="r-in"><span>  ,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="st">"family"</span>, <span class="st">"n_params"</span>, <span class="st">"logLik"</span>, <span class="st">"AIC"</span>, <span class="st">"BIC"</span>,</span></span>
<span class="r-in"><span>    <span class="st">"KS"</span>, <span class="st">"AD"</span>, <span class="st">"RMSE"</span>, <span class="st">"pseudo_R2"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   family n_params   logLik       AIC       BIC     KS      AD   RMSE pseudo_R2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1    ekw        3 204.4522 -402.9044 -391.3737 0.1801 11.1887 0.0767    0.6943</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2    bkw        4 203.8197 -399.6393 -384.2651 0.1811 11.3115 0.0772    0.6932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3    kkw        4 203.8037 -399.6074 -384.2332 0.1811 11.3229 0.0772    0.6932</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4    gkw        5 204.3537 -398.7073 -379.4896 0.1777 10.9551 0.0758    0.6941</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     mc        3 195.9724 -385.9448 -374.4142 0.1929 13.4351 0.0854    0.6789</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6   beta        2 191.9791 -379.9581 -372.2710 0.1992 14.4752 0.0893    0.6714</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7     kw        2 187.0341 -370.0681 -362.3810 0.1920 14.7087 0.0898    0.6618</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## -------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## 2. Simulation Studies</span></span></span>
<span class="r-in"><span><span class="co">## -------------------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 1: Simple Kumaraswamy Regression Model</span></span></span>
<span class="r-in"><span><span class="co"># Set seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define true regression coefficients</span></span></span>
<span class="r-in"><span><span class="va">alpha_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="fl">0.3</span>, <span class="op">-</span><span class="fl">0.2</span><span class="op">)</span> <span class="co"># Intercept, x1, x2</span></span></span>
<span class="r-in"><span><span class="va">beta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.2</span>, <span class="op">-</span><span class="fl">0.4</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Intercept, x1, x2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate linear predictors and transform using exponential link</span></span></span>
<span class="r-in"><span><span class="va">eta_alpha</span> <span class="op">&lt;-</span> <span class="va">alpha_coef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">alpha_coef</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">alpha_coef</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">eta_beta</span> <span class="op">&lt;-</span> <span class="va">beta_coef</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span> <span class="op">+</span> <span class="va">beta_coef</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">beta_coef</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span> <span class="op">*</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">alpha_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta_alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">eta_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate responses from Kumaraswamy distribution</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">alpha_true</span>, beta <span class="op">=</span> <span class="va">beta_true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Kumaraswamy regression model with formula notation</span></span></span>
<span class="r-in"><span><span class="co"># Model: alpha ~ x1 + x2 and beta ~ x1 + x2</span></span></span>
<span class="r-in"><span><span class="va">kw_reg</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df1</span>, family <span class="op">=</span> <span class="st">"kw"</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative model with custom link scales</span></span></span>
<span class="r-in"><span><span class="va">kw_reg2</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df1</span>, family <span class="op">=</span> <span class="st">"kw"</span>,</span></span>
<span class="r-in"><span>  link_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">5</span>, beta <span class="op">=</span> <span class="fl">8</span><span class="op">)</span>, silent <span class="op">=</span> <span class="cn">TRUE</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display model summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">kw_reg</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Generalized Kumaraswamy Regression Model Summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Family: kw </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Call:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gkwreg(formula = y ~ x1 + x2 | x1 + x2, data = df1, family = "kw", </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     silent = TRUE)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residuals:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Min  Q1.25%  Median    Mean  Q3.75%     Max </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> -0.5130 -0.1310 -0.0053  0.0004  0.1354  0.5221 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Coefficients:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   Estimate Std. Error z value Pr(&gt;|z|)    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.78127    0.03287  23.767  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x1           0.30782    0.02797  11.006  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x2          -0.23940    0.03242  -7.385 1.53e-13 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   1.15163    0.05283  21.800  &lt; 2e-16 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x1           -0.35232    0.04584  -7.686 1.52e-14 ***</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x2            0.03318    0.05152   0.644     0.52    </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ---</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Confidence intervals (95%):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                        3%     98%</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:(Intercept)  0.7168  0.8457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x1           0.2530  0.3626</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha:x2          -0.3029 -0.1759</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:(Intercept)   1.0481  1.2552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x1           -0.4422 -0.2625</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta:x2           -0.0678  0.1342</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Link functions:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: log</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Fitted parameter means:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> alpha: 2.38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> beta: 3.446</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> gamma: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> delta: 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> lambda: 1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Model fit statistics:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of observations: 1000 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of parameters: 6 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Residual degrees of freedom: 994 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Log-likelihood: 398.8 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> AIC: -785.7 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> BIC: -756.2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> RMSE: 0.1804 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Efron's R2: 0.5103 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Mean Absolute Error: 0.148 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Convergence status: Successful </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Iterations: 38 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 2: Generalized Kumaraswamy Regression</span></span></span>
<span class="r-in"><span><span class="co"># Set seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">456</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Binomial.html" class="external-link">rbinom</a></span><span class="op">(</span><span class="va">n</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span><span class="op">)</span> <span class="co"># Factor variable</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define true regression coefficients for all parameters</span></span></span>
<span class="r-in"><span><span class="va">alpha_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="co"># Intercept, x1</span></span></span>
<span class="r-in"><span><span class="va">beta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.8</span>, <span class="op">-</span><span class="fl">0.3</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Intercept, x1, x2</span></span></span>
<span class="r-in"><span><span class="va">gamma_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.6</span>, <span class="fl">0.4</span><span class="op">)</span> <span class="co"># Intercept, x3B</span></span></span>
<span class="r-in"><span><span class="va">delta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.0</span>, <span class="fl">0.2</span><span class="op">)</span> <span class="co"># Intercept, x3B (logit scale)</span></span></span>
<span class="r-in"><span><span class="va">lambda_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.2</span>, <span class="fl">0.1</span><span class="op">)</span> <span class="co"># Intercept, x2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create design matrices</span></span></span>
<span class="r-in"><span><span class="va">X_alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x1</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x3</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x3</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">X_lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x2</span>, data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate parameters through linear predictors and appropriate link functions</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_alpha</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">alpha_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_beta</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">beta_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_gamma</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gamma_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Logistic.html" class="external-link">plogis</a></span><span class="op">(</span><span class="va">X_delta</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">delta_coef</span><span class="op">)</span> <span class="co"># logit link for delta</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_lambda</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">lambda_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response from Generalized Kumaraswamy distribution</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">alpha</span>, beta <span class="op">=</span> <span class="va">beta</span>, gamma <span class="op">=</span> <span class="va">gamma</span>, delta <span class="op">=</span> <span class="va">delta</span>, lambda <span class="op">=</span> <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span>, x3 <span class="op">=</span> <span class="va">x3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit GKw regression with parameter-specific formulas</span></span></span>
<span class="r-in"><span><span class="va">gkw_reg</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x2</span>, data <span class="op">=</span> <span class="va">df2</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>NaNs produced</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternative model with custom link scales</span></span></span>
<span class="r-in"><span><span class="va">gkw_reg2</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x3</span> <span class="op">|</span> <span class="va">x2</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df2</span>, family <span class="op">=</span> <span class="st">"gkw"</span>,</span></span>
<span class="r-in"><span>  link_scale <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="fl">12</span>, beta <span class="op">=</span> <span class="fl">12</span>, gamma <span class="op">=</span> <span class="fl">12</span>,</span></span>
<span class="r-in"><span>    delta <span class="op">=</span> <span class="fl">0.8</span>, lambda <span class="op">=</span> <span class="fl">12</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare true vs. estimated coefficients</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"Estimated Coefficients (GKw):"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Estimated Coefficients (GKw):"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">gkw_reg</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  alpha:(Intercept)           alpha:x1   beta:(Intercept)            beta:x1 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        -3.85447349         0.04783796         0.07467660        -0.07578117 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            beta:x2  gamma:(Intercept)          gamma:x3B  delta:(Intercept) </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.08949315         3.38375925         0.41717019        -1.37810221 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          delta:x3B lambda:(Intercept)          lambda:x2 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         0.38804468         2.01657719         0.38718383 </span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"True Coefficients (approx):"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "True Coefficients (approx):"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">alpha_coef</span>, beta <span class="op">=</span> <span class="va">beta_coef</span>, gamma <span class="op">=</span> <span class="va">gamma_coef</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="va">delta_coef</span>, lambda <span class="op">=</span> <span class="va">lambda_coef</span></span></span>
<span class="r-in"><span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alpha</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $beta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  0.8 -0.3  0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $gamma</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6 0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $delta</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0 0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $lambda</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.2  0.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 3: Beta Regression for Comparison</span></span></span>
<span class="r-in"><span><span class="co"># Set seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">789</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># True coefficients for Beta parameters (gamma = shape1, delta = shape2)</span></span></span>
<span class="r-in"><span><span class="va">gamma_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.0</span>, <span class="fl">0.5</span><span class="op">)</span> <span class="co"># Intercept, x1 (log scale)</span></span></span>
<span class="r-in"><span><span class="va">delta_coef</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="op">-</span><span class="fl">0.7</span><span class="op">)</span> <span class="co"># Intercept, x1 (log scale)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate parameters through linear predictors and log link</span></span></span>
<span class="r-in"><span><span class="va">X_beta_eg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/model.matrix.html" class="external-link">model.matrix</a></span><span class="op">(</span><span class="op">~</span><span class="va">x1</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="va">x1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">gamma_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_beta_eg</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">gamma_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">delta_true</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">X_beta_eg</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="va">delta_coef</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response from Beta distribution</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rbeta_.html">rbeta_</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">gamma_true</span>, <span class="va">delta_true</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit Beta regression model using gkwreg</span></span></span>
<span class="r-in"><span><span class="va">beta_reg</span> <span class="op">&lt;-</span> <span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">df_beta</span>, family <span class="op">=</span> <span class="st">"beta"</span>,</span></span>
<span class="r-in"><span>  link <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>gamma <span class="op">=</span> <span class="st">"log"</span>, delta <span class="op">=</span> <span class="st">"log"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 4: Model Comparison using AIC/BIC</span></span></span>
<span class="r-in"><span><span class="co"># Fit an alternative model (Kumaraswamy) to the same beta-generated data</span></span></span>
<span class="r-in"><span><span class="va">kw_reg2</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu">gkwreg</span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x1</span>, data <span class="op">=</span> <span class="va">df_beta</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare models using information criteria</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"AIC Comparison (Beta vs Kw):"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AIC Comparison (Beta vs Kw):"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">beta_reg</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">AIC</a></span><span class="op">(</span><span class="va">kw_reg2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1172.606 -1167.961</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="st">"BIC Comparison (Beta vs Kw):"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "BIC Comparison (Beta vs Kw):"</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">beta_reg</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/stats/AIC.html" class="external-link">BIC</a></span><span class="op">(</span><span class="va">kw_reg2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -1152.975 -1148.330</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Example 5: Prediction with Fitted Models</span></span></span>
<span class="r-in"><span><span class="co"># Create new data for predictions</span></span></span>
<span class="r-in"><span><span class="va">newdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, length.out <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict expected response (mean of the Beta distribution)</span></span></span>
<span class="r-in"><span><span class="va">pred_response</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_reg</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type <span class="op">=</span> <span class="st">"response"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict parameters on the scale of the link function</span></span></span>
<span class="r-in"><span><span class="va">pred_link</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_reg</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type <span class="op">=</span> <span class="st">"link"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Predict parameters on the original scale</span></span></span>
<span class="r-in"><span><span class="va">pred_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html" class="external-link">predict</a></span><span class="op">(</span><span class="va">beta_reg</span>, newdata <span class="op">=</span> <span class="va">newdata</span>, type <span class="op">=</span> <span class="st">"parameter"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Visualize fitted model and data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">df_beta</span><span class="op">$</span><span class="va">x1</span>, <span class="va">df_beta</span><span class="op">$</span><span class="va">y</span>,</span></span>
<span class="r-in"><span>  pch <span class="op">=</span> <span class="fl">20</span>, col <span class="op">=</span> <span class="st">"grey"</span>, xlab <span class="op">=</span> <span class="st">"x1"</span>, ylab <span class="op">=</span> <span class="st">"y"</span>,</span></span>
<span class="r-in"><span>  main <span class="op">=</span> <span class="st">"Beta Regression Fit (using gkwreg)"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">newdata</span><span class="op">$</span><span class="va">x1</span>, <span class="va">pred_response</span>, col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"topright"</span>, legend <span class="op">=</span> <span class="st">"Predicted Mean"</span>, col <span class="op">=</span> <span class="st">"red"</span>, lty <span class="op">=</span> <span class="fl">1</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="gkwreg-8.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

