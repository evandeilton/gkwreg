<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Hessian Matrix of the Negative Log-Likelihood for the EKw Distribution — hsekw • gkwreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Hessian Matrix of the Negative Log-Likelihood for the EKw Distribution — hsekw"><meta property="og:description" content="Computes the analytic 3x3 Hessian matrix (matrix of second partial derivatives)
of the negative log-likelihood function for the Exponentiated Kumaraswamy (EKw)
distribution with parameters alpha (\(\alpha\)), beta
(\(\beta\)), and lambda (\(\lambda\)). This distribution is the
special case of the Generalized Kumaraswamy (GKw) distribution where
\(\gamma = 1\) and \(\delta = 0\). The Hessian is useful for estimating
standard errors and in optimization algorithms."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gkwreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.1.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Hessian Matrix of the Negative Log-Likelihood for the EKw Distribution</h1>

    <div class="hidden name"><code>hsekw.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the analytic 3x3 Hessian matrix (matrix of second partial derivatives)
of the negative log-likelihood function for the Exponentiated Kumaraswamy (EKw)
distribution with parameters <code>alpha</code> (\(\alpha\)), <code>beta</code>
(\(\beta\)), and <code>lambda</code> (\(\lambda\)). This distribution is the
special case of the Generalized Kumaraswamy (GKw) distribution where
\(\gamma = 1\) and \(\delta = 0\). The Hessian is useful for estimating
standard errors and in optimization algorithms.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">hsekw</span><span class="op">(</span><span class="va">par</span>, <span class="va">data</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-par">par<a class="anchor" aria-label="anchor" href="#arg-par"></a></dt>
<dd><p>A numeric vector of length 3 containing the distribution parameters
in the order: <code>alpha</code> (\(\alpha &gt; 0\)), <code>beta</code> (\(\beta &gt; 0\)),
<code>lambda</code> (\(\lambda &gt; 0\)).</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector of observations. All values must be strictly
between 0 and 1 (exclusive).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Returns a 3x3 numeric matrix representing the Hessian matrix of the
negative log-likelihood function, \(-\partial^2 \ell / (\partial \theta_i \partial \theta_j)\),
where \(\theta = (\alpha, \beta, \lambda)\).
Returns a 3x3 matrix populated with <code>NaN</code> if any parameter values are
invalid according to their constraints, or if any value in <code>data</code> is
not in the interval (0, 1).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function calculates the analytic second partial derivatives of the
negative log-likelihood function based on the EKw log-likelihood
(\(\gamma=1, \delta=0\) case of GKw, see <code><a href="llekw.html">llekw</a></code>):
$$
\ell(\theta | \mathbf{x}) = n[\ln(\lambda) + \ln(\alpha) + \ln(\beta)]
+ \sum_{i=1}^{n} [(\alpha-1)\ln(x_i) + (\beta-1)\ln(v_i) + (\lambda-1)\ln(w_i)]
$$
where \(\theta = (\alpha, \beta, \lambda)\) and intermediate terms are:</p><ul><li><p>\(v_i = 1 - x_i^{\alpha}\)</p></li>
<li><p>\(w_i = 1 - v_i^{\beta} = 1 - (1-x_i^{\alpha})^{\beta}\)</p></li>
</ul><p>The Hessian matrix returned contains the elements \(- \frac{\partial^2 \ell(\theta | \mathbf{x})}{\partial \theta_i \partial \theta_j}\)
for \(\theta_i, \theta_j \in \{\alpha, \beta, \lambda\}\).</p>
<p>Key properties of the returned matrix:</p><ul><li><p>Dimensions: 3x3.</p></li>
<li><p>Symmetry: The matrix is symmetric.</p></li>
<li><p>Ordering: Rows and columns correspond to the parameters in the order
\(\alpha, \beta, \lambda\).</p></li>
<li><p>Content: Analytic second derivatives of the <em>negative</em> log-likelihood.</p></li>
</ul><p>This corresponds to the relevant 3x3 submatrix of the 5x5 GKw Hessian (<code><a href="hsgkw.html">hsgkw</a></code>)
evaluated at \(\gamma=1, \delta=0\). The exact analytical formulas are implemented directly.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Nadarajah, S., Cordeiro, G. M., &amp; Ortega, E. M. (2012). The exponentiated
Kumaraswamy distribution. <em>Journal of the Franklin Institute</em>, <em>349</em>(3),
955-971. <a href="https://doi.org/10.1016/j.jfranklin.2011.12.016" class="external-link">doi:10.1016/j.jfranklin.2011.12.016</a></p>
<p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of generalized
distributions. <em>Journal of Statistical Computation and Simulation</em>,
<em>81</em>(7), 883-898. <a href="https://doi.org/10.1080/00949655.2010.483753" class="external-link">doi:10.1080/00949655.2010.483753</a>
 (Introduces GKw)</p>
<p>Kumaraswamy, P. (1980). A generalized probability density function for
double-bounded random processes. <em>Journal of Hydrology</em>, <em>46</em>(1-2), 79-88.
<a href="https://doi.org/10.1016/0022-1694%2880%2990036-0" class="external-link">doi:10.1016/0022-1694(80)90036-0</a>
 (Introduces Kw)
(Note: Specific Hessian formulas might be derived or sourced from additional references).</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="hsgkw.html">hsgkw</a></code> (parent distribution Hessian),
<code><a href="llekw.html">llekw</a></code> (negative log-likelihood for EKw),
<code>grekw</code> (gradient for EKw, if available),
<code><a href="dekw.html">dekw</a></code> (density for EKw),
<code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code>,
<code><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html" class="external-link">hessian</a></code> (for numerical Hessian comparison).</p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Lopes, J. E.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Assuming existence of rekw, llekw, grekw, hsekw functions for EKw</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate sample data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">true_par_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, lambda <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"rekw"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sample_data_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="rekw.html">rekw</a></span><span class="op">(</span><span class="fl">100</span>, alpha <span class="op">=</span> <span class="va">true_par_ekw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">true_par_ekw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                          lambda <span class="op">=</span> <span class="va">true_par_ekw</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">sample_data_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="fl">100</span>, alpha <span class="op">=</span> <span class="va">true_par_ekw</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">true_par_ekw</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>                         gamma <span class="op">=</span> <span class="fl">1</span>, delta <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="va">true_par_ekw</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/hist.html" class="external-link">hist</a></span><span class="op">(</span><span class="va">sample_data_ekw</span>, breaks <span class="op">=</span> <span class="fl">20</span>, main <span class="op">=</span> <span class="st">"EKw(2, 3, 0.5) Sample"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Find MLE estimates ---</span></span></span>
<span class="r-in"><span><span class="va">start_par_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="fl">0.8</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mle_result_ekw</span> <span class="op">&lt;-</span> <span class="fu">stats</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span>par <span class="op">=</span> <span class="va">start_par_ekw</span>,</span></span>
<span class="r-in"><span>                               fn <span class="op">=</span> <span class="va">llekw</span>,</span></span>
<span class="r-in"><span>                               gr <span class="op">=</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"grekw"</span><span class="op">)</span><span class="op">)</span> <span class="va">grekw</span> <span class="kw">else</span> <span class="cn">NULL</span>,</span></span>
<span class="r-in"><span>                               method <span class="op">=</span> <span class="st">"BFGS"</span>,</span></span>
<span class="r-in"><span>                               hessian <span class="op">=</span> <span class="cn">TRUE</span>, <span class="co"># Ask optim for numerical Hessian</span></span></span>
<span class="r-in"><span>                               data <span class="op">=</span> <span class="va">sample_data_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Compare analytical Hessian to numerical Hessian ---</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">mle_result_ekw</span><span class="op">$</span><span class="va">convergence</span> <span class="op">==</span> <span class="fl">0</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"numDeriv"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">&amp;&amp;</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/exists.html" class="external-link">exists</a></span><span class="op">(</span><span class="st">"hsekw"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">mle_par_ekw</span> <span class="op">&lt;-</span> <span class="va">mle_result_ekw</span><span class="op">$</span><span class="va">par</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nComparing Hessians for EKw at MLE estimates:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Numerical Hessian of llekw</span></span></span>
<span class="r-in"><span>  <span class="va">num_hess_ekw</span> <span class="op">&lt;-</span> <span class="fu">numDeriv</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/numDeriv/man/hessian.html" class="external-link">hessian</a></span><span class="op">(</span>func <span class="op">=</span> <span class="va">llekw</span>, x <span class="op">=</span> <span class="va">mle_par_ekw</span>, data <span class="op">=</span> <span class="va">sample_data_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Analytical Hessian from hsekw</span></span></span>
<span class="r-in"><span>  <span class="va">ana_hess_ekw</span> <span class="op">&lt;-</span> <span class="fu">hsekw</span><span class="op">(</span>par <span class="op">=</span> <span class="va">mle_par_ekw</span>, data <span class="op">=</span> <span class="va">sample_data_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Numerical Hessian (EKw):\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">num_hess_ekw</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Analytical Hessian (EKw):\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="va">ana_hess_ekw</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Check differences</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Max absolute difference between EKw Hessians:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">num_hess_ekw</span> <span class="op">-</span> <span class="va">ana_hess_ekw</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Optional: Use analytical Hessian for Standard Errors</span></span></span>
<span class="r-in"><span>  <span class="co"># tryCatch({</span></span></span>
<span class="r-in"><span>  <span class="co">#   cov_matrix_ekw &lt;- solve(ana_hess_ekw)</span></span></span>
<span class="r-in"><span>  <span class="co">#   std_errors_ekw &lt;- sqrt(diag(cov_matrix_ekw))</span></span></span>
<span class="r-in"><span>  <span class="co">#   cat("Std. Errors from Analytical EKw Hessian:\n")</span></span></span>
<span class="r-in"><span>  <span class="co">#   print(std_errors_ekw)</span></span></span>
<span class="r-in"><span>  <span class="co"># }, error = function(e) {</span></span></span>
<span class="r-in"><span>  <span class="co">#   warning("Could not invert analytical EKw Hessian: ", e$message)</span></span></span>
<span class="r-in"><span>  <span class="co"># })</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\nSkipping EKw Hessian comparison.\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Requires convergence, 'numDeriv' package, and function 'hsekw'.\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># } # End of \dontrun block</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lopes J. L..</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

