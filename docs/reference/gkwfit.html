<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Fit Generalized Kumaraswamy Distribution via Maximum Likelihood Estimation using TMB — gkwfit • gkwreg</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fit Generalized Kumaraswamy Distribution via Maximum Likelihood Estimation using TMB — gkwfit"><meta name="description" content="Fits any distribution from the Generalized Kumaraswamy (GKw) family to data using maximum
likelihood estimation through Template Model Builder (TMB). The function supports several
optimization methods including R's nlminb and various optim algorithms."><meta property="og:description" content="Fits any distribution from the Generalized Kumaraswamy (GKw) family to data using maximum
likelihood estimation through Template Model Builder (TMB). The function supports several
optimization methods including R's nlminb and various optim algorithms."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gkwreg</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Fit Generalized Kumaraswamy Distribution via Maximum Likelihood Estimation using TMB</h1>

      <div class="d-none name"><code>gkwfit.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits any distribution from the Generalized Kumaraswamy (GKw) family to data using maximum
likelihood estimation through Template Model Builder (TMB). The function supports several
optimization methods including R's nlminb and various optim algorithms.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gkwfit</span><span class="op">(</span></span>
<span>  <span class="va">data</span>,</span>
<span>  family <span class="op">=</span> <span class="st">"gkw"</span>,</span>
<span>  start <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  fixed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"nlminb"</span>,</span>
<span>  use_moments <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  hessian <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  profile <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  npoints <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  conf.level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  optimizer.control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  submodels <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  silent <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A numeric vector with values strictly between 0 and 1. Values at the boundaries
(0 or 1) may cause issues; consider slight adjustments if necessary (see Details).</p></dd>


<dt id="arg-family">family<a class="anchor" aria-label="anchor" href="#arg-family"></a></dt>
<dd><p>A character string specifying the distribution family. One of: <code>"gkw"</code> (default),
<code>"bkw"</code>, <code>"kkw"</code>, <code>"ekw"</code>, <code>"mc"</code>, <code>"kw"</code>, or <code>"beta"</code>. See Details for parameter specifications.</p></dd>


<dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>Optional list with initial parameter values (using natural parameter names like <code>alpha</code>, <code>beta</code>, etc.).
If <code>NULL</code>, reasonable starting values will be determined, potentially using the method of moments if <code>use_moments = TRUE</code>.</p></dd>


<dt id="arg-fixed">fixed<a class="anchor" aria-label="anchor" href="#arg-fixed"></a></dt>
<dd><p>Optional list of parameters to be held fixed at specific values during estimation (e.g., <code>list(lambda = 1)</code>).</p></dd>


<dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p>Optimization method to use. One of: <code>"nlminb"</code> (default), <code>"Nelder-Mead"</code>, <code>"BFGS"</code>,
<code>"CG"</code>, <code>"L-BFGS-B"</code> or <code>"SANN"</code>. If <code>"nlminb"</code> is selected, R's <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">nlminb</a></code> function is used;
otherwise, R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></code> function is used with the specified method.</p></dd>


<dt id="arg-use-moments">use_moments<a class="anchor" aria-label="anchor" href="#arg-use-moments"></a></dt>
<dd><p>Logical; if <code>TRUE</code> and <code>start = NULL</code>, attempts to use method of moments estimates
(via <code>gkwgetstartvalues</code>) as initial values. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-hessian">hessian<a class="anchor" aria-label="anchor" href="#arg-hessian"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, attempts to compute the Hessian matrix at the MLE to estimate
standard errors and the variance-covariance matrix using TMB's <code>sdreport</code>. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-profile">profile<a class="anchor" aria-label="anchor" href="#arg-profile"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, computes likelihood profiles for parameters using TMB's profiling capabilities. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-npoints">npoints<a class="anchor" aria-label="anchor" href="#arg-npoints"></a></dt>
<dd><p>Integer; number of points to use in profile likelihood calculations (minimum 5). Only relevant if <code>profile = TRUE</code>. Default: 20.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, generates diagnostic plots (histogram with fitted density, QQ-plot) using <code>ggplot2</code> and <code>patchwork</code>. Default: <code>TRUE</code>.</p></dd>


<dt id="arg-conf-level">conf.level<a class="anchor" aria-label="anchor" href="#arg-conf-level"></a></dt>
<dd><p>Numeric, the confidence level for confidence intervals calculated from standard errors (requires <code>hessian = TRUE</code>). Default: 0.95.</p></dd>


<dt id="arg-optimizer-control">optimizer.control<a class="anchor" aria-label="anchor" href="#arg-optimizer-control"></a></dt>
<dd><p>List of control parameters passed to the chosen optimizer.
The valid parameters depend on the <code>method</code> chosen. See Details.</p></dd>


<dt id="arg-submodels">submodels<a class="anchor" aria-label="anchor" href="#arg-submodels"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, fits relevant nested submodels for comparison via likelihood ratio tests. Default: <code>FALSE</code>.</p></dd>


<dt id="arg-silent">silent<a class="anchor" aria-label="anchor" href="#arg-silent"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, suppresses messages during fitting. Default: <code>FALSE</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments (currently unused).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"gkwfit"</code> (inheriting from <code>"list"</code>) containing the fitted model results. Key components include:</p>
<dl><dt>coefficients</dt>
<dd><p>Named vector of estimated parameters (on their natural scale).</p></dd>

<dt>std.errors</dt>
<dd><p>Named vector of estimated standard errors (if <code>hessian = TRUE</code>).</p></dd>

<dt>coef_summary</dt>
<dd><p>Data frame summarizing estimates, SEs, z-values, and p-values.</p></dd>

<dt>vcov</dt>
<dd><p>Variance-covariance matrix of the estimates (if <code>hessian = TRUE</code>).</p></dd>

<dt>loglik</dt>
<dd><p>Log-likelihood value at the maximum.</p></dd>

<dt>AIC</dt>
<dd><p>Akaike Information Criterion.</p></dd>

<dt>BIC</dt>
<dd><p>Bayesian Information Criterion.</p></dd>

<dt>AICc</dt>
<dd><p>Corrected Akaike Information Criterion.</p></dd>

<dt>data</dt>
<dd><p>The input data vector used for fitting.</p></dd>

<dt>nobs</dt>
<dd><p>Number of observations used.</p></dd>

<dt>df</dt>
<dd><p>Number of estimated parameters.</p></dd>

<dt>convergence</dt>
<dd><p>Logical indicating successful convergence.</p></dd>

<dt>message</dt>
<dd><p>Convergence message from the optimizer.</p></dd>

<dt>family</dt>
<dd><p>The specified distribution family.</p></dd>

<dt>method</dt>
<dd><p>The specific optimization method used.</p></dd>

<dt>conf.int</dt>
<dd><p>Data frame with confidence intervals (if <code>hessian = TRUE</code>).</p></dd>

<dt>conf.level</dt>
<dd><p>The confidence level used.</p></dd>

<dt>optimizer</dt>
<dd><p>The raw output object from the optimizer function.</p></dd>

<dt>obj</dt>
<dd><p>The TMB object used for fitting (if available).</p></dd>

<dt>fixed</dt>
<dd><p>The list of fixed parameters used.</p></dd>

<dt>profile</dt>
<dd><p>A list containing likelihood profile results (if <code>profile = TRUE</code>).</p></dd>

<dt>submodels</dt>
<dd><p>A list of fitted submodels (if <code>submodels = TRUE</code>).</p></dd>

<dt>lrt</dt>
<dd><p>A list of likelihood ratio test results comparing nested models (if <code>submodels = TRUE</code>).</p></dd>

<dt>gof</dt>
<dd><p>Goodness-of-fit statistics (e.g., AD, CvM, KS).</p></dd>

<dt>diagnostics</dt>
<dd><p>Diagnostic information related to GOF tests.</p></dd>

<dt>plots</dt>
<dd><p>A list or <code>patchwork</code> object containing ggplot objects for diagnostics (if <code>plot = TRUE</code>).</p></dd>

<dt>call</dt>
<dd><p>The matched function call.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The <code>gkwfit</code> function provides a unified interface for fitting the seven distributions in the Generalized Kumaraswamy family:</p><ul><li><p><strong>GKw</strong>: 5 parameters (\(\alpha, \beta, \gamma, \delta, \lambda\)) - All positive.</p></li>
<li><p><strong>BKw</strong>: 4 parameters (\(\alpha, \beta, \gamma, \delta\)), \(\lambda = 1\) fixed - All positive.</p></li>
<li><p><strong>KKw</strong>: 4 parameters (\(\alpha, \beta, \delta, \lambda\)), \(\gamma = 1\) fixed - All positive.</p></li>
<li><p><strong>EKw</strong>: 3 parameters (\(\alpha, \beta, \lambda\)), \(\gamma = 1, \delta = 0\) fixed - All positive.</p></li>
<li><p><strong>Mc</strong> (McDonald / Beta Power): 3 parameters (\(\gamma, \delta, \lambda\)), \(\alpha = 1, \beta = 1\) fixed - All positive.</p></li>
<li><p><strong>Kw</strong> (Kumaraswamy): 2 parameters (\(\alpha, \beta\)), \(\gamma = 1, \delta = 0, \lambda = 1\) fixed - All positive.</p></li>
<li><p><strong>Beta</strong>: 2 parameters (\(\gamma, \delta\)), \(\alpha = 1, \beta = 1, \lambda = 1\) fixed - All positive. (\(\gamma, \delta\) correspond to standard Beta shape1, shape2).</p></li>
</ul><p>This function uses Template Model Builder (TMB) for parameter estimation, which provides accurate and efficient automatic differentiation.</p>
<p><strong>Optimizer Method (<code>method</code> argument):</strong></p><ul><li><p><code>"nlminb"</code>: Uses R's built-in <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a></code> optimizer. Good for problems with box constraints. Default option.</p></li>
<li><p><code>"Nelder-Mead"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with the Nelder-Mead simplex algorithm, which doesn't require derivatives.</p></li>
<li><p><code>"BFGS"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with the BFGS quasi-Newton method for unconstrained optimization.</p></li>
<li><p><code>"CG"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with conjugate gradients method for unconstrained optimization.</p></li>
<li><p><code>"L-BFGS-B"</code>: Uses R's <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code> with the limited-memory BFGS method with box constraints.</p></li>
<li><p><code>"SANN"</code>: Uses R's stats::optim with simulated annealing, a global optimization method useful for problems with multiple local minima.</p></li>
</ul><p><strong>Optimizer Control (<code>optimizer.control</code>):</strong>
Pass a list with parameters specific to the chosen optimizer:</p><ul><li><p>For <code>method = "nlminb"</code>: Controls are passed to <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">stats::nlminb</a></code>. See <code><a href="https://rdrr.io/r/stats/nlminb.html" class="external-link">?nlminb</a></code> for options like <code>eval.max</code>, <code>iter.max</code>, <code>trace</code>, <code>rel.tol</code>, etc.</p></li>
<li><p>For other methods: Controls are passed to <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">stats::optim</a></code>. See <code><a href="https://rdrr.io/r/stats/optim.html" class="external-link">?optim</a></code> for options like <code>maxit</code>, <code>trace</code>, <code>factr</code>, <code>pgtol</code>, etc.</p></li>
</ul><p>If <code>optimizer.control</code> is empty, reasonable defaults are used for each method.</p>
<p><strong>Data Preprocessing:</strong> The function includes basic validation to ensure data is numeric and within (0, 1). It attempts to adjust values exactly at 0 or 1 by a small epsilon (<code>.Machine$double.eps^0.5</code>) with a warning, but stops if more than 10% of data needs adjustment. It's generally recommended to handle boundary data appropriately <em>before</em> calling <code>gkwfit</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kumaraswamy, P. (1980). A generalized probability density function for double-bounded
random processes. <em>Journal of Hydrology</em>, 46(1-2), 79-88. <a href="https://doi.org/10.1016/0022-1694%2880%2990036-0" class="external-link">doi:10.1016/0022-1694(80)90036-0</a></p>
<p>Cordeiro, G. M., &amp; de Castro, M. (2011). A new family of generalized distributions.
<em>Journal of Statistical Computation and Simulation</em>, 81(7), 883-898. <a href="https://doi.org/10.1080/00949650903530745" class="external-link">doi:10.1080/00949650903530745</a></p>
<p>Kristensen, K., Nielsen, A., Berg, C. W., Skaug, H., &amp; Bell, B. M. (2016). TMB: Automatic Differentiation and Laplace Approximation. <em>Journal of Statistical Software</em>, 70(5), 1–21. <a href="https://doi.org/10.18637/jss.v070.i05" class="external-link">doi:10.18637/jss.v070.i05</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>User-facing S3 methods: <code><a href="summary.gkwfit.html">summary.gkwfit</a></code>, <code><a href="print.gkwfit.html">print.gkwfit</a></code>, <code><a href="plot.gkwfit.html">plot.gkwfit</a></code>, <code><a href="coef.gkwfit.html">coef.gkwfit</a></code>, <code><a href="vcov.gkwfit.html">vcov.gkwfit</a></code>, <code><a href="logLik.gkwfit.html">logLik.gkwfit</a></code>, <code><a href="confint.gkwfit.html">confint.gkwfit</a></code>. Density/distribution functions: <code><a href="dgkw.html">dgkw</a></code>, <code><a href="pgkw.html">pgkw</a></code>, <code><a href="qgkw.html">qgkw</a></code>, <code><a href="rgkw.html">rgkw</a></code>.</p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Lopes, J. E.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Load required packages</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://patchwork.data-imaginist.com" class="external-link">patchwork</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://topmodels.R-Forge.R-project.org/betareg/" class="external-link">betareg</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 1: Basic Usage with Simulated Data for Different Distributions</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Set seed for reproducibility</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">1000</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random samples from various distributions in the GKw family</span></span></span>
<span class="r-in"><span><span class="va">y_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_bkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="rbkw.html">rbkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span> <span class="co"># BKw has lambda fixed at 1</span></span></span>
<span class="r-in"><span><span class="va">y_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># Standard Kumaraswamy (gamma=1, delta=0, lambda=1)</span></span></span>
<span class="r-in"><span><span class="va">y_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="rbeta_.html">rbeta_</a></span><span class="op">(</span><span class="va">n</span>, gamma <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="co"># Beta with shape1=2, shape2=3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate densities for the first 5 observations</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="dgkw.html">dgkw</a></span><span class="op">(</span><span class="va">y_gkw</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with beta density (note different parameterization)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="fu"><a href="dbeta_.html">dbeta_</a></span><span class="op">(</span><span class="va">y_beta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, gamma <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compute log-likelihood using parameter vector format</span></span></span>
<span class="r-in"><span><span class="co"># Parameter order: alpha, beta, gamma, delta, lambda</span></span></span>
<span class="r-in"><span><span class="va">par_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ll_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="llgkw.html">llgkw</a></span><span class="op">(</span><span class="va">par_gkw</span>, <span class="va">y_gkw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">par_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="co"># Kumaraswamy parameters</span></span></span>
<span class="r-in"><span><span class="va">ll_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="llkw.html">llkw</a></span><span class="op">(</span><span class="va">par_kw</span>, <span class="va">y_kw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Log-likelihood GKw:"</span>, <span class="va">ll_gkw</span>, <span class="st">"\nLog-likelihood Kw:"</span>, <span class="va">ll_kw</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 2: Visualization and Distribution Comparisons</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Generate data for plotting</span></span></span>
<span class="r-in"><span><span class="va">x_vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0.001</span>, <span class="fl">0.999</span>, length.out <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate densities for different distributions</span></span></span>
<span class="r-in"><span><span class="va">dens_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="dgkw.html">dgkw</a></span><span class="op">(</span><span class="va">x_vals</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dens_bkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="dbkw.html">dbkw</a></span><span class="op">(</span><span class="va">x_vals</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dens_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="dkw.html">dkw</a></span><span class="op">(</span><span class="va">x_vals</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dens_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="dbeta_.html">dbeta_</a></span><span class="op">(</span><span class="va">x_vals</span>, gamma <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create and display plot</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">x_vals</span>, <span class="fl">4</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  density <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">dens_gkw</span>, <span class="va">dens_bkw</span>, <span class="va">dens_kw</span>, <span class="va">dens_beta</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Distribution <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GKw"</span>, <span class="st">"BKw"</span>, <span class="st">"Kw"</span>, <span class="st">"Beta"</span><span class="op">)</span>, each <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x_vals</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span>, color <span class="op">=</span> <span class="va">Distribution</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>linewidth <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="st">"Density Comparison of GKw Distribution Family"</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"x"</span>, y <span class="op">=</span> <span class="st">"Density"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine quantile functions</span></span></span>
<span class="r-in"><span><span class="co"># Calculate 0.25, 0.5, and 0.75 quantiles for each distribution</span></span></span>
<span class="r-in"><span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.25</span>, <span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qgkw_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="qgkw.html">qgkw</a></span><span class="op">(</span><span class="va">probs</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qkw_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="qkw.html">qkw</a></span><span class="op">(</span><span class="va">probs</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">qbeta_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="qbeta_.html">qbeta_</a></span><span class="op">(</span><span class="va">probs</span>, gamma <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Display the quantiles</span></span></span>
<span class="r-in"><span><span class="va">quantile_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Probability <span class="op">=</span> <span class="va">probs</span>,</span></span>
<span class="r-in"><span>  GKw <span class="op">=</span> <span class="va">qgkw_values</span>,</span></span>
<span class="r-in"><span>  Kw <span class="op">=</span> <span class="va">qkw_values</span>,</span></span>
<span class="r-in"><span>  Beta <span class="op">=</span> <span class="va">qbeta_values</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">quantile_df</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 3: Model Fitting with Simulated Data</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Simulate data from GKw</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">true_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2.5</span>, beta <span class="op">=</span> <span class="fl">1.8</span>, gamma <span class="op">=</span> <span class="fl">1.3</span>, delta <span class="op">=</span> <span class="fl">0.4</span>, lambda <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">beta</span>,</span></span>
<span class="r-in"><span>  gamma <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">gamma</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">delta</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">lambda</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit full GKw model</span></span></span>
<span class="r-in"><span><span class="va">fit_gkw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_gkw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit restricted models for comparison</span></span></span>
<span class="r-in"><span><span class="va">fit_bkw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"bkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_kkw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"kkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare models using AIC</span></span></span>
<span class="r-in"><span><span class="va">models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GKw"</span>, <span class="st">"BKw"</span>, <span class="st">"KKw"</span>, <span class="st">"Kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">AIC_values</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_gkw</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_bkw</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_kkw</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_kw</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Model <span class="op">=</span> <span class="va">models</span>, AIC <span class="op">=</span> <span class="va">AIC_values</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model_comparison</span> <span class="op">&lt;-</span> <span class="va">model_comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model_comparison</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 4: Fixed Parameter Estimation and Likelihood Ratio Tests</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Simulate data where delta = 0</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">true_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1.8</span>, beta <span class="op">=</span> <span class="fl">2.2</span>, gamma <span class="op">=</span> <span class="fl">0.9</span>, delta <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">alpha</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">beta</span>,</span></span>
<span class="r-in"><span>  gamma <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">gamma</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">delta</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="va">true_params</span><span class="op">$</span><span class="va">lambda</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model with delta fixed at 0</span></span></span>
<span class="r-in"><span><span class="va">fit_fixed</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gkw"</span>, method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>, fixed <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>delta <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_fixed</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit model without fixing delta (should estimate close to 0)</span></span></span>
<span class="r-in"><span><span class="va">fit_free</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_free</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare models via likelihood ratio test</span></span></span>
<span class="r-in"><span><span class="co"># H0: delta = 0 vs H1: delta != 0</span></span></span>
<span class="r-in"><span><span class="va">LR_stat</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span> <span class="op">*</span> <span class="op">(</span><span class="va">fit_fixed</span><span class="op">$</span><span class="va">loglik</span> <span class="op">-</span> <span class="va">fit_free</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">p_value</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Chisquare.html" class="external-link">pchisq</a></span><span class="op">(</span><span class="va">LR_stat</span>, df <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"LR test statistic:"</span>, <span class="va">LR_stat</span>, <span class="st">"\np-value:"</span>, <span class="va">p_value</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 5: Profile Likelihood Analysis</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="fl">2</span>, beta <span class="op">=</span> <span class="fl">3</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit with profile likelihood</span></span></span>
<span class="r-in"><span><span class="va">fit_profile</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span></span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">y</span>,</span></span>
<span class="r-in"><span>  family <span class="op">=</span> <span class="st">"gkw"</span>,</span></span>
<span class="r-in"><span>  profile <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  npoints <span class="op">=</span> <span class="fl">15</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Examine profile objects</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">fit_profile</span><span class="op">$</span><span class="va">profile</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_profile</span><span class="op">$</span><span class="va">plots</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 6: Real Data Application with Beta Regression Datasets</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Example 1: Reading Skills data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ReadingSkills"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">ReadingSkills</span><span class="op">$</span><span class="va">accuracy</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Summary statistics of the response variable</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit different distributions to this data</span></span></span>
<span class="r-in"><span><span class="va">fit_rs_beta</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_rs_kw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_rs_gkw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"gkw"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Model comparison</span></span></span>
<span class="r-in"><span><span class="va">rs_models</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Beta"</span>, <span class="st">"Kumaraswamy"</span>, <span class="st">"GKw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs_AICs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_rs_beta</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_rs_kw</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_rs_gkw</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs_BICs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_rs_beta</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_rs_kw</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_rs_gkw</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">rs_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Model <span class="op">=</span> <span class="va">rs_models</span>,</span></span>
<span class="r-in"><span>  AIC <span class="op">=</span> <span class="va">rs_AICs</span>,</span></span>
<span class="r-in"><span>  BIC <span class="op">=</span> <span class="va">rs_BICs</span>,</span></span>
<span class="r-in"><span>  Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_rs_beta</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_rs_kw</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_rs_gkw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">rs_comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">rs_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Gasoline Yield data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"GasolineYield"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">GasolineYield</span><span class="op">$</span><span class="va">yield</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Check range and make adjustments if needed (data must be in (0,1))</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Apply common transformation for proportions that include 0 or 1</span></span></span>
<span class="r-in"><span>  <span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="va">n_obs</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_obs</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit best model based on previous comparison</span></span></span>
<span class="r-in"><span><span class="va">best_family</span> <span class="op">&lt;-</span> <span class="va">rs_comparison</span><span class="op">$</span><span class="va">Model</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">fit_gas</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">best_family</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_gas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot fitted density over histogram of data</span></span></span>
<span class="r-in"><span><span class="co"># Get parameters from fitted model</span></span></span>
<span class="r-in"><span><span class="va">params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_gas</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate x values and calculate density</span></span></span>
<span class="r-in"><span><span class="va">x_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span>, length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fitted_density</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">best_family</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"beta"</span> <span class="op">=</span> <span class="fu"><a href="dbeta_.html">dbeta_</a></span><span class="op">(</span><span class="va">x_seq</span>, gamma <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"gamma"</span><span class="op">]</span>, delta <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"delta"</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"kumaraswamy"</span> <span class="op">=</span> <span class="fu"><a href="dkw.html">dkw</a></span><span class="op">(</span><span class="va">x_seq</span>, alpha <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"alpha"</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"beta"</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"gkw"</span> <span class="op">=</span> <span class="fu"><a href="dgkw.html">dgkw</a></span><span class="op">(</span><span class="va">x_seq</span>,</span></span>
<span class="r-in"><span>    alpha <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"alpha"</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"beta"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    gamma <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"gamma"</span><span class="op">]</span>, delta <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"delta"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    lambda <span class="op">=</span> <span class="va">params</span><span class="op">[</span><span class="st">"lambda"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame for plotting</span></span></span>
<span class="r-in"><span><span class="va">df_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x_seq</span>, density <span class="op">=</span> <span class="va">fitted_density</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create plot</span></span></span>
<span class="r-in"><span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span>, y <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes_eval.html" class="external-link">after_stat</a></span><span class="op">(</span><span class="va">density</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    bins <span class="op">=</span> <span class="fl">30</span>, fill <span class="op">=</span> <span class="st">"lightblue"</span>, color <span class="op">=</span> <span class="st">"black"</span>, alpha <span class="op">=</span> <span class="fl">0.7</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">df_plot</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, y <span class="op">=</span> <span class="va">density</span><span class="op">)</span>, color <span class="op">=</span> <span class="st">"red"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Fitted"</span>, <span class="va">best_family</span>, <span class="st">"Distribution to Gasoline Yield Data"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    x <span class="op">=</span> <span class="st">"Yield"</span>,</span></span>
<span class="r-in"><span>    y <span class="op">=</span> <span class="st">"Density"</span></span></span>
<span class="r-in"><span>  <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 7: Beta Distribution Variants and Special Functions</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Generate samples from beta distribution</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="rbeta_.html">rbeta_</a></span><span class="op">(</span><span class="va">n</span>, gamma <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate density and log-likelihood</span></span></span>
<span class="r-in"><span><span class="va">beta_dens</span> <span class="op">&lt;-</span> <span class="fu"><a href="dbeta_.html">dbeta_</a></span><span class="op">(</span><span class="va">y_beta</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, gamma <span class="op">=</span> <span class="fl">2</span>, delta <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Using parameter vector format for log-likelihood (gamma, delta)</span></span></span>
<span class="r-in"><span><span class="va">par_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">beta_ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="llbeta.html">llbeta</a></span><span class="op">(</span><span class="va">par_beta</span>, <span class="va">y_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Beta density (first 5):"</span>, <span class="va">beta_dens</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Beta log-likelihood:"</span>, <span class="va">beta_ll</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Gradient of log-likelihood with respect to parameters</span></span></span>
<span class="r-in"><span><span class="va">beta_grad</span> <span class="op">&lt;-</span> <span class="fu"><a href="grbeta.html">grbeta</a></span><span class="op">(</span><span class="va">par_beta</span>, <span class="va">y_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Gradient of Beta log-likelihood:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">beta_grad</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Hessian of log-likelihood with respect to parameters</span></span></span>
<span class="r-in"><span><span class="va">beta_hess</span> <span class="op">&lt;-</span> <span class="fu"><a href="hsbeta.html">hsbeta</a></span><span class="op">(</span><span class="va">par_beta</span>, <span class="va">y_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Hessian of Beta log-likelihood:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">beta_hess</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 8: Gradient and Hessian Functions for GKw Distribution</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Set seed and generate data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define parameters</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">2</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">1.5</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fl">1.2</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.3</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1.1</span></span></span>
<span class="r-in"><span><span class="va">par_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate random sample</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">alpha</span>, <span class="va">beta</span>, <span class="va">gamma</span>, <span class="va">delta</span>, <span class="va">lambda</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate log-likelihood of the sample using parameter vector format</span></span></span>
<span class="r-in"><span><span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu"><a href="llgkw.html">llgkw</a></span><span class="op">(</span><span class="va">par_gkw</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"GKw log-likelihood:"</span>, <span class="va">ll</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate gradient of log-likelihood</span></span></span>
<span class="r-in"><span><span class="va">gr</span> <span class="op">&lt;-</span> <span class="fu"><a href="grgkw.html">grgkw</a></span><span class="op">(</span><span class="va">par_gkw</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"GKw log-likelihood gradient:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gr</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate Hessian matrix of log-likelihood</span></span></span>
<span class="r-in"><span><span class="va">hs</span> <span class="op">&lt;-</span> <span class="fu"><a href="hsgkw.html">hsgkw</a></span><span class="op">(</span><span class="va">par_gkw</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"GKw log-likelihood Hessian:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">hs</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 9: Optimization with Custom Gradient and Hessian</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Manual optimization demonstration</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate data from a known distribution</span></span></span>
<span class="r-in"><span><span class="va">true_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1.8</span>, beta <span class="op">=</span> <span class="fl">2.5</span>, gamma <span class="op">=</span> <span class="fl">1.3</span>, delta <span class="op">=</span> <span class="fl">0.2</span>, lambda <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>  alpha <span class="op">=</span> <span class="va">true_par</span><span class="op">[</span><span class="st">"alpha"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  beta <span class="op">=</span> <span class="va">true_par</span><span class="op">[</span><span class="st">"beta"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  gamma <span class="op">=</span> <span class="va">true_par</span><span class="op">[</span><span class="st">"gamma"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  delta <span class="op">=</span> <span class="va">true_par</span><span class="op">[</span><span class="st">"delta"</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  lambda <span class="op">=</span> <span class="va">true_par</span><span class="op">[</span><span class="st">"lambda"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the negative log-likelihood function (for minimization)</span></span></span>
<span class="r-in"><span><span class="va">nll</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">log_par</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Transform from log-scale to natural scale (ensures positivity)</span></span></span>
<span class="r-in"><span>  <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_par</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Return negative log-likelihood</span></span></span>
<span class="r-in"><span>  <span class="op">-</span><span class="fu"><a href="llgkw.html">llgkw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define the gradient function using analytical gradient</span></span></span>
<span class="r-in"><span><span class="va">gr_func</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">log_par</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Transform parameters</span></span></span>
<span class="r-in"><span>  <span class="va">par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">log_par</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Get the gradient with respect to the original parameters</span></span></span>
<span class="r-in"><span>  <span class="va">gradient</span> <span class="op">&lt;-</span> <span class="fu"><a href="grgkw.html">grgkw</a></span><span class="op">(</span><span class="va">par</span>, <span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Apply chain rule for the log transformation</span></span></span>
<span class="r-in"><span>  <span class="va">gradient</span> <span class="op">&lt;-</span> <span class="va">gradient</span> <span class="op">*</span> <span class="va">par</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Return negative gradient for minimization</span></span></span>
<span class="r-in"><span>  <span class="va">gradient</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Starting values (on log scale to ensure positivity)</span></span></span>
<span class="r-in"><span><span class="va">start_log_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Optimize using L-BFGS-B method with analytic gradient</span></span></span>
<span class="r-in"><span><span class="va">opt_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/optim.html" class="external-link">optim</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  par <span class="op">=</span> <span class="va">start_log_par</span>,</span></span>
<span class="r-in"><span>  fn <span class="op">=</span> <span class="va">nll</span>,</span></span>
<span class="r-in"><span>  gr <span class="op">=</span> <span class="va">gr_func</span>,</span></span>
<span class="r-in"><span>  method <span class="op">=</span> <span class="st">"BFGS"</span>,</span></span>
<span class="r-in"><span>  control <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trace <span class="op">=</span> <span class="fl">1</span>, maxit <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Transform parameters back to original scale</span></span></span>
<span class="r-in"><span><span class="va">estimated_par</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">opt_result</span><span class="op">$</span><span class="va">par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">estimated_par</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"alpha"</span>, <span class="st">"beta"</span>, <span class="st">"gamma"</span>, <span class="st">"delta"</span>, <span class="st">"lambda"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with true parameters</span></span></span>
<span class="r-in"><span><span class="va">params_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  True <span class="op">=</span> <span class="va">true_par</span>,</span></span>
<span class="r-in"><span>  Estimated <span class="op">=</span> <span class="va">estimated_par</span>,</span></span>
<span class="r-in"><span>  Absolute_Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">true_par</span> <span class="op">-</span> <span class="va">estimated_par</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  Relative_Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="op">(</span><span class="va">true_par</span> <span class="op">-</span> <span class="va">estimated_par</span><span class="op">)</span> <span class="op">/</span> <span class="va">true_par</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">params_comparison</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 10: Third Betareg Dataset (ImpreciseTask) and McDonald Distribution</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"ImpreciseTask"</span>, package <span class="op">=</span> <span class="st">"betareg"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">ImpreciseTask</span><span class="op">$</span><span class="va">location</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make sure data is within (0, 1)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">0</span> <span class="op">||</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">&gt;=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># Apply common transformation for proportions</span></span></span>
<span class="r-in"><span>  <span class="va">n_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">y</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="va">y</span> <span class="op">*</span> <span class="op">(</span><span class="va">n_obs</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">)</span> <span class="op">/</span> <span class="va">n_obs</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit models from the GKw family</span></span></span>
<span class="r-in"><span><span class="va">fit_beta</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"beta"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_kw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"kw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fit_mc</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="st">"mc"</span><span class="op">)</span> <span class="co"># McDonald distribution</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare information criteria</span></span></span>
<span class="r-in"><span><span class="va">ic_comparison</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  Model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Beta"</span>, <span class="st">"Kumaraswamy"</span>, <span class="st">"McDonald"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  AIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_beta</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_kw</span><span class="op">$</span><span class="va">AIC</span>, <span class="va">fit_mc</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  BIC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_beta</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_kw</span><span class="op">$</span><span class="va">BIC</span>, <span class="va">fit_mc</span><span class="op">$</span><span class="va">BIC</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  LogLik <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">fit_beta</span><span class="op">$</span><span class="va">loglik</span>, <span class="va">fit_kw</span><span class="op">$</span><span class="va">loglik</span>, <span class="va">fit_mc</span><span class="op">$</span><span class="va">loglik</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">ic_comparison</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">ic_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Get best model</span></span></span>
<span class="r-in"><span><span class="va">best_model</span> <span class="op">&lt;-</span> <span class="va">ic_comparison</span><span class="op">$</span><span class="va">Model</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/which.min.html" class="external-link">which.min</a></span><span class="op">(</span><span class="va">ic_comparison</span><span class="op">$</span><span class="va">AIC</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">best_fit</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/chartr.html" class="external-link">tolower</a></span><span class="op">(</span><span class="va">best_model</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="st">"beta"</span> <span class="op">=</span> <span class="va">fit_beta</span>,</span></span>
<span class="r-in"><span>  <span class="st">"kumaraswamy"</span> <span class="op">=</span> <span class="va">fit_kw</span>,</span></span>
<span class="r-in"><span>  <span class="st">"mcdonald"</span> <span class="op">=</span> <span class="va">fit_mc</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Goodness of fit tests</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Best model:"</span>, <span class="va">best_model</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">best_fit</span><span class="op">$</span><span class="va">gof</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate values from fitted McDonald distribution (if it's the best model)</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="va">best_model</span> <span class="op">==</span> <span class="st">"McDonald"</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="co"># McDonald's parameters: gamma, delta, lambda (alpha=1, beta=1 fixed)</span></span></span>
<span class="r-in"><span>  <span class="va">gamma_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_mc</span><span class="op">)</span><span class="op">[</span><span class="st">"gamma"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">delta_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_mc</span><span class="op">)</span><span class="op">[</span><span class="st">"delta"</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">lambda_mc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_mc</span><span class="op">)</span><span class="op">[</span><span class="st">"lambda"</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate new sample using fitted parameters</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">y_mc_simulated</span> <span class="op">&lt;-</span> <span class="fu"><a href="rmc.html">rmc</a></span><span class="op">(</span><span class="va">n</span>, gamma <span class="op">=</span> <span class="va">gamma_mc</span>, delta <span class="op">=</span> <span class="va">delta_mc</span>, lambda <span class="op">=</span> <span class="va">lambda_mc</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Compare histograms of original and simulated data</span></span></span>
<span class="r-in"><span>  <span class="va">df_orig</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">y</span>, type <span class="op">=</span> <span class="st">"Original"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">df_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">y_mc_simulated</span>, type <span class="op">=</span> <span class="st">"Simulated"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">df_combined</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">df_orig</span>, <span class="va">df_sim</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Create comparative histogram</span></span></span>
<span class="r-in"><span>  <span class="va">p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">df_combined</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">value</span>, fill <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html" class="external-link">geom_histogram</a></span><span class="op">(</span>position <span class="op">=</span> <span class="st">"identity"</span>, alpha <span class="op">=</span> <span class="fl">0.5</span>, bins <span class="op">=</span> <span class="fl">30</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      title <span class="op">=</span> <span class="st">"Comparison of Original Data and Simulated McDonald Distribution"</span>,</span></span>
<span class="r-in"><span>      x <span class="op">=</span> <span class="st">"Value"</span>,</span></span>
<span class="r-in"><span>      y <span class="op">=</span> <span class="st">"Count"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 11: Working with Alternative Distributions in the GKw Family</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Explore EKw - Exponential Kumaraswamy distribution (alpha, beta, lambda)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate EKw sample</span></span></span>
<span class="r-in"><span><span class="va">y_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="rekw.html">rekw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="fl">2.5</span>, beta <span class="op">=</span> <span class="fl">1.5</span>, lambda <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate density and distribution function</span></span></span>
<span class="r-in"><span><span class="va">ekw_density</span> <span class="op">&lt;-</span> <span class="fu"><a href="dekw.html">dekw</a></span><span class="op">(</span><span class="va">y_ekw</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">2.5</span>, beta <span class="op">=</span> <span class="fl">1.5</span>, lambda <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ekw_cdf</span> <span class="op">&lt;-</span> <span class="fu"><a href="pekw.html">pekw</a></span><span class="op">(</span><span class="va">y_ekw</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span>, alpha <span class="op">=</span> <span class="fl">2.5</span>, beta <span class="op">=</span> <span class="fl">1.5</span>, lambda <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate log-likelihood</span></span></span>
<span class="r-in"><span><span class="va">par_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2.5</span>, <span class="fl">1.5</span>, <span class="fl">2.0</span><span class="op">)</span> <span class="co"># alpha, beta, lambda for EKw</span></span></span>
<span class="r-in"><span><span class="va">ll_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="llekw.html">llekw</a></span><span class="op">(</span><span class="va">par_ekw</span>, <span class="va">y_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EKw density (first 5):"</span>, <span class="va">ekw_density</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EKw CDF (first 5):"</span>, <span class="va">ekw_cdf</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EKw log-likelihood:"</span>, <span class="va">ll_ekw</span>, <span class="st">"\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate gradient and Hessian</span></span></span>
<span class="r-in"><span><span class="va">gr_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="grekw.html">grekw</a></span><span class="op">(</span><span class="va">par_ekw</span>, <span class="va">y_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">hs_ekw</span> <span class="op">&lt;-</span> <span class="fu"><a href="hsekw.html">hsekw</a></span><span class="op">(</span><span class="va">par_ekw</span>, <span class="va">y_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EKw gradient:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">gr_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"EKw Hessian (first 2x2):\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">hs_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit EKw model to data</span></span></span>
<span class="r-in"><span><span class="va">fit_ekw</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y_ekw</span>, family <span class="op">=</span> <span class="st">"ekw"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">fit_ekw</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Compare with true parameters</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"True parameters: alpha=2.5, beta=1.5, lambda=2.0\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Estimated parameters:\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit_ekw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># EXAMPLE 12: Comprehensive Parameter Recovery Simulation</span></span></span>
<span class="r-in"><span><span class="co"># ============================================================================</span></span></span>
<span class="r-in"><span><span class="co"># Function to simulate data and recover parameters</span></span></span>
<span class="r-in"><span><span class="va">simulate_and_recover</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">family</span>, <span class="va">true_params</span>, <span class="va">n</span> <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">2203</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Generate data based on family</span></span></span>
<span class="r-in"><span>  <span class="va">y</span> <span class="op">&lt;-</span> <span class="kw"><a href="https://rdrr.io/r/base/switch.html" class="external-link">switch</a></span><span class="op">(</span><span class="va">family</span>,</span></span>
<span class="r-in"><span>    <span class="st">"gkw"</span> <span class="op">=</span> <span class="fu"><a href="rgkw.html">rgkw</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>      alpha <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      gamma <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, delta <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      lambda <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">5</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"bkw"</span> <span class="op">=</span> <span class="fu"><a href="rbkw.html">rbkw</a></span><span class="op">(</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>      alpha <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>      gamma <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span>, delta <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"kw"</span> <span class="op">=</span> <span class="fu"><a href="rkw.html">rkw</a></span><span class="op">(</span><span class="va">n</span>, alpha <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, beta <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    <span class="st">"beta"</span> <span class="op">=</span> <span class="fu"><a href="rbeta_.html">rbeta_</a></span><span class="op">(</span><span class="va">n</span>, gamma <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, delta <span class="op">=</span> <span class="va">true_params</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Fit model</span></span></span>
<span class="r-in"><span>  <span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu">gkwfit</span><span class="op">(</span>data <span class="op">=</span> <span class="va">y</span>, family <span class="op">=</span> <span class="va">family</span>, silent <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="co"># Return comparison</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    family <span class="op">=</span> <span class="va">family</span>,</span></span>
<span class="r-in"><span>    true <span class="op">=</span> <span class="va">true_params</span>,</span></span>
<span class="r-in"><span>    estimated <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/coef.html" class="external-link">coef</a></span><span class="op">(</span><span class="va">fit</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    loglik <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">loglik</span>,</span></span>
<span class="r-in"><span>    AIC <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">AIC</span>,</span></span>
<span class="r-in"><span>    converged <span class="op">=</span> <span class="va">fit</span><span class="op">$</span><span class="va">convergence</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Define true parameters for each family</span></span></span>
<span class="r-in"><span><span class="va">params_gkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2.0</span>, beta <span class="op">=</span> <span class="fl">3.0</span>, gamma <span class="op">=</span> <span class="fl">1.5</span>, delta <span class="op">=</span> <span class="fl">0.5</span>, lambda <span class="op">=</span> <span class="fl">1.2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">params_bkw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">2.5</span>, beta <span class="op">=</span> <span class="fl">1.8</span>, gamma <span class="op">=</span> <span class="fl">1.2</span>, delta <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">params_kw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">1.5</span>, beta <span class="op">=</span> <span class="fl">2.0</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">params_beta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>gamma <span class="op">=</span> <span class="fl">2.0</span>, delta <span class="op">=</span> <span class="fl">3.0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run simulations</span></span></span>
<span class="r-in"><span><span class="va">result_gkw</span> <span class="op">&lt;-</span> <span class="fu">simulate_and_recover</span><span class="op">(</span><span class="st">"gkw"</span>, <span class="va">params_gkw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result_bkw</span> <span class="op">&lt;-</span> <span class="fu">simulate_and_recover</span><span class="op">(</span><span class="st">"bkw"</span>, <span class="va">params_bkw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result_kw</span> <span class="op">&lt;-</span> <span class="fu">simulate_and_recover</span><span class="op">(</span><span class="st">"kw"</span>, <span class="va">params_kw</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result_beta</span> <span class="op">&lt;-</span> <span class="fu">simulate_and_recover</span><span class="op">(</span><span class="st">"beta"</span>, <span class="va">params_beta</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create summary table</span></span></span>
<span class="r-in"><span><span class="va">create_comparison_df</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">result</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">param_names</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">true</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    Parameter <span class="op">=</span> <span class="va">param_names</span>,</span></span>
<span class="r-in"><span>    True <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">true</span>,</span></span>
<span class="r-in"><span>    Estimated <span class="op">=</span> <span class="va">result</span><span class="op">$</span><span class="va">estimated</span><span class="op">[</span><span class="va">param_names</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>    Abs_Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">true</span> <span class="op">-</span> <span class="va">result</span><span class="op">$</span><span class="va">estimated</span><span class="op">[</span><span class="va">param_names</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Rel_Error <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="op">(</span><span class="va">result</span><span class="op">$</span><span class="va">true</span> <span class="op">-</span> <span class="va">result</span><span class="op">$</span><span class="va">estimated</span><span class="op">[</span><span class="va">param_names</span><span class="op">]</span><span class="op">)</span> <span class="op">/</span> <span class="va">result</span><span class="op">$</span><span class="va">true</span><span class="op">)</span> <span class="op">*</span> <span class="fl">100</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Print results</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"===== GKw Parameter Recovery =====\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">create_comparison_df</span><span class="op">(</span><span class="va">result_gkw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n===== BKw Parameter Recovery =====\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">create_comparison_df</span><span class="op">(</span><span class="va">result_bkw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n===== Kw Parameter Recovery =====\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">create_comparison_df</span><span class="op">(</span><span class="va">result_kw</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"\n===== Beta Parameter Recovery =====\n"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu">create_comparison_df</span><span class="op">(</span><span class="va">result_beta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Lopes J. E..</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

