<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Diagnostic Plots for gkwreg Objects — plot.gkwreg • gkwreg</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Diagnostic Plots for gkwreg Objects — plot.gkwreg"><meta property="og:description" content="This S3 method produces a set of diagnostic plots for a fitted Generalized
Kumaraswamy (GKw) regression model, as returned by gkwreg.
The function provides standard plots for residual analysis, influence measures,
and goodness-of-fit assessment. Users may choose between base R graphics or
ggplot2 for plotting."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gkwreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.1.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/gkwreg-package.html">Generalized Kumaraswamy Regression Models</a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Diagnostic Plots for gkwreg Objects</h1>

    <div class="hidden name"><code>plot.gkwreg.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This S3 method produces a set of diagnostic plots for a fitted Generalized
Kumaraswamy (GKw) regression model, as returned by <code><a href="gkwreg.html">gkwreg</a></code>.
The function provides standard plots for residual analysis, influence measures,
and goodness-of-fit assessment. Users may choose between base R graphics or
ggplot2 for plotting.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'gkwreg'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span></span>
<span>  <span class="va">x</span>,</span>
<span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>,</span>
<span>  caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Residuals vs. Observation Indices"</span>, <span class="st">"Cook's Distance Plot"</span>,</span>
<span>    <span class="st">"Generalized Leverage vs. Fitted Values"</span>, <span class="st">"Residuals vs. Linear Predictor"</span>,</span>
<span>    <span class="st">"Half-Normal Plot of Residuals"</span>, <span class="st">"Predicted vs. Observed Values"</span><span class="op">)</span>,</span>
<span>  sub.caption <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/deparse.html" class="external-link">deparse</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">call</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">"\n"</span><span class="op">)</span>,</span>
<span>  main <span class="op">=</span> <span class="st">""</span>,</span>
<span>  ask <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">"mfcol"</span><span class="op">)</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">which</span><span class="op">)</span> <span class="op">&amp;&amp;</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/dev.interactive.html" class="external-link">dev.interactive</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"quantile"</span>, <span class="st">"pearson"</span>, <span class="st">"deviance"</span><span class="op">)</span>,</span>
<span>  nsim <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  level <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  use_ggplot <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  arrange_plots <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sample_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  theme_fn <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="va"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_minimal</a></span>,</span>
<span>  save_diagnostics <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A fitted model object of class <code>"gkwreg"</code>.</p></dd>


<dt id="arg-which">which<a class="anchor" aria-label="anchor" href="#arg-which"></a></dt>
<dd><p>Integer vector specifying which diagnostic plots to produce.
Valid values are from 1 to 6, corresponding to:</p><ol><li><p>Residuals vs. Observation Indices.</p></li>
<li><p>Cook's Distance Plot.</p></li>
<li><p>Generalized Leverage vs. Fitted Values.</p></li>
<li><p>Residuals vs. Linear Predictor.</p></li>
<li><p>Half-Normal Plot of Residuals.</p></li>
<li><p>Predicted vs. Observed Values.</p></li>
</ol></dd>


<dt id="arg-caption">caption<a class="anchor" aria-label="anchor" href="#arg-caption"></a></dt>
<dd><p>A character vector of captions for the plots. Its length must be at
least <code>max(which)</code>.</p></dd>


<dt id="arg-sub-caption">sub.caption<a class="anchor" aria-label="anchor" href="#arg-sub-caption"></a></dt>
<dd><p>A character string for a common subtitle above the plots (e.g.,
the original call of the model). Defaults to the deparsed call of <code>x</code>.</p></dd>


<dt id="arg-main">main<a class="anchor" aria-label="anchor" href="#arg-main"></a></dt>
<dd><p>An optional character string to be used as the main title for each plot,
appended to the respective caption.</p></dd>


<dt id="arg-ask">ask<a class="anchor" aria-label="anchor" href="#arg-ask"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, the user is prompted before each plot (only applicable
to base R graphics). Defaults to <code>TRUE</code> when the number of plots exceeds the current
graphics layout.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional graphical parameters to be passed to the underlying plotting functions.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Character string indicating the type of residual to be used.
Valid options are:</p><ul><li><p><code>"quantile"</code>: Quantile residuals, based on the probability integral transform.
Recommended for bounded response variables like those in GKw regression.</p></li>
<li><p><code>"pearson"</code>: Pearson residuals, standardized by the estimated standard deviation.
Useful for identifying heteroscedasticity.</p></li>
<li><p><code>"deviance"</code>: Deviance residuals, based on the contribution to the deviance.
Helpful for assessing model fit quality.</p></li>
</ul><p>Defaults to <code>"quantile"</code>.</p></dd>


<dt id="arg-nsim">nsim<a class="anchor" aria-label="anchor" href="#arg-nsim"></a></dt>
<dd><p>Integer; number of simulations for the half-normal plot envelope.
Must be a positive integer. Defaults to 100.</p></dd>


<dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>Numeric; confidence level for the half-normal plot envelope.
Must be between 0 and 1. Defaults to 0.90.</p></dd>


<dt id="arg-use-ggplot">use_ggplot<a class="anchor" aria-label="anchor" href="#arg-use-ggplot"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, ggplot2 is used for plotting, otherwise base R
graphics are used. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-arrange-plots">arrange_plots<a class="anchor" aria-label="anchor" href="#arg-arrange-plots"></a></dt>
<dd><p>Logical; if <code>TRUE</code> and <code>use_ggplot = TRUE</code>, attempts to
arrange multiple plots in a grid using <code><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">gridExtra::grid.arrange</a></code> or
<code><a href="https://rpkgs.datanovia.com/ggpubr/reference/ggarrange.html" class="external-link">ggpubr::ggarrange</a></code>. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-sample-size">sample_size<a class="anchor" aria-label="anchor" href="#arg-sample-size"></a></dt>
<dd><p>Integer or NULL; if provided and less than the number of observations,
a random sample of observations of this size will be used for plotting. Useful for very
large datasets. Defaults to NULL (use all observations).</p></dd>


<dt id="arg-theme-fn">theme_fn<a class="anchor" aria-label="anchor" href="#arg-theme-fn"></a></dt>
<dd><p>Function; a ggplot2 theme function to be applied to all plots when
<code>use_ggplot = TRUE</code>. Defaults to <code><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">ggplot2::theme_minimal()</a></code>.</p></dd>


<dt id="arg-save-diagnostics">save_diagnostics<a class="anchor" aria-label="anchor" href="#arg-save-diagnostics"></a></dt>
<dd><p>Logical; if <code>TRUE</code>, returns a list with the diagnostic
measures used for plotting. Defaults to <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Invisibly returns either the fitted model object <code>x</code> (if <code>save_diagnostics = FALSE</code>)
or a list containing the diagnostic measures (if <code>save_diagnostics = TRUE</code>).</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The diagnostic plots generated by this function are similar in spirit to those used in
beta regression models and other regression models for variables with bounded support.</p>
<div class="section">
<h3 id="residual-types">Residual Types<a class="anchor" aria-label="anchor" href="#residual-types"></a></h3>
<p>The choice of residual type affects the interpretation of the diagnostic plots:</p><ul><li><p><strong>Quantile Residuals</strong>: Based on the probability integral transform as described
in Dunn &amp; Smyth (1996). These residuals are particularly useful for bounded response
variables as in the GKw regression, as they tend to be more normally distributed than
other types of residuals. Recommended as the default choice.</p></li>
<li><p><strong>Pearson Residuals</strong>: These are standardized residuals computed as the
difference between observed and fitted values, divided by the estimated standard
deviation of the observations. Useful for detecting heteroscedasticity but may not
be normally distributed in GKw models.</p></li>
<li><p><strong>Deviance Residuals</strong>: These are based on the contribution of each
observation to the deviance statistic, similar to those in generalized linear models.
They help assess overall model fit and identify outliers.</p></li>
</ul></div>

<div class="section">
<h3 id="cook-s-distance">Cook's Distance<a class="anchor" aria-label="anchor" href="#cook-s-distance"></a></h3>
<p>Cook's distance (Cook, 1977) is a measure of the influence of each observation on the fitted model.
In this implementation, it is calculated using a generalized formula based on residuals and
leverage values:</p>
<p>$$D_i = \frac{r_i^2}{p \cdot MSE} \cdot \frac{h_ii}{(1 - h_ii)^2}$$</p>
<p>where \(r_i\) are the residuals, \(p\) is the number of parameters, \(MSE\) is the
mean squared error, and \(h_ii\) are estimates of the generalized leverage.</p>
<p>Values exceeding \(4/n\) (where \(n\) is the sample size) are often considered influential
(Fox, 2016).</p>
</div>

<div class="section">
<h3 id="generalized-leverage">Generalized Leverage<a class="anchor" aria-label="anchor" href="#generalized-leverage"></a></h3>
<p>Generalized leverage quantifies the influence of the response values on the fitted values.
For non-linear models like GKw regression, the diagonal elements of a generalized hat matrix
are used, approximated here as the ratio of parameters to sample size (\(p/n\)).</p>
<p>Values exceeding \(2p/n\) may indicate high leverage points worth investigating
(Belsley, Kuh &amp; Welsch, 1980).</p>
</div>

<div class="section">
<h3 id="half-normal-plot">Half-Normal Plot<a class="anchor" aria-label="anchor" href="#half-normal-plot"></a></h3>
<p>The half-normal plot displays the absolute residuals against the theoretical quantiles
of a half-normal distribution. A simulation-based envelope is provided to help assess
whether the observed pattern of residuals is consistent with the fitted model.
Points falling outside the envelope suggest potential model inadequacies.</p>
</div>

    </div>
    <div id="references">
    <h2>References</h2>
    <p>Belsley, D. A., Kuh, E., &amp; Welsch, R. E. (1980). <em>Regression Diagnostics: Identifying
Influential Data and Sources of Collinearity</em>. Wiley.</p>
<p>Cook, R. D. (1977). Detection of Influential Observations in Linear Regression.
<em>Technometrics</em>, 19(1), 15-18.</p>
<p>Dunn, P. K., &amp; Smyth, G. K. (1996). Randomized Quantile Residuals.
<em>Journal of Computational and Graphical Statistics</em>, 5(3), 236-244.</p>
<p>Fox, J. (2016). <em>Applied Regression Analysis and Generalized Linear Models</em>.
Third Edition. Sage.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="gkwreg.html">gkwreg</a></code>, <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></code>, <code><a href="https://rdrr.io/r/stats/qqnorm.html" class="external-link">qqnorm</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Generate example data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span>, <span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate parameters</span></span></span>
<span class="r-in"><span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="va">x1</span></span></span>
<span class="r-in"><span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="op">+</span> <span class="fl">0.3</span> <span class="op">*</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">gamma</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">lambda</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate response from GKw distribution</span></span></span>
<span class="r-in"><span><span class="va">u</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">u</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">lambda</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">delta</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">gamma</span><span class="op">)</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">beta</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">y</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span> <span class="op">/</span> <span class="va">alpha</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create data frame</span></span></span>
<span class="r-in"><span><span class="va">mydata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>y <span class="op">=</span> <span class="va">y</span>, x1 <span class="op">=</span> <span class="va">x1</span>, x2 <span class="op">=</span> <span class="va">x2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Fit a GKw regression model</span></span></span>
<span class="r-in"><span><span class="va">fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="gkwreg.html">gkwreg</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="va">x1</span> <span class="op">|</span> <span class="va">x2</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span> <span class="op">|</span> <span class="fl">1</span>, data <span class="op">=</span> <span class="va">mydata</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Basic diagnostic plots using base R graphics</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, type <span class="op">=</span> <span class="st">"pearson"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Produce all diagnostic plots using ggplot2</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Arrange multiple plots in a grid</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>, arrange_plots <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Use a custom ggplot2 theme</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>,</span></span>
<span class="r-in"><span>  which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, use_ggplot <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  theme_fn <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_dark</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract diagnostic measures for further analysis</span></span></span>
<span class="r-in"><span><span class="va">diag_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">fit</span>, which <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">6</span>, save_diagnostics <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a custom diagnostic plot</span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"ggplot2"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">diag_data</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">cook_dist</span>, y <span class="op">=</span> <span class="va">leverage</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span></span>
<span class="r-in"><span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>      x <span class="op">=</span> <span class="st">"Cook's Distance"</span>, y <span class="op">=</span> <span class="st">"Leverage"</span>,</span></span>
<span class="r-in"><span>      title <span class="op">=</span> <span class="st">"Influence Diagnostic Plot"</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Lopes J. L..</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

